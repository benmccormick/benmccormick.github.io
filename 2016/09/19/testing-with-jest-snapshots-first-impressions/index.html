<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=yyxgnp97qG"/><link rel="icon" type="image/png" href="/favicon-32x32.png?v=yyxgnp97qG" sizes="32x32"/><link rel="icon" type="image/png" href="/favicon-16x16.png?v=yyxgnp97qG" sizes="16x16"/><link rel="manifest" href="/manifest.json"/><link rel="mask-icon" href="/safari-pinned-tab.svg?v=yyxgnp97qG" color="#57a3e8"/><link rel="alternate" title="JSON Feed" type="application/json" href="/feed.json"/><link rel="shortcut icon" href="/favicon.ico?v=yyxgnp97qG"/><meta name="theme-color" content="#ffffff"/><script type="text/javascript" src="//use.typekit.net/msd6bqv.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script><title data-react-helmet="true">Testing with Jest Snapshots: First Impressions | benmccormick.org</title><meta data-react-helmet="true" name="description" content="Ben McCormick&#x27;s blog on JavaScript and Web Development"/><meta data-react-helmet="true" name="keywords" content="Jest JavaScript testing React Snapshot Tests"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:site" content="@benmccormickorg"/><meta data-react-helmet="true" name="twitter:creator" content="@ben336"/><meta data-react-helmet="true" name="twitter:title" content="Testing with Jest Snapshots: First Impressions"/><meta data-react-helmet="true" name="twitter:description" content=""/><meta data-react-helmet="true" name="twitter:image" content="http://benmccormick.org/logo.png"/><script data-react-helmet="true" type="application/ld+json">{
                  "@context": "http://schema.org"
                  "@type": "BlogPosting",
                  "headline": "Testing with Jest Snapshots: First Impressions",
                  "genre": "Software Development",
                  "keywords": "Jest JavaScript testing React Snapshot Tests",
                  "url": "http://benmccormick.org/2016/09/19/testing-with-jest-snapshots-first-impressions/",
                  "image": "http://benmccormick.org/logo.png",
                  "datePublished": "2016-09-19",
                  
                  "articleBody": "<p>Over the past 6 months my team at work has been slowly transitioning a large Backbone application to React.  One of the main goals of the transition has been to build out unit tests as we transition components.  As part of that we switched from using Karma to using Jest for managing our tests.</p>
<p>Our new setup with Jest has several advantages over our previous setup. All Jest tests run through node using a fake DOM implementation.  We don’t need to start up a browser so tests are faster and less flaky <sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup>.  Jest makes it possible to mock all modules by default <sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup>, which works well for us since our code base currently contains a large amount of code that is difficult to test for one reason or another.  Jest provides great integration with Babel, which is helpful since all of our Backbone and React code uses ES6 that we transpile for the browser.  Finally Jest provides a wonderful watch mode that runs only the tests that are relevant to the changes you’ve made and makes it easy to see the result.</p>
<p>About a month ago, Jest debuted a new feature: Snapshot testing.  It works a bit differently than a normal unit test.  Instead of executing some code and comparing the output against a value provided by a developer, the first time a test is run, the output passed into the test is saved to a “snapshot file”.  Then when the test is run in the future, the output is compared to the snapshot file.  If the output matches the file, the test passes, if the output is different then the file, the test fails and Jest prints a diff.  We’ve been using Jest snapshots for a few weeks now and I wanted to share my initial impressions.</p>
<h3>What is it like to use a snapshot test ?</h3>
<p>The process for snapshot testing is a bit different than normal tests.  Most snapshot tests look fairly simple.  Something like this example from the <a href=\"https://github.com/facebook/jest/tree/master/examples/snapshot\">Jest repository</a>:</p>
<div class=\"gatsby-highlight\">
      <pre class=\"language-javascript\"><code><span class=\"token comment\" spellcheck=\"true\">// Link.react.js</span>
<span class=\"token comment\" spellcheck=\"true\">// Copyright 2004-present Facebook. All Rights Reserved.</span>

<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>

<span class=\"token keyword\">const</span> STATUS <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>
  NORMAL<span class=\"token punctuation\">:</span> <span class=\"token string\">'normal'</span><span class=\"token punctuation\">,</span>
  HOVERED<span class=\"token punctuation\">:</span> <span class=\"token string\">'hovered'</span><span class=\"token punctuation\">,</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>

<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Link</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>

  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_onMouseEnter <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_onMouseEnter<span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_onMouseLeave <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_onMouseLeave<span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>
      <span class=\"token keyword\">class</span><span class=\"token punctuation\">:</span> STATUS<span class=\"token punctuation\">.</span>NORMAL<span class=\"token punctuation\">,</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>
  <span class=\"token punctuation\">}</span>

  <span class=\"token function\">_onMouseEnter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">:</span> STATUS<span class=\"token punctuation\">.</span>HOVERED<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token punctuation\">}</span>

  <span class=\"token function\">_onMouseLeave</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">:</span> STATUS<span class=\"token punctuation\">.</span>NORMAL<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token punctuation\">}</span>

  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>
      <span class=\"token operator\">&lt;</span>a
        className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">}</span>
        href<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>page <span class=\"token operator\">||</span> <span class=\"token string\">'#'</span><span class=\"token punctuation\">}</span>
        onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_onMouseEnter<span class=\"token punctuation\">}</span>
        onMouseLeave<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_onMouseLeave<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>
        <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span>
      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>
    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token punctuation\">}</span>

<span class=\"token punctuation\">}</span>

<span class=\"token comment\" spellcheck=\"true\">// Link.react-test.js  (partial)</span>
<span class=\"token comment\" spellcheck=\"true\">// Copyright 2004-present Facebook. All Rights Reserved.</span>
<span class=\"token comment\" spellcheck=\"true\">/* eslint-disable no-unused-vars */</span>

<span class=\"token string\">'use strict'</span>

<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">import</span> Link <span class=\"token keyword\">from</span> <span class=\"token string\">'../Link.react'</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">import</span> renderer <span class=\"token keyword\">from</span> <span class=\"token string\">'react-test-renderer'</span><span class=\"token punctuation\">;</span>

<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'renders correctly'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>
  <span class=\"token keyword\">const</span> tree <span class=\"token operator\">=</span> renderer<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>
    <span class=\"token operator\">&lt;</span>Link page<span class=\"token operator\">=</span><span class=\"token string\">\"http://www.facebook.com\"</span><span class=\"token operator\">></span>Facebook<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>
  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
</code></pre>
      </div>
<p>The first time the test is run, a snapshot file is produced.  In this case, running the previous test produces a snapshot file that looks like this:</p>
<div class=\"gatsby-highlight\">
      <pre class=\"language-javascript\"><code><span class=\"token comment\" spellcheck=\"true\">// Link.react-test.js.snap  (partial)</span>
exports<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token string\">`test renders correctly 1`</span></span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`
&lt;a
  className=\"normal\"
  href=\"http://www.facebook.com\"
  onMouseEnter={[Function bound _onMouseEnter]}
  onMouseLeave={[Function bound _onMouseLeave]}>
  Facebook
&lt;/a>
`</span></span><span class=\"token punctuation\">;</span>
</code></pre>
      </div>
<p>This gives us a baseline for what we expect the UI to look like.  The snapshot is generated in a folder in your <code>__tests__</code> directory, so that it can be checked into source control.</p>
<p>The next time a test is run, if nothing has changed, the test passes.  However, if we change something (let’s say we add a class), the test fails and shows us a diff.</p>
<div class=\"gatsby-highlight\">
      <pre class=\"language-javascript\"><code><span class=\"token comment\" spellcheck=\"true\">// updated link render method</span>

<span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>
    <span class=\"token operator\">&lt;</span>a
      className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token string\">`link-item </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">}</span>
      href<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>page <span class=\"token operator\">||</span> <span class=\"token string\">'#'</span><span class=\"token punctuation\">}</span>
      onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_onMouseEnter<span class=\"token punctuation\">}</span>
      onMouseLeave<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_onMouseLeave<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>
      <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span>
    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>
  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span>
</code></pre>
      </div>
<div class=\"gatsby-highlight\">
      <pre class=\"language-diff\"><code># jest output

FAIL  __tests__/Link.react-test.js
 ✕ renders correctly (16ms)

● renders correctly

    Received value does not match the stored snapshot 1.

    - Snapshot
    + Received

      &lt;a
<span class=\"token deleted\">-       className=\"normal\"</span>
<span class=\"token inserted\">+       className=\"link-item normal\"</span>
        href=\"http://www.facebook.com\"
        onMouseEnter={[Function bound _onMouseEnter]}
        onMouseLeave={[Function bound _onMouseLeave]}>
        Facebook
      &lt;/a>

      at Object.&lt;anonymous> (__tests__/Link.react-test.js:14:16)
</code></pre>
      </div>
<p>We can then choose to accept this change by running <code>jest -u</code> to update the snapshot, or update our code to fix the regression.  If we update the snapshot file, the test will start passing again.</p>
<h3>Snapshot tests are a complement for conventional tests not a replacement</h3>
<p>The first thing that became clear to me while using snapshot testing is that they’re not for everything.  They are optimized for a different case than normal assertion-based tests.</p>
<p>Classic assertion based tests are perfect for testing clearly defined behavior that is expected to remain relatively stable.</p>
<p>Snapshot tests are great for testing less clearly defined behavior that may change often.</p>
<p>Snapshot testing is perfect for things that in the past would have raised concern for “overly brittle” tests that slow development teams down.  The classic example of this (and the main focus of discussion around Jest snapshots so far) is UI testing.</p>
<p>UI components often change in small and trivial ways.  Copy is changed, whitespace is added, a border color is modified. Generally this means that developers have to choose between detailed tests that catch any regression but require constant updates, or less detailed tests that focus on core behaviors but miss smaller regressions.</p>
<p>Snapshot tests provide a new way of approaching these problems in unit tests.  Because they are easy to write and effortless to update, and provide a clear view of what changed after each update, whether it is major or minor.</p>
<p>This isn’t without any disadvantage. Snapshot tests preserve a starting point, but don’t give any indication of developer intent to future developers.  Like any other test, if the initial snapshot passes with bugs, or doesn’t capture the full range of cases, the test won’t adequately cover those behaviors.  But unlike traditional tests, snapshot tests don’t provide specific guidance for what the original developer expected beyond the “actual behavior”.  If there are multiple sub-behaviors that interact to produce output, its not clear which of those are essential, and which are incidental.  That’s not something you want for your critical application logic, especially complicated logic with many subtle cases.  But for UI components and other application elements that are likely to change a lot over time, this is a good set of tradeoffs.</p>
<h3>Snapshot tests are more useful with a healthy code review process</h3>
<p>I’ve pointed out several times now that snapshot tests are easy to update.  One of the downsides of the current design is that they can be almost too easy to update.  When a snapshot test fails, you have the option of modifying the output so that the test passes again, or updating the snapshot to reflect the new output.  Unfortunately, Jest currently provides no granularity for this updating.  Running <code>jest -u</code> to update the snapshots will update all snapshots.  So if  a single change causes many snapshots to break, it can be easy to accidentally update all of them, and possibly difficult to work through the whole diff to find changes.</p>
<p>A robust code review process minimizes these problems.  Because snapshots are checked into source, the diffs in the snapshots are checked into source control.  Viewing diffs in a dedicated code review tool like Github, Bitbucket or Gitlab, it’s easier to see exactly what changed over many files than it might be when updating snapshots from the command line, and if you update a snapshot multiple times in a single branch, you can see the net effect on the snapshot through source control diffs better than you can through Jest.</p>
<h3>Snapshot tests work well with auto-mocking</h3>
<p>Auto-mocking has been one of Jest’s more controversial features.  Prior to version 15, Jest mocked every module used in tests by default.  To run the actual module code, it was necessary to manually unmock each module used or change Jest configurations.  Though it is now disabled by default, auto-mocking actually works very well with snapshot tests.  One problem with tests that rely on generating DOM in React is the fact that most components of any complexity are actually made up of smaller components, that often use external functions with complex logic to determine what to show.  If we fully render everything, changing any of those pieces can break tests for many components, moving us away from the concept of a “unit test”.  If we mock child components and helper functions and then test them individually though, we can focus our tests to only change based on the logic of the individual component being tested.  This is incredibly easy with Jest, and especially helpful in large code bases that don’t have complete test coverage.  Auto-mocking is considered an “advanced feature” of Jest, but it’s not hard to use.  Most mocked modules produce something non-harmful by default, and when its necessary to override, its not difficult to produce something meaningful without getting too involved.  Just add a file with the same name as the file to be mocked into a <code>__mocks__</code> folder in that directory, and give the mocked module the same interface as the mocked component.  You can either write it from scratch or use <a href=\"http://facebook.github.io/jest/docs/api.html#jest-genmockfrommodule-modulename\">jest.genMockFromModule</a> as a starting place.</p>
<h3>Summary</h3>
<p>I’m impressed by Jest snapshots.  When combined with React, they’re providing my first non-frustrating experience unit testing UI components.  I’m excited to use them more going forward, and will be interested to see how they evolve from here.</p>
<hr>
<h3>Extra: A few miscellaneous Jest Thoughts</h3>
<ul>
<li>The UI output from Jest 15 tests is the best I’ve ever seen from a testing framework.  Aside from the nice diffs on snapshots, they do a good job explaining how output differed from expectations in assertion based tests, and communicating context for test failures, warnings and logging messages.  They also give great guidance when making configuration changes:</li>
</ul>
<blockquote class=\"twitter-tweet\" data-lang=\"en\"><p lang=\"en\" dir=\"ltr\"><a href=\"https://twitter.com/cpojer\">@cpojer</a> This is lovely, thank you! <a href=\"https://t.co/CX1v11CAVc\">pic.twitter.com/CX1v11CAVc</a></p>&mdash; Ben McCormick (@ben336) <a href=\"https://twitter.com/ben336/status/772906536154894336\">September 5, 2016</a></blockquote>
<ul>
<li>
<p>I’ve also been super impressed with Jest’s watch mode in Jest 15.  <code>--watch</code> makes it easy to focus on a few files or run tests on all files, and stays up to date as you change code.  If you haven’t worked with Jest in a while, the developer experience alone makes it worth trying out.</p>
</li>
<li>
<p>One potential future annoyance with snapshot tests:  The snapshot format can’t be iterated on without breaking all current tests.  Make sure not to mix functional changes with Jest updates!</p>
</li>
</ul>
<blockquote class=\"twitter-tweet\" data-cards=\"hidden\" data-lang=\"en\"><p lang=\"en\" dir=\"ltr\">We&#39;ll update the snapshot format sometimes in minor/major releases. When updating Jest, please update snapshots<br><br>See <a href=\"https://t.co/gPE63dMz8P\">https://t.co/gPE63dMz8P</a></p>&mdash; Christoph Pojer (@cpojer) <a href=\"https://twitter.com/cpojer/status/776623521069805568\">September 16, 2016</a></blockquote>
<h3>More Resources</h3>
<ul>
<li>
<p>Randy Coulman has a <a href=\"http://randycoulman.com/blog/2016/09/06/snapshot-testing-use-with-care/\">nice article</a> on some of the reasons to be careful about embracing snapshot testing.  He makes good points about the requirement of human involvement in verifying a change in time-crunched situations and also the potential value of snapshot tests for legacy code.</p>
</li>
<li>
<p>My team uses a mix of <a href=\"https://github.com/airbnb/enzyme\">enzyme</a> and snapshot tests for unit testing React Components.  <a href=\"https://github.com/trayio/enzyme-to-json?utm_content=buffer6b78b&#x26;utm_medium=social&#x26;utm_source=twitter.com&#x26;utm_campaign=buffer\">This repo</a> combines them, allowing you to use enzyme to generate the snapshot output to diff against rather than the renderer provided by Jest. I personally haven’t felt the need to integrate these two tools, but if your team uses enzyme and wants consistency/fewer (used) dependencies, this could be a cool option.</p>
</li>
<li>
<p>Finally here’s <a href=\"https://blog.grommet.io/post/2016/09/01/how-we-landed-on-jest-snapshot-testing-for-javascript\">another article</a> on how Snapshot testing convinced one team to migrate to Jest from Tape</p>
</li>
</ul>
<div class=\"footnotes\">
<hr>
<ol>
<li id=\"fn-1\">
<p>PhantomJS was a tremendous source of pain in our Karma setup.</p>
<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>
</li>
<li id=\"fn-2\">
<p>This used to be the default setting, with Jest 15 it can be configured to work that way.</p>
<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a>
</li>
</ol>
</div>",
                    "author": {
                      "@type": "Person",
                      "name": "Ben McCormick"
                      "email": "mailto:ben@benmccormick.org",
                      "image": "/profile_pic.jpg",
                      "jobTitle": "Software Engineer",
                      "alumniOf": "Duke",
                      "birthPlace": "Pittsburgh, PA",
                      "gender": "male",
                      "url": "http://benmccormick.org",
                	    "sameAs" : [
                        "https://www.linkedin.com/in/benmccormick",
                        "http://twitter.com/ben336",
                      ]
                   }
                }</script><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.55em 'brandon-grotesque','Brandon Grotesque','Helvetica Neue','Helvetica','Arial','Lucida Sans','Geneva','Verdana','sans-serif';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'brandon-grotesque','Brandon Grotesque','Helvetica Neue','Helvetica','Arial','Lucida Sans','Geneva','Verdana','sans-serif';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:'brandon-grotesque','Brandon Grotesque','Helvetica Neue','Helvetica','Arial','Lucida Sans','Geneva','Verdana','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.5rem;line-height:2.325rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:'brandon-grotesque','Brandon Grotesque','Helvetica Neue','Helvetica','Arial','Lucida Sans','Geneva','Verdana','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.27542rem;line-height:1.55rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:'brandon-grotesque','Brandon Grotesque','Helvetica Neue','Helvetica','Arial','Lucida Sans','Geneva','Verdana','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.17608rem;line-height:1.55rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:'brandon-grotesque','Brandon Grotesque','Helvetica Neue','Helvetica','Arial','Lucida Sans','Geneva','Verdana','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.55rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:'brandon-grotesque','Brandon Grotesque','Helvetica Neue','Helvetica','Arial','Lucida Sans','Geneva','Verdana','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.92211rem;line-height:1.55rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:'brandon-grotesque','Brandon Grotesque','Helvetica Neue','Helvetica','Arial','Lucida Sans','Geneva','Verdana','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.88547rem;line-height:1.55rem;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}ul{margin-left:1.55rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.55rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;font-size:0.85rem;line-height:1.1;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.1625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;font-size:1rem;line-height:1.55rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}blockquote{margin-left:1.55rem;margin-right:1.55rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.1625rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.1625rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.55rem;margin-bottom:calc(1.1625rem / 2);margin-top:calc(1.1625rem / 2);}li > ul{margin-left:1.55rem;margin-bottom:calc(1.1625rem / 2);margin-top:calc(1.1625rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.1625rem / 2);}code{font-size:0.85rem;line-height:1.55rem;}kbd{font-size:0.85rem;line-height:1.55rem;}samp{font-size:0.85rem;line-height:1.55rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.03333rem;padding-right:1.03333rem;padding-top:0.775rem;padding-bottom:calc(0.775rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;font-size:75%;}pre code{background:none;line-height:1.1;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}h1,h2,h3,h4,h5,h6{line-height:1.1;}@media only screen and (max-width:480px){html{font-size:112.5%;}}</style><style>.subscribe-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-wrap:wrap;flex-wrap:wrap}.subscribe-block{width:400px;padding-right:30px;overflow:hidden}.subscribe-block #mc_embed_signup form{margin-bottom:20px}.up-next-block{width:300px}.subscribe-button{color:#fff;background:#57a3e8;border-radius:4px;border:0;padding:5px 10px;margin:20px 0;cursor:pointer}.rss{padding-bottom:10px}.rss a{display:-webkit-box;display:-ms-flexbox;display:flex}.rss-icon{display:block;width:17px;margin-right:.5em;height:50px}.rss-icon *{fill:#e2777a}.twitter-item{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:15px}.twitter-item iframe{margin:0 0 0 10px}.markdown pre{display:block;background:#343d46;color:#d8dee9}.token.comment,.token.quote{color:#a7adba}.token.addition,.token.attr,.token.selector-tag,.token.string{color:#99c794}.token.doctag,.token.meta .token.meta-string,.token.regexp{color:#89ddf3}.token.built_in,.token.function{color:#5fb3b3}.token.name,.token.section,.token.selector-class,.token.selector-id,.token.title{color:#69c}.token.attribute,.token.class .token.title,.token.template-variable,.token.type,.token.variable{color:#fac863}.token.bullet,.token.link,.token.meta,.token.meta .token.keyword,.token.selector-attr,.token.selector-pseudo,.token.subst,.token.symbol{color:#f9ae58}.token.boolean,.token.deletion,.token.literal,.token.number{color:#f07178}.token.keyword{color:#c594c5}.token.formula{background:#a7adba}.token.emphasis{font-style:italic}.token.strong{font-weight:700}a{color:#e2777a;text-decoration:none}blockquote{border-left:5px solid #57a3e8;font-style:italic;background:#eee;font-weight:400;font-size:.9rem;padding:10px 20px;margin:0 0 30px -25px}blockquote p{margin-bottom:.667em}h2,h3{color:#57a3e8}.explanation{padding:10px;background:#eee;border-radius:10px;margin:20px auto;font-size:.85em}.footnotes li>*{display:inline;margin-bottom:0}.article-body .reading-img img{width:150px;float:right;margin:0 10px 20px}.gatsby-resp-image-wrapper{max-width:75%;display:block;margin:40px auto 20px}.article-body img.full-width{max-height:none}.article-body img.half-width{max-height:none;width:50%}.bordered-img{border:3px solid #57a3e8}.img-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.img-group img{padding:0;height:auto}twitterwidget{margin-left:auto;margin-right:auto}.mc-field-group{width:400px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:8px 0}.mc-field-group input{border-radius:3px;max-width:350px;width:80vw;border:1px solid #ccc;margin-right:10px;height:30px}.mc-field-group label{font-size:.9em;font-weight:600}#mc-embedded-subscribe{color:#fff;background:#57a3e8;border-radius:4px;border:0;padding:0 10px;margin:10px 0;cursor:pointer;width:40vw}#mc-embedded-subscribe:hover{background:#3e8acf}.twitter-row{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.twitter-row>div{padding-right:20px;min-width:300px}.category-icon-wrapper{color:rgba(87,163,232,.5)}.category-icon{display:inline-block;width:.75em;margin-right:.5em}.category-icon *{fill:#57a3e8;fill:rgba(87,163,232,.5)}.category-icon>i{height:30px}.header-link{color:hsla(0,0%,39%,.7)}.header-link:hover{color:#e2777a}#carbonads{height:100px;font-size:14px;width:300px;position:relative;background:#f0f0f0}.carbon-wrap{height:100px;display:-webkit-box;display:-ms-flexbox;display:flex}.carbon-text{padding:5px 10px;max-height:80px;display:inline-block;overflow:hidden;line-height:1.3}.carbon-poweredby{color:hsla(0,0%,39%,.7);position:absolute;right:5px;bottom:0}@media (max-width:600px){#carbonads,.no-mobile{display:none}.subscribe-block{padding-right:0;padding:0 10px}.subscribe-block,.subscribe-block .mc-field-group{width:100%!important}.subscribe-block .mc-field-group input{width:100%!important;font-size:.8em;height:2.4em}.up-next-block{width:100%!important;padding:0 10px}}@media (max-width:321px){html{font-size:100%!important}}</style><link rel="preload" href="/page-component---src-templates-blog-post-js-1b7e08d257552144b559.js" as="script"/><link rel="preload" href="/path---2016-09-19-testing-with-jest-snapshots-first-impressions-fd6c0a6f836134f2727f.js" as="script"/><link rel="preload" href="/layout-component---index-70b8f924146ef86d3258.js" as="script"/><link rel="preload" href="/app-4ad317b624a9587ece01.js" as="script"/><link rel="preload" href="/commons-85ad19e371744ab2bf0f.js" as="script"/><script id="webpack-manifest">
            //<![CDATA[
            window.webpackManifest = {"15178676390636814000":"app-4ad317b624a9587ece01.js","8321446950128396000":"page-component---node-modules-gatsby-plugin-offline-app-shell-js-4f0dddda43ae15168f16.js","5567064509904683000":"page-component---src-templates-blog-post-js-1b7e08d257552144b559.js","4229320956280557000":"page-component---src-templates-category-page-js-e32fa790baa77d7b6697.js","2804217296675496000":"page-component---src-pages-archive-js-9b089d0476698fd685a1.js","4016850265702045000":"page-component---src-pages-index-js-b681681bf0f3a02c39a5.js","13784418321228782000":"path---offline-plugin-app-shell-fallback-586c7e095e534a3909ec.js","11711201792954765000":"path---404-html-ae133566656c2f73f1d8.js","6149725634412240000":"path---a-note-to-recruiters-aab4d19593bd5ec80f69.js","11484959540308085000":"path---learning-vim-in-2014-c8715e7d721b502a5a54.js","17953591736895156000":"path---about-5c49f9176beddeb8dfdf.js","14201970510400770000":"path---marionette-explained-46cb72aee9666bb6ec36.js","9369996873154550000":"path---speaking-e363fdc8f927b19324e1.js","9351720115130171000":"path---subscribe-6726ca9b6ddb54e469ab.js","3239107570024570000":"path---readinglist-b547724daabaa618bf9c.js","9970237474805596000":"path---2013-09-10-blendconf-2013-takeaways-from-a-very-human-tech-conference-386f5f15235d9d95fc94.js","7570888621869710000":"path---2013-04-06-a-new-look-40b88376f44db5afbbbc.js","4988419580825110000":"path---2013-06-09-90-done-halfway-there-876373f666be07023c35.js","9487584793133978000":"path---2013-01-06-book-review-effective-javascript-588e1de535084d463da4.js","8901412266055526000":"path---2013-04-23-book-review-javascript-testing-with-jasmine-4c49e0851414550babb9.js","4208182691347348000":"path---2013-08-12-book-review-user-centered-design-7972b733b29647031538.js","13645794037312290000":"path---2013-01-25-career-fairs-how-to-not-get-hired-and-how-to-give-yourself-a-chance-c25570b8875cc7b0cf23.js","16721510772713648000":"path---2013-02-23-coffeescript-is-great-0819eed380bc74732049.js","12884520599062075000":"path---2013-03-23-creating-a-build-system-for-a-coffeescript-project-with-ant-7cb57657bd4f46975728.js","2526010685028163000":"path---2013-06-08-customer-culture-revisited-68d7d0b82dadd3faf3fc.js","12502599451412107000":"path---2013-01-08-explaining-javascript-closures-c1df9ff19bf715a6e6f1.js","3929825676444408000":"path---2013-06-11-evergreen-browsers-813026b6129c4a14a3b1.js","15779460584034437000":"path---2013-01-12-explaining-javascript-object-oriented-programming-b2c4c9eb608abc3ec85f.js","12990994506127737000":"path---2013-06-11-how-i-use-stack-overflow-574f6c28394df6dbcd45.js","14921455922729384000":"path---2013-02-03-how-i-work-refactoring-256110f34e948c142e0f.js","16034195937072835000":"path---2013-12-30-meetings-and-concurrency-4d9f0958679e16e9aa7b.js","15735186237611076000":"path---2013-05-04-irreplaceable-8090301a2e4a1f8ea204.js","10361752404044140000":"path---2013-11-14-modern-dojo-exploring-dojo-basedeclare-e38695dba12bc624022b.js","9661779138607491000":"path---2013-05-07-revertible-observables-in-knockout-94e93e9d5430f823c792.js","1420821768002888200":"path---2013-11-13-modern-dojo-exploring-dojoquery-745ffba69f42c4204efd.js","17137307033809940000":"path---2013-08-16-searching-for-the-perfect-reading-device-my-nexus-7-2013-review-7fdb67b2b65a1b992b5b.js","5722356299045395000":"path---2013-06-29-rss-roundup-edab215919d9d265bfa4.js","10301559739306678000":"path---2013-02-13-simple-publish-subscribe-with-jquery-32094fc3a1734077b132.js","7705915330108801000":"path---2013-08-15-somewhat-open-0fccdac4db1da561b985.js","8566794467411845000":"path---2013-01-01-sublime-text-for-javascript-configuration-663a853efc185bfb54ce.js","10373535795157264000":"path---2013-01-03-sublime-text-for-javascript-plugins-d17143cf91c00d166aab.js","2822613209636559000":"path---2013-01-15-unexpected-javascript-that-doesnt-do-what-you-think-ccf14deed42014a89585.js","18698474487894420":"path---2014-11-04-a-quick-review-of-google-inbox-5f7fed988980853bf317.js","4957391291280868000":"path---2014-11-08-all-about-angular-2-0-f7b5d28f567f727107b7.js","15036326724299030000":"path---2014-11-24-alternative-javascript-e5f7af2c63a3a3f8e87b.js","8697057829059570000":"path---2014-12-22-building-complex-layouts-with-marionette-js-4f9c8776671135090d65.js","4963628532718749000":"path---2014-12-18-come-build-with-me-b837f3f303daa2dc070c.js","6640198416066087000":"path---2014-08-07-component-based-development-7ea240b7f049496d6b2c.js","10926144803571778000":"path---2014-08-28-custom-elements-by-example-cfd0302da186d6e82834.js","4274109705084552700":"path---2014-06-02-discovering-vim-0d6fa9d5c04e809f4810.js","11668824928804320000":"path---2014-01-06-digging-into-knockout-builds-babed130aee281abc4d6.js","10160848289207170000":"path---2014-07-14-learning-vim-in-2014-configuring-vim-6a6e70a383f352303560.js","15664797420088646000":"path---2014-07-27-learning-vim-in-2014-copy-and-paste-the-vim-way-f253b12c26e6e6922a85.js","4643700091233559000":"path---2014-06-30-learning-vim-in-2014-the-basics-fcbfccc7e196a0c45fcc.js","7956846869346647000":"path---2014-08-04-learning-vim-in-2014-search-1f0b8d99d1ff05e27e95.js","11317885703564528000":"path---2014-07-21-learning-vim-in-2014-getting-more-from-vim-with-plugins-1eafa2f78f4171a61f43.js","2541437925750222300":"path---2014-07-16-learning-vim-in-2014-vim-as-art-7c1cc0709844b50f2ac0.js","16399016283205116000":"path---2014-07-02-learning-vim-in-2014-vim-as-language-ca61cb56a2e51d2a62cb.js","16889621977069142000":"path---2014-07-07-learning-vim-in-2014-working-with-files-2f1d2821e66031f9ccfb.js","18159680721607778000":"path---2014-12-10-marionette-explained-connecting-your-data-to-your-views-76ea96889bd386315a66.js","8630820739431306000":"path---2014-07-11-new-twitter-feed-and-practical-vim-giveaway-68a56d1d5d48d99287c5.js","15276496339857254000":"path---2014-07-24-one-day-left-in-practical-vim-giveaway-c40efd8405f98df9bc93.js","17955627297296556000":"path---2014-10-13-setting-up-your-text-editor-for-javascript-development-f5159e9cff30625fdc1b.js","376221471718148740":"path---2014-12-02-the-case-for-marionette-js-40fa7072c133c393145e.js","7294074219210106000":"path---2014-08-19-the-debugging-toolbox-f0ea337542dd8b88e273.js","11335125218021552000":"path---2014-11-12-underscore-vs-lodash-55c89ab6efb833a07392.js","12738404113761044000":"path---2014-07-09-understanding-the-backbone-mindset-a-review-of-building-backbone-plugins-by-derick-bailey-fcad0b8fc44263c451a0.js","17709201197096172000":"path---2012-12-20-awesome-software-trello-01db7506f4e6fa0e29ba.js","15304177550087293000":"path---2012-11-09-bayesian-witch-hunt-873227c9e6fec6b9eec0.js","16139749260458867000":"path---2012-10-06-it-took-a-month-to-get-sick-of-php-c2b84570f6b663f37f84.js","17592052974658148000":"path---2012-12-29-i-hate-computing-ecosystems-1d4bf810b6e6bc75ee07.js","5830227661472685000":"path---2012-12-29-cleaning-my-digital-house-d7148b81049d836beb86.js","7264654056851156000":"path---2012-12-25-medium-the-end-of-history-and-the-last-website-a63c89ba74255c4634e3.js","17095308856732094000":"path---2012-11-07-sync-multiple-google-calendars-in-windows-8-e70ee3ccd980abdb2871.js","14663350838336150000":"path---2012-12-30-sublime-text-for-javascript-keyboard-shortcuts-cf06c40dde65477b45c3.js","14549542878416417000":"path---2012-09-19-the-iphone-5-conversation-so-far-87035aa40f22c16f74e9.js","966288852833295000":"path---2012-11-08-shutdown-tiles-for-windows-8-start-screen-32fd0cc9dc260464efc8.js","4570892025843575000":"path---2015-07-06-backbone-and-es-6-classes-revisited-e60cc701b908d8da67fa.js","17265586046511972000":"path---2015-06-15-book-review-talking-with-tech-leads-99ad9a9fc9cee5ba7b55.js","3271935603424526300":"path---2015-12-31-2015-roundup-2-ce71dab96b0e7ca78d21.js","6202572539255216000":"path---2015-11-30-es-6-patterns-clean-higher-order-functions-1867c001c2cb20a3512a.js","3710975430170115000":"path---2015-09-14-es-5-es-6-es-2016-es-next-whats-going-on-with-javascript-versioning-977cefa037cf9ce2b8c1.js","6166663248207965000":"path---2015-04-07-es-6-classes-and-backbone-js-720c1ed28401e9dc61b5.js","9039988472047779000":"path---2015-06-10-is-safari-being-left-behind-c86579d4e71230b91e02.js","11314185936414444000":"path---2015-12-30-es-6-patterns-converting-callbacks-to-promises-1b1b24c037d858a57073.js","24566668062212364":"path---2015-01-22-is-bower-useful-c5e5c07ca00f5402b6a8.js","13364516941766027000":"path---2015-06-08-how-jquery-works-an-introduction-f685c1e72dd043da3a59.js","730934344168844700":"path---2015-05-25-marionette-service-service-objects-for-marionette-635fe1c4b53028428493.js","7160596742836566000":"path---2015-01-05-marionette-view-life-cycles-511f92f62f0042f76486.js","16615563562040414000":"path---2015-05-28-moving-past-requirejs-26b15db18741f3159cbb.js","12115615934156431000":"path---2015-06-14-mozilla-the-state-of-web-components-8887687a780c7d192a85.js","11635796757548958000":"path---2015-02-22-rauchg-on-es-6-b129c58415015a66106d.js","7725556876915527000":"path---2015-11-25-productive-javascript-development-081c2f474fd3d73177f0.js","15781176753323213000":"path---2015-03-23-staying-dry-with-marionette-behaviors-405a190236e7cc8d2e6d.js","7978385202065764000":"path---2015-09-09-what-can-backbone-developers-learn-from-react-6ec3f24a48578c94a25b.js","1419009670271261700":"path---2016-12-31-2016-roundup-2a44a33d5fd2da04ffb0.js","5623115232157006000":"path---2016-04-30-ack-tips-ee6bf6a01cb68da0bdcc.js","17578809893330006000":"path---2016-12-02-whole-new-site-1b020a32ec441ee00708.js","8345130568649344000":"path---2016-05-02-digging-into-react-choosing-component-styles-29d1b12854ac6ba901fd.js","13377314275435020000":"path---2016-06-26-quick-tip-take-advantage-of-lodash-collections-2-1eab75ac48d69a9fea08.js","17636969476961060000":"path---2016-12-11-readable-code-audience-72047160aba02cc6fd34.js","9093196713649272000":"path---2016-03-09-stability-vs-decline-ebc3a89b95dfe648e7ef.js","6324961005136647000":"path---2016-01-08-reusable-code-patterns-bb34fce0b0104396629c.js","10108934303926590000":"path---2016-01-25-staying-productive-91efb1aabfa3865d9c4f.js","10783760535123343000":"path---2016-12-14-what-are-higher-order-components-b2a12914297eac931af8.js","10485770512600267000":"path---2016-09-19-testing-with-jest-snapshots-first-impressions-fd6c0a6f836134f2727f.js","15781340068539660000":"path---2016-06-04-what-are-mutable-and-immutable-data-structures-2-0e6ed8d4a3909dea7cce.js","6038258818167871000":"path---2017-06-03-rss-atom-json-gatsby-6865069ffa71188126af.js","13303994982804371000":"path---2017-01-03-orthogonality-and-css-in-js-81fe9dbf49d838bc9217.js","14103574458251850000":"path---2017-07-19-ten-things-javascript-62f4e28bc9c6ed4e0f96.js","12782939239129285000":"path---2017-07-10-how-to-follow-the-javascript-roadmap-3aab05ea2e21e47e3ef4.js","5060687037633451000":"path---2017-01-09-mobx-first-impressions-e3fe7cf4e642e45f4627.js","6784611317627741000":"path---2017-02-18-context-to-best-practices-209c5a0ff7b089232804.js","3136300706037352000":"path---2013-11-25-a-look-at-ack-743e2fc83b9ba462cf88.js","10637192576328739000":"path---2015-01-26-backbone-radio-55aa1edf698a51dc0e79.js","15906113815094761000":"path---2014-11-10-vim-workflows-file-switching-strategies-df8ef0d74a6c3e49a949.js","10910862192549116000":"path---2016-01-11-the-most-interesting-atom-packages-ive-found-so-far-e9c815650567cd7b4b2b.js","4798749783265810000":"path---2016-03-07-the-sad-state-of-the-backbone-ecosystem-fbff0af0291c34e7cd79.js","12189501574888978000":"path---2016-12-10-saving-time-with-jest-f9d478b55484ad1de28e.js","17953528095254866000":"path---2017-05-29-atom-tips-3a407572e5764ae5998c.js","18390214443057822000":"path---2017-03-28-the-mystery-of-docker-and-the-disk-eating-cow-b4813f065508904ea4ca.js","16115924020544200000":"path---2017-02-26-running-jest-tests-before-each-git-commit-122345e97d0e6bed1eed.js","2108396007783965700":"path---2017-02-13-improving-site-performance-with-lighthouse-65dbbc504083eba9f400.js","7427821939332841000":"path---2017-05-28-mariana-syntax-atom-72e7d251fb70529b9e43.js","14471878390477140000":"path---2017-05-11-building-normal-curves-highcharts-2449889820e8a1ff5a9e.js","1733845846262257200":"path---2017-04-14-grading-applications-on-config-portability-8e307c1a9acca74d4cee.js","3306020603663706600":"path---category-frameworks-2178c9f42c1d845efcb9.js","9926120898609840000":"path---category-javascript-c060f405acb20bf4d4f9.js","10473073881449703000":"path---category-software-productivity-5a2cee716eae2b7abb96.js","8538016099450021000":"path---category-meta-80295486ebcc3f334732.js","13022883366857360000":"path---category-tools-8f5ae23fa3e477f32fbf.js","16436387397272748000":"path---category-reviews-b0cab47eb7f7d4fca69a.js","9807561136566950000":"path---category-platform-7b48063dff346482d831.js","13384874473531716000":"path---category-opinion-158a48e02dcdd71e1424.js","15205666288078348000":"path---archive-394ca0ad3b53c090df24.js","9347362237655822000":"path---index-4c1374aed476863b3192.js","17241999800008180000":"layout-component---index-70b8f924146ef86d3258.js"}
            //]]>
            </script><script>
  !function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",[
  "/commons-85ad19e371744ab2bf0f.js","/app-4ad317b624a9587ece01.js","/layout-component---index-70b8f924146ef86d3258.js","/path---2016-09-19-testing-with-jest-snapshots-first-impressions-fd6c0a6f836134f2727f.js","/page-component---src-templates-blog-post-js-1b7e08d257552144b559.js"
])
  </script></head><body class="landing-page" style="background:#FCFCFC;padding:0 10px;"><div id="___gatsby"><div style="max-width:40.3rem;margin-left:auto;margin-right:auto;padding:2.325rem 1.1625rem;" data-reactroot="" data-reactid="1" data-react-checksum="-1843108250"><div style="display:flex;padding-bottom:0.5rem;margin-bottom:0.5rem;" data-reactid="2"><div style="flex-grow:3;display:flex;flex-direction:column;justify-content:space-around;" data-reactid="3"><h3 style="margin:0;padding-bottom:0;" data-reactid="4"><a style="box-shadow:none;text-decoration:none;color:inherit;" name="title" href="/" data-reactid="5">benmccormick.org</a></h3><div style="color:rgba(100,100,100, 0.7);" data-reactid="6"><a class="header-link" href="/subscribe/" data-reactid="7">Subscribe</a><span style="padding:0 0.33rem;" data-reactid="8">•</span><a class="header-link" href="/archive/" data-reactid="9">Archive</a><span style="padding:0 0.33rem;" data-reactid="10">•</span><a class="header-link" href="http://twitter.com/ben336" data-reactid="11">Twitter</a><span style="padding:0 0.33rem;" data-reactid="12">•</span><a class="header-link" href="/about/" data-reactid="13">About</a></div></div><div style="flex-shrink:2;" data-reactid="14"><span data-reactid="15"></span></div></div><div class="markdown" data-reactid="16"><!-- react-empty: 17 --><h5 style="display:block;color:rgba(100,100,100, 0.7);margin-bottom:0.3875rem;" data-reactid="18">September 19, 2016</h5><h1 style="margin-top:0;margin-bottom:1rem;" data-reactid="19">Testing with Jest Snapshots: First Impressions</h1><div class="article-body" data-reactid="20"><p>Over the past 6 months my team at work has been slowly transitioning a large Backbone application to React.  One of the main goals of the transition has been to build out unit tests as we transition components.  As part of that we switched from using Karma to using Jest for managing our tests.</p>
<p>Our new setup with Jest has several advantages over our previous setup. All Jest tests run through node using a fake DOM implementation.  We don’t need to start up a browser so tests are faster and less flaky <sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>.  Jest makes it possible to mock all modules by default <sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>, which works well for us since our code base currently contains a large amount of code that is difficult to test for one reason or another.  Jest provides great integration with Babel, which is helpful since all of our Backbone and React code uses ES6 that we transpile for the browser.  Finally Jest provides a wonderful watch mode that runs only the tests that are relevant to the changes you’ve made and makes it easy to see the result.</p>
<p>About a month ago, Jest debuted a new feature: Snapshot testing.  It works a bit differently than a normal unit test.  Instead of executing some code and comparing the output against a value provided by a developer, the first time a test is run, the output passed into the test is saved to a “snapshot file”.  Then when the test is run in the future, the output is compared to the snapshot file.  If the output matches the file, the test passes, if the output is different then the file, the test fails and Jest prints a diff.  We’ve been using Jest snapshots for a few weeks now and I wanted to share my initial impressions.</p>
<h3>What is it like to use a snapshot test ?</h3>
<p>The process for snapshot testing is a bit different than normal tests.  Most snapshot tests look fairly simple.  Something like this example from the <a href="https://github.com/facebook/jest/tree/master/examples/snapshot">Jest repository</a>:</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code><span class="token comment" spellcheck="true">// Link.react.js</span>
<span class="token comment" spellcheck="true">// Copyright 2004-present Facebook. All Rights Reserved.</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> STATUS <span class="token operator">=</span> <span class="token punctuation">{</span>
  NORMAL<span class="token punctuation">:</span> <span class="token string">'normal'</span><span class="token punctuation">,</span>
  HOVERED<span class="token punctuation">:</span> <span class="token string">'hovered'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Link</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>_onMouseEnter <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_onMouseEnter<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_onMouseLeave <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_onMouseLeave<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token keyword">class</span><span class="token punctuation">:</span> STATUS<span class="token punctuation">.</span>NORMAL<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">_onMouseEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token keyword">class</span><span class="token punctuation">:</span> STATUS<span class="token punctuation">.</span>HOVERED<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">_onMouseLeave</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token keyword">class</span><span class="token punctuation">:</span> STATUS<span class="token punctuation">.</span>NORMAL<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>a
        className<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span>
        href<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>page <span class="token operator">||</span> <span class="token string">'#'</span><span class="token punctuation">}</span>
        onMouseEnter<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>_onMouseEnter<span class="token punctuation">}</span>
        onMouseLeave<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>_onMouseLeave<span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// Link.react-test.js  (partial)</span>
<span class="token comment" spellcheck="true">// Copyright 2004-present Facebook. All Rights Reserved.</span>
<span class="token comment" spellcheck="true">/* eslint-disable no-unused-vars */</span>

<span class="token string">'use strict'</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">'../Link.react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> renderer <span class="token keyword">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'renders correctly'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> tree <span class="token operator">=</span> renderer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Link page<span class="token operator">=</span><span class="token string">"http://www.facebook.com"</span><span class="token operator">></span>Facebook<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>The first time the test is run, a snapshot file is produced.  In this case, running the previous test produces a snapshot file that looks like this:</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code><span class="token comment" spellcheck="true">// Link.react-test.js.snap  (partial)</span>
exports<span class="token punctuation">[</span><span class="token template-string"><span class="token string">`test renders correctly 1`</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token string">`
&lt;a
  className="normal"
  href="http://www.facebook.com"
  onMouseEnter={[Function bound _onMouseEnter]}
  onMouseLeave={[Function bound _onMouseLeave]}>
  Facebook
&lt;/a>
`</span></span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>This gives us a baseline for what we expect the UI to look like.  The snapshot is generated in a folder in your <code>__tests__</code> directory, so that it can be checked into source control.</p>
<p>The next time a test is run, if nothing has changed, the test passes.  However, if we change something (let’s say we add a class), the test fails and shows us a diff.</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code><span class="token comment" spellcheck="true">// updated link render method</span>

<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>a
      className<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`link-item </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span>
      href<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>page <span class="token operator">||</span> <span class="token string">'#'</span><span class="token punctuation">}</span>
      onMouseEnter<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>_onMouseEnter<span class="token punctuation">}</span>
      onMouseLeave<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>_onMouseLeave<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<div class="gatsby-highlight">
      <pre class="language-diff"><code># jest output

FAIL  __tests__/Link.react-test.js
 ✕ renders correctly (16ms)

● renders correctly

    Received value does not match the stored snapshot 1.

    - Snapshot
    + Received

      &lt;a
<span class="token deleted">-       className="normal"</span>
<span class="token inserted">+       className="link-item normal"</span>
        href="http://www.facebook.com"
        onMouseEnter={[Function bound _onMouseEnter]}
        onMouseLeave={[Function bound _onMouseLeave]}>
        Facebook
      &lt;/a>

      at Object.&lt;anonymous> (__tests__/Link.react-test.js:14:16)
</code></pre>
      </div>
<p>We can then choose to accept this change by running <code>jest -u</code> to update the snapshot, or update our code to fix the regression.  If we update the snapshot file, the test will start passing again.</p>
<h3>Snapshot tests are a complement for conventional tests not a replacement</h3>
<p>The first thing that became clear to me while using snapshot testing is that they’re not for everything.  They are optimized for a different case than normal assertion-based tests.</p>
<p>Classic assertion based tests are perfect for testing clearly defined behavior that is expected to remain relatively stable.</p>
<p>Snapshot tests are great for testing less clearly defined behavior that may change often.</p>
<p>Snapshot testing is perfect for things that in the past would have raised concern for “overly brittle” tests that slow development teams down.  The classic example of this (and the main focus of discussion around Jest snapshots so far) is UI testing.</p>
<p>UI components often change in small and trivial ways.  Copy is changed, whitespace is added, a border color is modified. Generally this means that developers have to choose between detailed tests that catch any regression but require constant updates, or less detailed tests that focus on core behaviors but miss smaller regressions.</p>
<p>Snapshot tests provide a new way of approaching these problems in unit tests.  Because they are easy to write and effortless to update, and provide a clear view of what changed after each update, whether it is major or minor.</p>
<p>This isn’t without any disadvantage. Snapshot tests preserve a starting point, but don’t give any indication of developer intent to future developers.  Like any other test, if the initial snapshot passes with bugs, or doesn’t capture the full range of cases, the test won’t adequately cover those behaviors.  But unlike traditional tests, snapshot tests don’t provide specific guidance for what the original developer expected beyond the “actual behavior”.  If there are multiple sub-behaviors that interact to produce output, its not clear which of those are essential, and which are incidental.  That’s not something you want for your critical application logic, especially complicated logic with many subtle cases.  But for UI components and other application elements that are likely to change a lot over time, this is a good set of tradeoffs.</p>
<h3>Snapshot tests are more useful with a healthy code review process</h3>
<p>I’ve pointed out several times now that snapshot tests are easy to update.  One of the downsides of the current design is that they can be almost too easy to update.  When a snapshot test fails, you have the option of modifying the output so that the test passes again, or updating the snapshot to reflect the new output.  Unfortunately, Jest currently provides no granularity for this updating.  Running <code>jest -u</code> to update the snapshots will update all snapshots.  So if  a single change causes many snapshots to break, it can be easy to accidentally update all of them, and possibly difficult to work through the whole diff to find changes.</p>
<p>A robust code review process minimizes these problems.  Because snapshots are checked into source, the diffs in the snapshots are checked into source control.  Viewing diffs in a dedicated code review tool like Github, Bitbucket or Gitlab, it’s easier to see exactly what changed over many files than it might be when updating snapshots from the command line, and if you update a snapshot multiple times in a single branch, you can see the net effect on the snapshot through source control diffs better than you can through Jest.</p>
<h3>Snapshot tests work well with auto-mocking</h3>
<p>Auto-mocking has been one of Jest’s more controversial features.  Prior to version 15, Jest mocked every module used in tests by default.  To run the actual module code, it was necessary to manually unmock each module used or change Jest configurations.  Though it is now disabled by default, auto-mocking actually works very well with snapshot tests.  One problem with tests that rely on generating DOM in React is the fact that most components of any complexity are actually made up of smaller components, that often use external functions with complex logic to determine what to show.  If we fully render everything, changing any of those pieces can break tests for many components, moving us away from the concept of a “unit test”.  If we mock child components and helper functions and then test them individually though, we can focus our tests to only change based on the logic of the individual component being tested.  This is incredibly easy with Jest, and especially helpful in large code bases that don’t have complete test coverage.  Auto-mocking is considered an “advanced feature” of Jest, but it’s not hard to use.  Most mocked modules produce something non-harmful by default, and when its necessary to override, its not difficult to produce something meaningful without getting too involved.  Just add a file with the same name as the file to be mocked into a <code>__mocks__</code> folder in that directory, and give the mocked module the same interface as the mocked component.  You can either write it from scratch or use <a href="http://facebook.github.io/jest/docs/api.html#jest-genmockfrommodule-modulename">jest.genMockFromModule</a> as a starting place.</p>
<h3>Summary</h3>
<p>I’m impressed by Jest snapshots.  When combined with React, they’re providing my first non-frustrating experience unit testing UI components.  I’m excited to use them more going forward, and will be interested to see how they evolve from here.</p>
<hr>
<h3>Extra: A few miscellaneous Jest Thoughts</h3>
<ul>
<li>The UI output from Jest 15 tests is the best I’ve ever seen from a testing framework.  Aside from the nice diffs on snapshots, they do a good job explaining how output differed from expectations in assertion based tests, and communicating context for test failures, warnings and logging messages.  They also give great guidance when making configuration changes:</li>
</ul>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/cpojer">@cpojer</a> This is lovely, thank you! <a href="https://t.co/CX1v11CAVc">pic.twitter.com/CX1v11CAVc</a></p>&mdash; Ben McCormick (@ben336) <a href="https://twitter.com/ben336/status/772906536154894336">September 5, 2016</a></blockquote>
<ul>
<li>
<p>I’ve also been super impressed with Jest’s watch mode in Jest 15.  <code>--watch</code> makes it easy to focus on a few files or run tests on all files, and stays up to date as you change code.  If you haven’t worked with Jest in a while, the developer experience alone makes it worth trying out.</p>
</li>
<li>
<p>One potential future annoyance with snapshot tests:  The snapshot format can’t be iterated on without breaking all current tests.  Make sure not to mix functional changes with Jest updates!</p>
</li>
</ul>
<blockquote class="twitter-tweet" data-cards="hidden" data-lang="en"><p lang="en" dir="ltr">We&#39;ll update the snapshot format sometimes in minor/major releases. When updating Jest, please update snapshots<br><br>See <a href="https://t.co/gPE63dMz8P">https://t.co/gPE63dMz8P</a></p>&mdash; Christoph Pojer (@cpojer) <a href="https://twitter.com/cpojer/status/776623521069805568">September 16, 2016</a></blockquote>
<h3>More Resources</h3>
<ul>
<li>
<p>Randy Coulman has a <a href="http://randycoulman.com/blog/2016/09/06/snapshot-testing-use-with-care/">nice article</a> on some of the reasons to be careful about embracing snapshot testing.  He makes good points about the requirement of human involvement in verifying a change in time-crunched situations and also the potential value of snapshot tests for legacy code.</p>
</li>
<li>
<p>My team uses a mix of <a href="https://github.com/airbnb/enzyme">enzyme</a> and snapshot tests for unit testing React Components.  <a href="https://github.com/trayio/enzyme-to-json?utm_content=buffer6b78b&#x26;utm_medium=social&#x26;utm_source=twitter.com&#x26;utm_campaign=buffer">This repo</a> combines them, allowing you to use enzyme to generate the snapshot output to diff against rather than the renderer provided by Jest. I personally haven’t felt the need to integrate these two tools, but if your team uses enzyme and wants consistency/fewer (used) dependencies, this could be a cool option.</p>
</li>
<li>
<p>Finally here’s <a href="https://blog.grommet.io/post/2016/09/01/how-we-landed-on-jest-snapshot-testing-for-javascript">another article</a> on how Snapshot testing convinced one team to migrate to Jest from Tape</p>
</li>
</ul>
<div class="footnotes">
<hr>
<ol>
<li id="fn-1">
<p>PhantomJS was a tremendous source of pain in our Karma setup.</p>
<a href="#fnref-1" class="footnote-backref">↩</a>
</li>
<li id="fn-2">
<p>This used to be the default setting, with Jest 15 it can be configured to work that way.</p>
<a href="#fnref-2" class="footnote-backref">↩</a>
</li>
</ol>
</div></div><div data-reactid="21"><hr data-reactid="22"/><div class="subscribe-container" data-reactid="23"><div class="subscribe-block" data-reactid="24"><p data-reactid="25"><!-- react-text: 26 -->Thanks for taking the time to read this post!<!-- /react-text --><!-- react-text: 27 --> Software tooling<!-- /react-text --><!-- react-text: 28 --> is one of the main topics of this blog, so if you enjoyed the post, please consider subscribing by using the feed, Twitter or my mailing list.<!-- /react-text --></p><div style="margin-bottom:3.875rem;" data-reactid="29"><div id="mc_embed_signup" data-reactid="30"><h6 style="margin:0;font-size:0.8165rem;line-height:1.55rem;letter-spacing:-0.25px;" data-reactid="31">EMAIL</h6><form action="//benmccormick.us8.list-manage.com/subscribe/post?u=115446b80fd9d930ba091cc27&amp;id=f5b9f5acf2" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="" data-reactid="32"><div id="mc_embed_signup_scroll" data-reactid="33"><div class="mc-field-group" style="padding-right:30px;" data-reactid="34"><input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address" data-reactid="35"/><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button" data-reactid="36"/></div><div id="mce-responses" class="clear" data-reactid="37"><div class="response" id="mce-error-response" style="display:none;" data-reactid="38"></div><div class="response" id="mce-success-response" style="display:none;" data-reactid="39"></div></div><div style="position:absolute;left:-5000px;" aria-hidden="true" data-reactid="40"><input type="text" name="b_115446b80fd9d930ba091cc27_f5b9f5acf2" tabindex="-1" value="" data-reactid="41"/></div><div class="clear" data-reactid="42"></div></div></form></div><div class="rss" data-reactid="43"><h6 style="margin:0;font-size:0.8165rem;line-height:1.55rem;letter-spacing:-0.25px;" data-reactid="44">RSS</h6><a href="/rss/" data-reactid="45"><i class="rss-icon" data-reactid="46"><svg viewBox="0 0 10 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>rss</title><desc>Created with Sketch.</desc><defs></defs><g id="Octicons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="rss" fill="#000000"><path d="M2,13 L0,13 L0,11 C1.11,11 2,11.89 2,13 L2,13 Z M0,3 L0,4 C4.97,4 9,8.03 9,13 L10,13 C10,7.48 5.52,3 0,3 L0,3 Z M0,7 L0,8 C2.75,8 5,10.25 5,13 L6,13 C6,9.69 3.31,7 0,7 L0,7 Z" id="Shape"></path></g></g></svg></i><!-- react-text: 47 --> <!-- /react-text --><span data-reactid="48">RSS</span></a></div><div data-reactid="49"><h6 style="margin:0;font-size:0.8165rem;line-height:1.55rem;letter-spacing:-0.25px;" data-reactid="50">TWITTER</h6><div class="twitter-item" data-reactid="51"><span data-reactid="52">Site Feed: </span><a href="https://twitter.com/benmccormickorg" class="twitter-follow-button" data-show-count="false" data-reactid="53">Follow @benmccormickorg</a></div></div><div data-reactid="54"><div class="twitter-item" data-reactid="55"><span data-reactid="56">Personal Feed: </span><a href="https://twitter.com/ben336" class="twitter-follow-button" data-show-count="false" data-reactid="57">Follow @ben336</a></div></div></div></div><div class="up-next-block" data-reactid="58"><h6 style="margin:0;font-size:0.8165rem;line-height:1.55rem;letter-spacing:-0.25px;" data-reactid="59">You Might Also Like:</h6><div data-reactid="60"><h3 style="margin-top:0;margin-bottom:0.3875rem;" data-reactid="61"><a href="/[object Object]" data-reactid="62">MobX: First Impressions</a></h3><p data-reactid="63">First impression of managing data with MobX</p></div><div data-reactid="64"><hr data-reactid="65"/><h3 style="margin-top:0;margin-bottom:0.3875rem;" data-reactid="66"><a href="/[object Object]" data-reactid="67">Saving Time With Jest: Meetup Summary</a></h3><p data-reactid="68">A summary of my meetup talk on saving time with Jest</p></div><div data-reactid="69"><hr data-reactid="70"/><h3 style="margin-top:0;margin-bottom:0.3875rem;" data-reactid="71"><a href="/[object Object]" data-reactid="72">Lessons Backbone Developers Can Learn From React</a></h3><p data-reactid="73">A look at the lessons that Backbone developers can learn from React</p></div></div></div></div><hr style="margin-bottom:3.1rem;" data-reactid="74"/><div title="Testing with Jest Snapshots: First Impressions" data-reactid="75"><div id="disqus_thread" data-reactid="76"></div><noscript data-reactid="77"><span data-reactid="78"><!-- react-text: 79 -->Please enable JavaScript to view the<!-- /react-text --><a href="http://disqus.com/?ref_noscript" data-reactid="80">comments powered by Disqus.</a></span></noscript><a href="http://disqus.com" class="dsq-brlink" data-reactid="81"><!-- react-text: 82 -->Blog comments powered by <!-- /react-text --><span class="logo-disqus" data-reactid="83">Disqus</span><!-- react-text: 84 -->.<!-- /react-text --></a></div></div><span style="display:block;clear:both;" data-reactid="85"> </span></div></div><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-37323973-1', 'auto');
            ga('send', 'pageview');
        </script><script>
          window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));
      </script></body></html>