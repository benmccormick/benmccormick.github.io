<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=yyxgnp97qG"/><link rel="icon" type="image/png" href="/favicon-32x32.png?v=yyxgnp97qG" sizes="32x32"/><link rel="icon" type="image/png" href="/favicon-16x16.png?v=yyxgnp97qG" sizes="16x16"/><link rel="manifest" href="/manifest.json"/><link rel="mask-icon" href="/safari-pinned-tab.svg?v=yyxgnp97qG" color="#rgb(42, 194, 240)"/><link rel="alternate" title="JSON Feed" type="application/json" href="/feed.json"/><link rel="shortcut icon" href="/favicon.ico?v=yyxgnp97qG"/><meta name="theme-color" content="#ffffff"/><title data-react-helmet="true"></title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.6 'minion-3','Garamond',serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'minion-3','Garamond',serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.6rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.32578rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.20684rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.91028rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.86849rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}ul{margin-left:1.6rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.6rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;font-size:0.85rem;line-height:1.1;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.2rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;font-size:1rem;line-height:1.6rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}blockquote{margin-left:1.6rem;margin-right:1.6rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.2rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.2rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.6rem;margin-bottom:calc(1.2rem / 2);margin-top:calc(1.2rem / 2);}li > ul{margin-left:1.6rem;margin-bottom:calc(1.2rem / 2);margin-top:calc(1.2rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.2rem / 2);}code{font-size:0.85rem;line-height:1.6rem;}kbd{font-size:0.85rem;line-height:1.6rem;}samp{font-size:0.85rem;line-height:1.6rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.06667rem;padding-right:1.06667rem;padding-top:0.8rem;padding-bottom:calc(0.8rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;font-size:14px;}pre code{background:none;line-height:1.1;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}h1,h2,h3,h4,h5,h6{line-height:1.1;}@media only screen and (max-width:480px){html{font-size:112.5%;}}</style><style data-href="/0.972a641404e3c16cd0aa.css">body{color:#474747}a{color:#f1684e;text-decoration:none;cursor:pointer}a:hover{text-decoration:underline}.footnote-backref,.footnote-ref{text-decoration:none;padding-left:3px}blockquote{border-left:5px solid #2ac2f0;background:#eee;font-weight:400;font-size:.9rem;padding:1.5rem 2rem;margin:0 0 1rem}blockquote p{margin-bottom:.667em}h3{color:#2ac2f0}h4{font-size:110%}.explanation{padding:10px;background:#eee;border-radius:10px;margin:20px auto;font-size:.85em}.footnotes{font-size:80%}.footnotes li>*{display:inline;margin-bottom:0}strong{color:#639f6e}em{color:#9a74aa}.markdown iframe{margin:0 auto}.carbon-wrap{display:grid;grid-template-columns:1fr 1fr;grid-column-gap:10px;grid-template-rows:1fr;margin-bottom:30px;align-items:center;padding-left:5px}@media (max-width:960px){.carbon-wrap{grid-template-columns:1fr;grid-template-rows:110px 1fr;grid-row-gap:10px;justify-items:center}}.carbon-wrap img{margin-bottom:0}.carbon-text{padding:5px 5px 5px 0;display:inline-block;overflow:hidden;line-height:1.3}.carbon-poweredby{color:#999;position:absolute;right:5px;bottom:0}.columns{display:grid;grid-template-columns:665px 270px;grid-template-rows:1fr;grid-column-gap:25px}@media (max-width:960px){.columns{display:grid;grid-template-columns:70% 28%;grid-column-gap:2%}}@media (max-width:700px){.columns{display:flex;flex-direction:column;align-items:center}.no-mobile{display:none}}@media (max-width:321px){html{font-size:100%!important}}</style><style data-href="/component---src-templates-blog-post-js.8d5fb7e09aa4ea7497f6.css">.markdown pre{display:block;background:#343d46;color:#d8dee9;padding:.8rem}.markdown pre code:after{content:unset}.token.comment,.token.quote{color:#a7adba}.token.addition,.token.attr,.token.selector-tag,.token.string{color:#99c794}.token.doctag,.token.meta .token.meta-string,.token.regexp{color:#89ddf3}.token.built_in,.token.function{color:#5fb3b3}.token.name,.token.section,.token.selector-class,.token.selector-id,.token.title{color:#69c}.token.attribute,.token.class .token.title,.token.template-variable,.token.type,.token.variable{color:#fac863}.token.bullet,.token.link,.token.meta,.token.meta .token.keyword,.token.selector-attr,.token.selector-pseudo,.token.subst,.token.symbol{color:#f9ae58}.token.boolean,.token.deletion,.token.literal,.token.number{color:#f07178}.token.keyword{color:#c594c5}.token.formula{background:#a7adba}.token.emphasis{font-style:italic}.token.strong{font-weight:700}.gatsby-resp-image-wrapper{max-width:75%;display:block;margin:40px auto 20px}.bordered-img{border:3px solid #rgb(42,194,240)}.img-group{display:flex;justify-content:space-between}.img-group img{padding:0;height:auto}.inline-img{width:45%;display:inline-block;float:right;padding:2rem}#bd-label{font-family:mr-eaves-xl-modern,Helvetica Neue,Arial,sans-serif;font-weight:700}#bd-label.large-label{font-size:20px}#bd-email{padding-left:5px}#bd-email,#bd-submit{font-family:mr-eaves-xl-modern,Helvetica Neue,Arial,sans-serif;font-size:14px}#bd-submit{background:#f1684e;color:#fff;border-radius:4px;border:none}@media (max-width:960px){#bd-email,#bd-submit{font-size:10px}#bd-label{font-size:12px}}.large-row #bd-email,.large-row #bd-submit{font-size:30px}@media (max-width:700px){.large-row #bd-email,.large-row #bd-submit{font-size:18px}}.bd-subscribe-form{margin:30px 0 50px;display:block}.bd-subscribe-row{display:grid;grid-template-columns:60% 35%;grid-column-gap:5%;grid-template-rows:1fr;margin-top:10px}@media (max-width:960px){.bd-subscribe-row{grid-template-columns:1fr;grid-row-gap:10%;grid-template-rows:1fr 1fr}}.twitter-tweet,twitterwidget{margin-left:auto;margin-right:auto}</style><meta name="generator" content="Gatsby 2.0.75"/><style id="glamor-styles">.css-tcc0st,[data-css-tcc0st]{color:#999999;font-size:16px;font-family:"mr-eaves-xl-modern", "Helvetica Neue", Arial, sans-serif;}.css-tcc0st:hover,[data-css-tcc0st]:hover{color:#F1684E;}.css-1gs5qio,[data-css-1gs5qio]{font-size:16px;font-family:"mr-eaves-xl-modern", "Helvetica Neue", Arial, sans-serif;}.css-1yx29dl,[data-css-1yx29dl]{font-family:"mr-eaves-xl-modern", "Helvetica Neue", Arial, sans-serif;font-size:0.75rem;background:rgba(240, 219, 79, 1.00);color:#333;display:-webkit-box; display: -moz-box; display: -ms-flexbox; display: -webkit-flex; display: flex;flex-direction:row;justify-content:flex-start;align-items:center;border-radius:0.25rem;padding:0.125rem 0.35rem;width:12rem;height:2rem;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-webkit-box-pack:start;-webkit-justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;}.css-1yx29dl:hover,[data-css-1yx29dl]:hover{text-decoration:none;}@media all and (max-width: 960px){.css-1yx29dl,[data-css-1yx29dl]{height:1.6rem;width:7rem;font-size:0.55rem;}}</style><script id="glamor-ids">
        // <![CDATA[
        window._glamor = ["tcc0st","1gs5qio","1yx29dl"]
        // ]]>
        </script><title data-react-helmet="true">Staying DRY with Marionette Behaviors | benmccormick.org</title><meta data-react-helmet="true" name="description" content="Ben McCormick&#x27;s blog on JavaScript and Web Development"/><meta data-react-helmet="true" name="keywords" content="Marionette.js behaviors JavaScript"/><script data-react-helmet="true" type="application/ld+json">{
                  "@context": "http://schema.org"
                  "@type": "BlogPosting",
                  "headline": "Staying DRY with Marionette Behaviors",
                  "genre": "Software Development",
                  "keywords": "Marionette.js behaviors JavaScript",
                  "url": "http://benmccormick.org//2015/03/23/staying-dry-with-marionette-behaviors",
                  "image": "http://benmccormick.org/logo.png",
                  "datePublished": "2015-03-23",
                  
                  "articleBody": "<p><em>This is the sixth post in a series on <a href=\"http://marionettejs.com/\">Marionette.js</a>.  For more background on what Marionette is, check out the series page, <a href=\"http://benmccormick.org/marionette-explained/\">Marionette Explained</a></em></p>
<p>Any successful project draws complaints, and <a href=\"http://backbonejs.org/\">Backbone.js</a> is a successful project by pretty much any measurement.  The biggest complaints I’ve heard leveled against Backbone as an MVC framework revolve around the boilerplate involved in writing Backbone apps.  The claim goes that Backbone forces you to write the same event binding and workflow code over and over again.  In general I’d claim that’s a feature of <em>bad</em> Backbone apps, and  not something unavoidable.  But it’s certainly true that Backbone doesn’t give you much guidance on how to reduce repetition and boilerplate in your code.  Making it easy to reduce repetition turns out to be one of the main roles of <a href=\"http://marionettejs.com/\">Marionette</a>. This post is a look at one of the tools that Marionette provides to help you simplify your applications: the Behavior class.</p>
<p>Marionette Behaviors are reusable chunks of UI logic that you can mix into your Views.  When you have a common problem that you face across several Views, Behaviors can help you reduce boilerplate and repetition.  We’ll take a look at a practical example first, and then we can get into the Behaviors API.  </p>
<p>Let’s see how Behaviors can help us write better form validation code.  When I’m validating forms, I use the <a href=\"http://thedersen.com/projects/backbone-validation/\">backbone.validation</a> library. It provides helpers for checking the validity of model properties and attaching error messages to inputs, but doesn’t force a specific workflow. However, I have a specific flow I usually want.  A user should be able to enter data as they see fit to start, with no validation warnings until they’ve tried to submit the form.  After they’ve initially submitted the form, warnings should appear next to any invalid fields, and they should update and disappear as the user fixes their input.</p>
<p>That process is pretty easy to implement with backbone.validation.  I simply connect my Model to each form View I create, and in the Model I add some logic to re-validate each time the Model is changed, but only after the first time validation is triggered by a user submit.  That works great in most cases.  The problem comes when I need to re-render my view in the middle of this process.  This is a pretty common occurrence if your form has sub-views that may appear based on the contents of other parts of the form. In that case, I have to make sure that the validation state persists across renders.  That might look something like this. <sup id=\"fnref:1\"><a href=\"#fn:1\">1</a></sup></p>
<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> Mn <span class=\"token keyword\">from</span> <span class=\"token string\">'marionette'</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> Validation <span class=\"token keyword\">from</span> <span class=\"token string\">'backbone-validation'</span><span class=\"token punctuation\">;</span>

<span class=\"token keyword\">var</span> FormView <span class=\"token operator\">=</span> Mn<span class=\"token punctuation\">.</span>LayoutView<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>

    template<span class=\"token punctuation\">:</span> <span class=\"token string\">'#form'</span><span class=\"token punctuation\">,</span>

    ui<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
        submit<span class=\"token punctuation\">:</span> <span class=\"token string\">'.submit'</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>

    events<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
        <span class=\"token string\">'click @ui.submit'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'submitForm'</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>

    modelEvents<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
        <span class=\"token string\">'validated'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'setValidated'</span><span class=\"token punctuation\">,</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>

    onRender<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
        <span class=\"token comment\">//any other post-render View code here</span>

        Validation<span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>validated<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">validate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
        <span class=\"token punctuation\">}</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>

    setValidated<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>validated <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>

    submitForm<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
        <span class=\"token comment\">//handle form submission</span>
    <span class=\"token punctuation\">}</span>

<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>
<p>So it’s not that much code to add the functionality we want.  But when we need this code on multiple Views, adding and maintaining it becomes a pain quickly, creating the type of boilerplate that developers rage against.  So how can Behaviors help? It turns out to be easy to pull the functionality from our example out into a separate Behavior that any View can implement.  </p>
<p>That would look something like this:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> Mn <span class=\"token keyword\">from</span> <span class=\"token string\">'marionette'</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> Validation <span class=\"token keyword\">from</span> <span class=\"token string\">'backbone-validation'</span><span class=\"token punctuation\">;</span>

<span class=\"token keyword\">var</span> ValidationBehavior <span class=\"token operator\">=</span> Mn<span class=\"token punctuation\">.</span>Behavior<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>

    modelEvents<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
        <span class=\"token string\">'validated'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'setValidated'</span><span class=\"token punctuation\">,</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>

    onRender<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
        <span class=\"token comment\">//Set up any other form related stuff here</span>
        Validation<span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>hasBeenValidated<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">validate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
        <span class=\"token punctuation\">}</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>


    setValidated<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>hasBeenValidated <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>

<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> ValidationBehavior<span class=\"token punctuation\">;</span></code></pre></div>
<p>You could then pull the Behavior back into the View like this:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> Mn <span class=\"token keyword\">from</span> <span class=\"token string\">'marionette'</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> Validation <span class=\"token keyword\">from</span> <span class=\"token string\">'backbone-validation'</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> ValidationBehavior <span class=\"token keyword\">from</span> <span class=\"token string\">'behaviors/validation'</span><span class=\"token punctuation\">;</span>

<span class=\"token keyword\">var</span> FormView <span class=\"token operator\">=</span> Mn<span class=\"token punctuation\">.</span>LayoutView<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>

    template<span class=\"token punctuation\">:</span> <span class=\"token string\">'#form'</span><span class=\"token punctuation\">,</span>

    ui<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
        submit<span class=\"token punctuation\">:</span> <span class=\"token string\">'.submit'</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>

    events<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
        <span class=\"token string\">'click @ui.submit'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'submitForm'</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>

    behaviors<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
        validation<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
            behaviorClass<span class=\"token punctuation\">:</span> ValidationBehavior
        <span class=\"token punctuation\">}</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>

    submitForm<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
        <span class=\"token comment\">//handle form submission</span>
    <span class=\"token punctuation\">}</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>
<p>We could do this for any number of Views that required validation.  The same thing can be done for many other types of functionality, including key-binding and “warn before delete”.</p>
<h3>Behaviors API</h3>
<p>Behaviors have essentially the same API as Marionette Views, because they’re meant to be extracted out of existing Views.  So the event hashes, ui elements, and life-cycle methods that you find on a Marionette View are all also available on Behaviors.  The life cycle functions on a Behavior execute immediately after their corresponding functions on the Behavior’s associated View. Behaviors also get <code class=\"language-text\">el</code>, <code class=\"language-text\">$el</code> and <code class=\"language-text\">$</code> properties that are proxied to the equivalent properties on the Behaviors view.</p>
<p>Behaviors are not just mixins though. Behavior properties are isolated from the Views they’re associated with, preventing naming collisions and also encouraging reusable, decoupled designs.  Generally Behaviors don’t directly modify their associated Views or data.  The communication flow is one way, with Behaviors accepting input from their parent View in the form of an options object that is attached to the Behavior when it is created.  You can pass these options through using the behaviors hash on the View.  For instance to pass an error message to the validation behavior above, you could define your behaviors hash like this:</p>
<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    behaviors: {
        validation: {
            behaviorClass: ValidationBehavior,
            errorMessage: &#39;You did something wrong.&#39;
        }
    },</code></pre></div>
<h3>A quick note on how Behaviors attach to Views</h3>
<p>You can see in the example above that the general form for attaching Behaviors to a View is to include a key-value pair for each Behavior, where the value is an object that lays out the options for the Behavior.  The interesting thing in the example above is that the name of the key doesn’t matter at all.  It’s not used by the library in any way; instead Marionette picks out the correct behavior to use based on the behaviorClass property in the value.  So why is the API structured like that?  To understand, you need to know that the Behaviors API supports two separate scenarios for looking up the correct Behaviors for a View.  </p>
<p>The original API Marionette included for looking up Behaviors requires you to override a behaviorsLookup function on Marionette to tell the library where to retrieve your Behaviors from.  The keys of the behaviors hash on a view were passed to the lookup function, which then retrieved the Behavior classes from wherever the user chose to store them (probably a global namespace object).  </p>
<p>That API works great for developers used to using namespaces to organize their code, but for developers using modern JavaScript module loaders, it introduces global state and indirection where it wasn’t needed.  To handle this case, the behaviorClass key was added as an option for the value object, allowing developers to specify Behaviors as dependencies of the file they were defining a View in, and then attach the Behavior directly to the View.  </p>
<p>That makes much more sense for module users, but leads to a clunky API where the keys aren’t used.  Fortunately, in newer versions of Marionette you can get around this entirely, by defining your behaviors as an array on a view.  So the example above would look like:</p>
<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    behaviors: [{
        behaviorClass: ValidationBehavior,
        errorMessage: &#39;You did something wrong.&#39;
    }]</code></pre></div>
<p>This works due to an undocumented implementation detail in Marionette 2.4.1 <sup id=\"fnref:2\"><a href=\"#fn:2\">2</a></sup>, but will be <a href=\"https://github.com/marionettejs/backbone.marionette/pull/2368\">fully supported</a> in future versions.  In future versions you also will be able to pass a class directly as an array item if the Behavior is not taking any arguments, further cleaning up the API.</p>
<h3>When are Behaviors useful?</h3>
<p>Marionette’s documentation explains Behaviors very broadly, which makes sense for official documentation since it gives ideas without limiting how users think about them.  But in my experience Behaviors are best used for three different use-cases.</p>
<h4>Sharing common event handling logic</h4>
<p>This is the most obvious use for Behaviors, and what the documentation focuses on.  It’s easy to set up common event based UI patterns like “warn on close” with behaviors.  But they also can be used for more complicated event based UI logic.  At Windsor Circle we use 2 behaviors to share common “drag and drop” code with a Droppable Behavior that can be implemented by a CollectionView and a Draggable Behavior for ItemViews.  That makes it simple to make any CollectionView based list sortable with drag and drop, and keeps the code in a nice central place where any improvements will be shared across the code base.</p>
<h4>Sharing common life-cycle functions</h4>
<p>In addition to event handling, Behaviors also give you access to the various <a href=\"http://benmccormick.org/2015/01/05/marionette-view-life-cycles/\">life cycle</a> methods of Marionette Views.  That lets you split out common life cycle functionality and reduce code.  An easy example of this would be a Behavior that fades a View in each time by adding a css class with an animation associated with it.</p>
<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">let FadeIn = Marionette.Behavior.extend({
    onBeforeShow: function() {
        this.$el.addClass(&#39;hidden fadein&#39;);
    },
    onShow: function() {
        this.$el.removeClass(&#39;hidden&#39;);
    }
});</code></pre></div>
<p>which would work with a CSS snippet like this:</p>
<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.fadein {
  transition: opacity 1s;  
  opacity: 1;
}

.fadein.hidden {
    opacity: 0;
}</code></pre></div>
<h4>Simplifying integration with libraries</h4>
<p>This final use case is a special case of the first 2, but I think its worth mentioning in its own
category.  Many 3rd party Backbone or jQuery libraries require repetitive initialization code to use within a View.  This code is often the same across all Views, or only requires minor tweaks.  The perfect use case for a Behavior!  The Validation code above is one example of this, but it’s useful for many plugins.  For instance, if you use the <a href=\"http://harvesthq.github.io/chosen/\">Chosen</a> jQuery plugin to create rich dropdown boxes, you could create a Behavior to automatically initialize select elements with Chosen, and optionally pass a class to restrict it to only initialize selects with a specific class.</p>
<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">let UseChosen = Marionette.Behavior.extend({
    onRender: function() {
        let className = this.options.className,
            chosenOptions = this.options.chosenOptions || {};
        if(className) {
            this.$(&#39;.${className}&#39;).chosen(chosenOptions);
        }
        else {
            this.$(&#39;select&#39;).chosen(chosenOptions);
        }
    }
});</code></pre></div>
<h4>Wrap-Up</h4>
<p>Behaviors are a great resource for avoiding repetition in your Backbone code.  If you have examples of good open-source Behaviors out there, please mention them in the comments.  I’d also love to hear what use cases you’ve found for them, even if the code isn’t public to share.</p>
<h3>More Resources</h3>
<ul>
<li>Atomic Object has a <a href=\"http://spin.atomicobject.com/2014/09/11/marionette-behaviors-overview/\">nice writeup</a> on Marionette Behaviors, and a <a href=\"http://spin.atomicobject.com/2014/09/12/testing-marionette-js-behaviors/\">followup on testing them</a>.</li>
<li>Behaviors seem to make the most sense to people when given examples of how you might use them.  One great open-source example is this <a href=\"https://github.com/behave-ui/behave-ui-hotkeys\">key-binding Behavior</a> that makes it easy for you to add keyboard shortcuts to a View</li>
</ul>
<div class=\"footnotes\">
<ol>
    <li class=\"footnote\" id=\"fn:1\">
        <p>
        Going forward on this blog I'm planning on using ES6 features in code examples where appropriate.  If the code looks weird to you check out <a href=\"https://babeljs.io/docs/learn-es6/\">this nice summary of ES6 features</a>.    
        </p>
        <a href=\"#fnref:1\" title=\"return to article\"> ↩</a></p>
    </li>
    <li class=\"footnote\" id=\"fn:2\">
        <p>
        The latest version of Marionette at the time of writing.
        </p>
        <a href=\"#fnref:2\" title=\"return to article\"> ↩</a></p>
    </li>
</ol>
</div>",
                    "author": {
                      "@type": "Person",
                      "name": "Ben McCormick"
                      "email": "mailto:ben@benmccormick.org",
                      "image": "/profile_pic.jpg",
                      "jobTitle": "Software Engineer",
                      "alumniOf": "Duke",
                      "birthPlace": "Pittsburgh, PA",
                      "gender": "male",
                      "url": "http://benmccormick.org",
                	    "sameAs" : [
                        "https://www.linkedin.com/in/benmccormick",
                        "http://twitter.com/_benmccormick",
                      ]
                   }
                }</script><link as="script" rel="preload" href="/component---src-templates-blog-post-js-f7142fd23fbb70bfa210.js"/><link as="script" rel="preload" href="/app-9902c818c6d2b9b8163c.js"/><link as="script" rel="preload" href="/1-1fe1c56ce7d6c86a16dd.js"/><link as="script" rel="preload" href="/0-69fdf47151a6055542cf.js"/><link as="script" rel="preload" href="/2-05840d36207639450f79.js"/><link as="script" rel="preload" href="/webpack-runtime-86652cac7aa22776edbe.js"/><link as="fetch" rel="preload" href="/static/d/607/path---2015-03-23-staying-dry-with-marionette-behaviors-c-2-d-ed1-Eg6E2NU7vKC0m2FCUoqmj2idvyE.json" crossOrigin="use-credentials"/></head><body class="landing-page" style="background:#FCFCFC"><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><style data-emotion-css="1f3kluc">.css-1f3kluc{width:100%;max-width:1000px;margin:0 auto;padding:2.4rem 20px;}</style><div class="css-1f3kluc em100y90"><style data-emotion-css="13vv67v">.css-13vv67v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding-bottom:2rem;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}</style><div class="css-13vv67v e1b8f8ar0"><style data-emotion-css="txnzm6">.css-txnzm6{margin:0 20px 0 0;padding-bottom:0;}.css-txnzm6 a{box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;}.css-txnzm6 a:hover{-webkit-text-decoration:none;text-decoration:none;}</style><h3 class="css-txnzm6 e1b8f8ar2"><a name="title" href="/">Ben McCormick</a></h3><style data-emotion-css="177tisd">.css-177tisd{color:#999999;}</style><div class="css-177tisd e1b8f8ar3"><a class="css-tcc0st" href="/archive/">Blog</a><style data-emotion-css="12jh0su">.css-12jh0su{padding:0 0.5rem;}@media all and (max-width:400px){.css-12jh0su{padding:0 0.25rem;}}</style><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="/subscribe/">Subscribe</a><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="/speaking/">Speaking</a><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="http://twitter.com/_benmccormick">Twitter</a><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="/about/">About</a></div></div><article class="markdown"><div class="post-title-area"><style data-emotion-css="92repi">.css-92repi{display:block;max-width:100%;}</style><h1 class="css-92repi e15djruj0">Staying DRY with Marionette Behaviors</h1></div><div class="columns"><style data-emotion-css="qsg3oo">.css-qsg3oo{max-width:100%;}.css-qsg3oo li{padding-left:10px;}.css-qsg3oo .reading-img img{width:150px;float:right;margin:0px 10px 20px 10px;}.css-qsg3oo img.full-width{max-height:none;}.css-qsg3oo img.half-width{max-height:none;width:50%;}</style><div class="css-qsg3oo e15djruj2"><p><em>This is the sixth post in a series on <a href="http://marionettejs.com/">Marionette.js</a>.  For more background on what Marionette is, check out the series page, <a href="http://benmccormick.org/marionette-explained/">Marionette Explained</a></em></p>
<p>Any successful project draws complaints, and <a href="http://backbonejs.org/">Backbone.js</a> is a successful project by pretty much any measurement.  The biggest complaints I’ve heard leveled against Backbone as an MVC framework revolve around the boilerplate involved in writing Backbone apps.  The claim goes that Backbone forces you to write the same event binding and workflow code over and over again.  In general I’d claim that’s a feature of <em>bad</em> Backbone apps, and  not something unavoidable.  But it’s certainly true that Backbone doesn’t give you much guidance on how to reduce repetition and boilerplate in your code.  Making it easy to reduce repetition turns out to be one of the main roles of <a href="http://marionettejs.com/">Marionette</a>. This post is a look at one of the tools that Marionette provides to help you simplify your applications: the Behavior class.</p>
<p>Marionette Behaviors are reusable chunks of UI logic that you can mix into your Views.  When you have a common problem that you face across several Views, Behaviors can help you reduce boilerplate and repetition.  We’ll take a look at a practical example first, and then we can get into the Behaviors API.  </p>
<p>Let’s see how Behaviors can help us write better form validation code.  When I’m validating forms, I use the <a href="http://thedersen.com/projects/backbone-validation/">backbone.validation</a> library. It provides helpers for checking the validity of model properties and attaching error messages to inputs, but doesn’t force a specific workflow. However, I have a specific flow I usually want.  A user should be able to enter data as they see fit to start, with no validation warnings until they’ve tried to submit the form.  After they’ve initially submitted the form, warnings should appear next to any invalid fields, and they should update and disappear as the user fixes their input.</p>
<p>That process is pretty easy to implement with backbone.validation.  I simply connect my Model to each form View I create, and in the Model I add some logic to re-validate each time the Model is changed, but only after the first time validation is triggered by a user submit.  That works great in most cases.  The problem comes when I need to re-render my view in the middle of this process.  This is a pretty common occurrence if your form has sub-views that may appear based on the contents of other parts of the form. In that case, I have to make sure that the validation state persists across renders.  That might look something like this. <sup id="fnref:1"><a href="#fn:1">1</a></sup></p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Mn <span class="token keyword">from</span> <span class="token string">'marionette'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Validation <span class="token keyword">from</span> <span class="token string">'backbone-validation'</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> FormView <span class="token operator">=</span> Mn<span class="token punctuation">.</span>LayoutView<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

    template<span class="token punctuation">:</span> <span class="token string">'#form'</span><span class="token punctuation">,</span>

    ui<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        submit<span class="token punctuation">:</span> <span class="token string">'.submit'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    events<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'click @ui.submit'</span><span class="token punctuation">:</span> <span class="token string">'submitForm'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    modelEvents<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'validated'</span><span class="token punctuation">:</span> <span class="token string">'setValidated'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    onRender<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//any other post-render View code here</span>

        Validation<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>validated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    setValidated<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>validated <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    submitForm<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//handle form submission</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>So it’s not that much code to add the functionality we want.  But when we need this code on multiple Views, adding and maintaining it becomes a pain quickly, creating the type of boilerplate that developers rage against.  So how can Behaviors help? It turns out to be easy to pull the functionality from our example out into a separate Behavior that any View can implement.  </p>
<p>That would look something like this:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Mn <span class="token keyword">from</span> <span class="token string">'marionette'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Validation <span class="token keyword">from</span> <span class="token string">'backbone-validation'</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> ValidationBehavior <span class="token operator">=</span> Mn<span class="token punctuation">.</span>Behavior<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

    modelEvents<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'validated'</span><span class="token punctuation">:</span> <span class="token string">'setValidated'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    onRender<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//Set up any other form related stuff here</span>
        Validation<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>hasBeenValidated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>view<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    setValidated<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>hasBeenValidated <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ValidationBehavior<span class="token punctuation">;</span></code></pre></div>
<p>You could then pull the Behavior back into the View like this:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Mn <span class="token keyword">from</span> <span class="token string">'marionette'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Validation <span class="token keyword">from</span> <span class="token string">'backbone-validation'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ValidationBehavior <span class="token keyword">from</span> <span class="token string">'behaviors/validation'</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> FormView <span class="token operator">=</span> Mn<span class="token punctuation">.</span>LayoutView<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

    template<span class="token punctuation">:</span> <span class="token string">'#form'</span><span class="token punctuation">,</span>

    ui<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        submit<span class="token punctuation">:</span> <span class="token string">'.submit'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    events<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'click @ui.submit'</span><span class="token punctuation">:</span> <span class="token string">'submitForm'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    behaviors<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        validation<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            behaviorClass<span class="token punctuation">:</span> ValidationBehavior
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    submitForm<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//handle form submission</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>We could do this for any number of Views that required validation.  The same thing can be done for many other types of functionality, including key-binding and “warn before delete”.</p>
<h3>Behaviors API</h3>
<p>Behaviors have essentially the same API as Marionette Views, because they’re meant to be extracted out of existing Views.  So the event hashes, ui elements, and life-cycle methods that you find on a Marionette View are all also available on Behaviors.  The life cycle functions on a Behavior execute immediately after their corresponding functions on the Behavior’s associated View. Behaviors also get <code class="language-text">el</code>, <code class="language-text">$el</code> and <code class="language-text">$</code> properties that are proxied to the equivalent properties on the Behaviors view.</p>
<p>Behaviors are not just mixins though. Behavior properties are isolated from the Views they’re associated with, preventing naming collisions and also encouraging reusable, decoupled designs.  Generally Behaviors don’t directly modify their associated Views or data.  The communication flow is one way, with Behaviors accepting input from their parent View in the form of an options object that is attached to the Behavior when it is created.  You can pass these options through using the behaviors hash on the View.  For instance to pass an error message to the validation behavior above, you could define your behaviors hash like this:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">    behaviors: {
        validation: {
            behaviorClass: ValidationBehavior,
            errorMessage: &#39;You did something wrong.&#39;
        }
    },</code></pre></div>
<h3>A quick note on how Behaviors attach to Views</h3>
<p>You can see in the example above that the general form for attaching Behaviors to a View is to include a key-value pair for each Behavior, where the value is an object that lays out the options for the Behavior.  The interesting thing in the example above is that the name of the key doesn’t matter at all.  It’s not used by the library in any way; instead Marionette picks out the correct behavior to use based on the behaviorClass property in the value.  So why is the API structured like that?  To understand, you need to know that the Behaviors API supports two separate scenarios for looking up the correct Behaviors for a View.  </p>
<p>The original API Marionette included for looking up Behaviors requires you to override a behaviorsLookup function on Marionette to tell the library where to retrieve your Behaviors from.  The keys of the behaviors hash on a view were passed to the lookup function, which then retrieved the Behavior classes from wherever the user chose to store them (probably a global namespace object).  </p>
<p>That API works great for developers used to using namespaces to organize their code, but for developers using modern JavaScript module loaders, it introduces global state and indirection where it wasn’t needed.  To handle this case, the behaviorClass key was added as an option for the value object, allowing developers to specify Behaviors as dependencies of the file they were defining a View in, and then attach the Behavior directly to the View.  </p>
<p>That makes much more sense for module users, but leads to a clunky API where the keys aren’t used.  Fortunately, in newer versions of Marionette you can get around this entirely, by defining your behaviors as an array on a view.  So the example above would look like:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">    behaviors: [{
        behaviorClass: ValidationBehavior,
        errorMessage: &#39;You did something wrong.&#39;
    }]</code></pre></div>
<p>This works due to an undocumented implementation detail in Marionette 2.4.1 <sup id="fnref:2"><a href="#fn:2">2</a></sup>, but will be <a href="https://github.com/marionettejs/backbone.marionette/pull/2368">fully supported</a> in future versions.  In future versions you also will be able to pass a class directly as an array item if the Behavior is not taking any arguments, further cleaning up the API.</p>
<h3>When are Behaviors useful?</h3>
<p>Marionette’s documentation explains Behaviors very broadly, which makes sense for official documentation since it gives ideas without limiting how users think about them.  But in my experience Behaviors are best used for three different use-cases.</p>
<h4>Sharing common event handling logic</h4>
<p>This is the most obvious use for Behaviors, and what the documentation focuses on.  It’s easy to set up common event based UI patterns like “warn on close” with behaviors.  But they also can be used for more complicated event based UI logic.  At Windsor Circle we use 2 behaviors to share common “drag and drop” code with a Droppable Behavior that can be implemented by a CollectionView and a Draggable Behavior for ItemViews.  That makes it simple to make any CollectionView based list sortable with drag and drop, and keeps the code in a nice central place where any improvements will be shared across the code base.</p>
<h4>Sharing common life-cycle functions</h4>
<p>In addition to event handling, Behaviors also give you access to the various <a href="http://benmccormick.org/2015/01/05/marionette-view-life-cycles/">life cycle</a> methods of Marionette Views.  That lets you split out common life cycle functionality and reduce code.  An easy example of this would be a Behavior that fades a View in each time by adding a css class with an animation associated with it.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">let FadeIn = Marionette.Behavior.extend({
    onBeforeShow: function() {
        this.$el.addClass(&#39;hidden fadein&#39;);
    },
    onShow: function() {
        this.$el.removeClass(&#39;hidden&#39;);
    }
});</code></pre></div>
<p>which would work with a CSS snippet like this:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.fadein {
  transition: opacity 1s;  
  opacity: 1;
}

.fadein.hidden {
    opacity: 0;
}</code></pre></div>
<h4>Simplifying integration with libraries</h4>
<p>This final use case is a special case of the first 2, but I think its worth mentioning in its own
category.  Many 3rd party Backbone or jQuery libraries require repetitive initialization code to use within a View.  This code is often the same across all Views, or only requires minor tweaks.  The perfect use case for a Behavior!  The Validation code above is one example of this, but it’s useful for many plugins.  For instance, if you use the <a href="http://harvesthq.github.io/chosen/">Chosen</a> jQuery plugin to create rich dropdown boxes, you could create a Behavior to automatically initialize select elements with Chosen, and optionally pass a class to restrict it to only initialize selects with a specific class.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">let UseChosen = Marionette.Behavior.extend({
    onRender: function() {
        let className = this.options.className,
            chosenOptions = this.options.chosenOptions || {};
        if(className) {
            this.$(&#39;.${className}&#39;).chosen(chosenOptions);
        }
        else {
            this.$(&#39;select&#39;).chosen(chosenOptions);
        }
    }
});</code></pre></div>
<h4>Wrap-Up</h4>
<p>Behaviors are a great resource for avoiding repetition in your Backbone code.  If you have examples of good open-source Behaviors out there, please mention them in the comments.  I’d also love to hear what use cases you’ve found for them, even if the code isn’t public to share.</p>
<h3>More Resources</h3>
<ul>
<li>Atomic Object has a <a href="http://spin.atomicobject.com/2014/09/11/marionette-behaviors-overview/">nice writeup</a> on Marionette Behaviors, and a <a href="http://spin.atomicobject.com/2014/09/12/testing-marionette-js-behaviors/">followup on testing them</a>.</li>
<li>Behaviors seem to make the most sense to people when given examples of how you might use them.  One great open-source example is this <a href="https://github.com/behave-ui/behave-ui-hotkeys">key-binding Behavior</a> that makes it easy for you to add keyboard shortcuts to a View</li>
</ul>
<div class="footnotes">
<ol>
    <li class="footnote" id="fn:1">
        <p>
        Going forward on this blog I'm planning on using ES6 features in code examples where appropriate.  If the code looks weird to you check out <a href="https://babeljs.io/docs/learn-es6/">this nice summary of ES6 features</a>.    
        </p>
        <a href="#fnref:1" title="return to article"> ↩</a></p>
    </li>
    <li class="footnote" id="fn:2">
        <p>
        The latest version of Marionette at the time of writing.
        </p>
        <a href="#fnref:2" title="return to article"> ↩</a></p>
    </li>
</ol>
</div></div><style data-emotion-css="rd3zyi">.css-rd3zyi{padding-left:2rem;overflow:hidden;}</style><div class="no-mobile css-rd3zyi e15djruj3"><style data-emotion-css="1y23a7j">.css-1y23a7j{overflow:hidden;margin:0;}.css-1y23a7j #mc_embed_signup form{margin-bottom:20px;}@media all and (max-width:700px){.css-1y23a7j{padding-right:0;width:100% !important;padding:0 10px;}.css-1y23a7j .mc-field-group{width:100% !important;}.css-1y23a7j .mc-field-group input{width:100% !important;font-size:0.8em;height:2.4em;}}</style><div class="css-1y23a7j e1qbom70"><form action="https://buttondown.email/api/emails/embed-subscribe/benmccormick" method="post" target="popupwindow" class="embeddable-buttondown-form"><label for="bd-email" id="bd-label">Subscribe to the Newsletter</label><input type="hidden" value="1" name="embed"/><div class="bd-subscribe-row"><input type="email" name="email" id="bd-email" placeholder="Your Email"/><input type="submit" value="Subscribe" id="bd-submit"/></div></form></div><style data-emotion-css="wtijjp">.css-wtijjp{width:100%;overflow:hidden;margin:0 0 1rem 0;font-size:14px;position:relative;font-family:"mr-eaves-xl-modern","Helvetica Neue",Arial,sans-serif;background:rgba(99,159,110,0.25);border:1px solid rgba(90,150,100,0.5);padding:4px;min-height:100px;opacity:0;-webkit-transition:opacity ease 3s;transition:opacity ease 3s;}@media all and (max-width:700px){.css-wtijjp{display:none;}}</style><div class="css-wtijjp etmlefq0"></div><style data-emotion-css="1ui09x8">.css-1ui09x8{font-size:14px;background-color:RGBA(191,237,253,0.5);border:1px solid #68d4fa;padding:0.5rem;}.css-1ui09x8 > h4{font-size:20px;margin-bottom:6px;}.css-1ui09x8 > h6{font-size:18px;margin-bottom:6px;margin-top:12px;}</style><div class="css-1ui09x8 e15djruj1"><h4>Article Info</h4><h6>Author</h6><a href="/about">Ben McCormick</a><h6>Publish Date</h6>March 23rd 2015<h6>Category</h6><a class="css-1yx29dl" href="/category/frameworks"><style data-emotion-css="e7v39i">.css-e7v39i{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;margin-right:0.1rem;}@media all and (max-width:960px){.css-e7v39i{margin-right:0;}}</style><div class="css-e7v39i e1nsgn8x1"><style data-emotion-css="e7cou1">.css-e7cou1{display:block;width:0.8rem;height:0.8rem;margin-right:0.5rem;}.css-e7cou1 *{fill:#333;}.css-e7cou1 > i{height:0.16000000000000003rem;}</style><span color="#333" class="css-e7cou1 efpzdjd0"><i><svg viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>beaker</title><desc>Created with Sketch.</desc><defs></defs><g id="Octicons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="beaker" fill="#000000"><path d="M14.3797254,14.59 L10.9997254,7 L10.9997254,3 L11.9997254,3 L11.9997254,2 L2.99972539,2 L2.99972539,3 L3.99972539,3 L3.99972539,7 L0.62972539,14.59 C0.32972539,15.25 0.81972539,16 1.53972539,16 L13.4797254,16 C14.1997254,16 14.6797254,15.25 14.3897254,14.59 L14.3797254,14.59 Z M3.74972539,10 L4.99972539,7 L4.99972539,3 L9.99972539,3 L9.99972539,7 L11.2497254,10 L3.74972539,10 L3.74972539,10 Z M7.99972539,8 L8.99972539,8 L8.99972539,9 L7.99972539,9 L7.99972539,8 L7.99972539,8 Z M6.99972539,7 L5.99972539,7 L5.99972539,6 L6.99972539,6 L6.99972539,7 L6.99972539,7 Z M6.99972539,4 L7.99972539,4 L7.99972539,5 L6.99972539,5 L6.99972539,4 L6.99972539,4 Z M6.99972539,1 L5.99972539,1 L5.99972539,0 L6.99972539,0 L6.99972539,1 L6.99972539,1 Z" id="Shape"></path></g></g></svg></i></span></div><style data-emotion-css="1bs7qd7">.css-1bs7qd7:hover{-webkit-text-decoration:none;text-decoration:none;}</style><div class="css-1bs7qd7 e1nsgn8x0">JavaScript Libraries</div></a></div></div></div></article></div><style data-emotion-css="1tfasoy">.css-1tfasoy{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:3em 0 1em 0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:RGBA(191,237,253,0.5);border-top:1px solid #68d4fa;}</style><div class="css-1tfasoy e7oz9l30"><style data-emotion-css="7bdmpt">.css-7bdmpt{width:100%;min-height:200px;max-width:960px;margin:0 auto;padding:0 1.2rem;display:grid;grid-template-columns:45% 45%;grid-column-gap:10%;grid-row-gap:30px;}@media all and (max-width:450px){.css-7bdmpt{grid-template-columns:100%;}}</style><div class="css-7bdmpt e7oz9l31"><div><h2 class="css-0 e7oz9l33">Content</h2><style data-emotion-css="1xfqzqa">.css-1xfqzqa{display:grid;grid-template-columns:1fr;grid-auto-rows:1fr;grid-row-gap:20px;}</style><div class="css-1xfqzqa e7oz9l32"><a class="css-1gs5qio" href="/archive/">Blog Archive</a><a class="css-1gs5qio" href="/reviews-archive/">Book Reviews</a><a class="css-1gs5qio" href="https://buttondown.email/benmccormick">Newsletter Archives</a><a class="css-1gs5qio" href="/speaking/">Speaking</a></div></div><div><h2 class="css-0 e7oz9l33">Meta</h2><div class="css-1xfqzqa e7oz9l32"><a class="css-1gs5qio" href="/subscribe/">Subscribe To The Newsletter</a><a class="css-1gs5qio" href="/built-with/">Built With</a><a class="css-1gs5qio" href="http://twitter.com/_benmccormick">Personal Twitter</a><a class="css-1gs5qio" href="http://twitter.com/benmccormickorg">Blog Twitter</a><a class="css-1gs5qio" href="/about/">About Me</a></div></div><style data-emotion-css="i3iawv">.css-i3iawv{font-family:"mr-eaves-xl-modern","Helvetica Neue",Arial,sans-serif;font-size:14px;overflow:visible;white-space:nowrap;}</style><div class="css-i3iawv e7oz9l34">Copyright © 2012-2019 · Ben McCormick</div></div></div></div></div><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-37323973-1', 'auto');
            ga('send', 'pageview');
        </script><script>
          (function(d) {
            var config = {
              kitId: 'msd6bqv',
              scriptTimeout: 300,
              async: true
            },
            h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/wf-loading/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
          })(document);
        </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"2015-03-23-staying-dry-with-marionette-behaviors-c2d","path":"/2015/03/23/staying-dry-with-marionette-behaviors"};window.dataPath="607/path---2015-03-23-staying-dry-with-marionette-behaviors-c-2-d-ed1-Eg6E2NU7vKC0m2FCUoqmj2idvyE";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-9902c818c6d2b9b8163c.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js.8d5fb7e09aa4ea7497f6.css","/component---src-templates-blog-post-js-f7142fd23fbb70bfa210.js"],"component---src-templates-category-page-js":["/component---src-templates-category-page-js-bcd6550cc205b7f6a000.js"],"component---src-templates-topic-page-js":["/component---src-templates-topic-page-js-4ee7f6cc28fa02fbf9a1.js"],"component---src-pages-archive-js":["/component---src-pages-archive-js-22a6d602f9fe79a43534.js"],"component---src-pages-index-js":["/component---src-pages-index-js-e87d2179286b28a3d63a.js"],"component---src-pages-links-archive-js":["/component---src-pages-links-archive-js-bfa34614b1b65d4be290.js"],"component---src-pages-lions-archive-js":["/component---src-pages-lions-archive-js-6a11735ea0da4313ad85.js"],"component---src-pages-reviews-archive-js":["/component---src-pages-reviews-archive-js-c62044a370ce794429c8.js"]};/*]]>*/</script><script src="/webpack-runtime-86652cac7aa22776edbe.js" async=""></script><script src="/2-05840d36207639450f79.js" async=""></script><script src="/0-69fdf47151a6055542cf.js" async=""></script><script src="/1-1fe1c56ce7d6c86a16dd.js" async=""></script><script src="/app-9902c818c6d2b9b8163c.js" async=""></script><script src="/component---src-templates-blog-post-js-f7142fd23fbb70bfa210.js" async=""></script></body></html>