<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=yyxgnp97qG"/><link rel="icon" type="image/png" href="/favicon-32x32.png?v=yyxgnp97qG" sizes="32x32"/><link rel="icon" type="image/png" href="/favicon-16x16.png?v=yyxgnp97qG" sizes="16x16"/><link rel="manifest" href="/manifest.json"/><link rel="mask-icon" href="/safari-pinned-tab.svg?v=yyxgnp97qG" color="#rgb(42, 194, 240)"/><link rel="alternate" title="JSON Feed" type="application/json" href="/feed.json"/><link rel="shortcut icon" href="/favicon.ico?v=yyxgnp97qG"/><meta name="theme-color" content="#ffffff"/><title data-react-helmet="true"></title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.6 'minion-3','Garamond',serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'minion-3','Garamond',serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.6rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.32578rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.20684rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.91028rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.86849rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}ul{margin-left:1.6rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.6rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;font-size:0.85rem;line-height:1.1;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.2rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;font-size:1rem;line-height:1.6rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}blockquote{margin-left:1.6rem;margin-right:1.6rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.2rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.2rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.6rem;margin-bottom:calc(1.2rem / 2);margin-top:calc(1.2rem / 2);}li > ul{margin-left:1.6rem;margin-bottom:calc(1.2rem / 2);margin-top:calc(1.2rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.2rem / 2);}code{font-size:0.85rem;line-height:1.6rem;}kbd{font-size:0.85rem;line-height:1.6rem;}samp{font-size:0.85rem;line-height:1.6rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.06667rem;padding-right:1.06667rem;padding-top:0.8rem;padding-bottom:calc(0.8rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;font-size:14px;}pre code{background:none;line-height:1.1;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}h1,h2,h3,h4,h5,h6{line-height:1.1;}@media only screen and (max-width:480px){html{font-size:112.5%;}}</style><style data-href="/component---src-templates-blog-post-js.d5c164db07d2a4f14ec9.css">.markdown pre{display:block;background:#343d46;color:#d8dee9;padding:.8rem}.markdown pre code:after{content:unset}.token.comment,.token.quote{color:#a7adba}.token.addition,.token.attr,.token.selector-tag,.token.string{color:#99c794}.token.doctag,.token.meta .token.meta-string,.token.regexp{color:#89ddf3}.token.built_in,.token.function{color:#5fb3b3}.token.name,.token.section,.token.selector-class,.token.selector-id,.token.title{color:#69c}.token.attribute,.token.class .token.title,.token.template-variable,.token.type,.token.variable{color:#fac863}.token.bullet,.token.link,.token.meta,.token.meta .token.keyword,.token.selector-attr,.token.selector-pseudo,.token.subst,.token.symbol{color:#f9ae58}.token.boolean,.token.deletion,.token.literal,.token.number{color:#f07178}.token.keyword{color:#c594c5}.token.formula{background:#a7adba}.token.emphasis{font-style:italic}.token.strong{font-weight:700}.gatsby-resp-image-wrapper{max-width:75%;display:block;margin:40px auto 20px}.bordered-img{border:3px solid #rgb(42,194,240)}.img-group{display:flex;justify-content:space-between}.img-group img{padding:0;height:auto}.inline-img{width:45%;display:inline-block;float:right;padding:2rem}#bd-label{font-family:mr-eaves-xl-modern,Helvetica Neue,Arial,sans-serif;font-weight:700}#bd-label.large-label{font-size:20px}#bd-email{padding-left:5px}#bd-email,#bd-submit{font-family:mr-eaves-xl-modern,Helvetica Neue,Arial,sans-serif;font-size:14px}#bd-submit{background:#f1684e;color:#fff;border-radius:4px;border:none}@media (max-width:960px){#bd-email,#bd-submit{font-size:10px}#bd-label{font-size:12px}}.large-row #bd-email,.large-row #bd-submit{font-size:30px}@media (max-width:700px){.large-row #bd-email,.large-row #bd-submit{font-size:18px}}.bd-subscribe-form{margin:30px 0 50px;display:block}.bd-subscribe-row{display:grid;grid-template-columns:60% 35%;grid-column-gap:5%;grid-template-rows:1fr;margin-top:10px}@media (max-width:960px){.bd-subscribe-row{grid-template-columns:1fr;grid-row-gap:10%;grid-template-rows:1fr 1fr}}.twitter-tweet,twitterwidget{margin-left:auto;margin-right:auto}.sidebar-group{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;padding:8px 0}.sidebar{padding-left:2rem}.subscribe-container{display:flex;justify-content:flex-end;flex-wrap:wrap}.subscribe-email{padding:0 .1rem;margin:0 .2rem 0 0;font-size:.7rem;height:1.5rem;width:6rem}.subscribe-button{color:#fff;background:#rgb(42,194,240);border-radius:4px;font-size:1rem;line-height:1rem;height:1.5rem;width:1.5rem;max-width:2rem;flex-grow:0;border:0;margin:0;cursor:pointer}.rss{padding-bottom:10px}.rss a{display:flex}.rss-icon{display:block;width:17px;margin-right:.5em;height:50px}.rss-icon *{fill:#f1684e}.twitter-item{display:flex;align-items:center;margin-bottom:15px}.twitter-item iframe{margin:0 0 0 10px}</style><style data-href="/0.fff3f37ab39dd41df440.css">a{color:#f1684e;text-decoration:none;cursor:pointer}a:hover{text-decoration:underline}.footnote-backref,.footnote-ref{text-decoration:none;padding-left:3px}blockquote{border-left:5px solid #2ac2f0;background:#eee;font-weight:400;font-size:.9rem;padding:1.5rem 2rem;margin:0 0 1rem}blockquote p{margin-bottom:.667em}h3{color:#2ac2f0}h4{font-size:110%}.explanation{padding:10px;background:#eee;border-radius:10px;margin:20px auto;font-size:.85em}.footnotes{font-size:80%}.footnotes li>*{display:inline;margin-bottom:0}strong{color:#639f6e}em{color:#9a74aa}.markdown iframe{margin:0 auto}.carbon-wrap{display:grid;grid-template-columns:1fr 1fr;grid-column-gap:10px;grid-template-rows:1fr;margin-bottom:30px;align-items:center;padding-left:5px}@media (max-width:960px){.carbon-wrap{grid-template-columns:1fr;grid-template-rows:110px 1fr;grid-row-gap:10px;justify-items:center}}.carbon-wrap img{margin-bottom:0}.carbon-text{padding:5px 5px 5px 0;display:inline-block;overflow:hidden;line-height:1.3}.carbon-poweredby{color:#999;position:absolute;right:5px;bottom:0}.columns{display:grid;grid-template-columns:665px 270px;grid-template-rows:1fr;grid-column-gap:25px}@media (max-width:960px){.columns{display:grid;grid-template-columns:70% 28%;grid-column-gap:2%}}@media (max-width:700px){.columns{display:flex;flex-direction:column;align-items:center}.no-mobile{display:none}}@media (max-width:321px){html{font-size:100%!important}}</style><meta name="generator" content="Gatsby 2.0.75"/><style id="glamor-styles">.css-tcc0st,[data-css-tcc0st]{color:#999999;font-size:16px;font-family:"mr-eaves-xl-modern", "Helvetica Neue", Arial, sans-serif;}.css-tcc0st:hover,[data-css-tcc0st]:hover{color:#F1684E;}.css-1gs5qio,[data-css-1gs5qio]{font-size:16px;font-family:"mr-eaves-xl-modern", "Helvetica Neue", Arial, sans-serif;}</style><script id="glamor-ids">
        // <![CDATA[
        window._glamor = ["tcc0st","1gs5qio"]
        // ]]>
        </script><title data-react-helmet="true">benmccormick.org</title><meta data-react-helmet="true" name="description" content="Ben McCormick&#x27;s blog on JavaScript and Web Development"/><meta data-react-helmet="true" name="keywords"/><script data-react-helmet="true" type="application/ld+json">{
                  "@context": "http://schema.org"
                  "@type": "BlogPosting",
                  "headline": "",
                  "genre": "Software Development",
                  "keywords": "",
                  "url": "http://benmccormick.org//posts/drafts/old-drafts/lodash/lodash_reduce/",
                  "image": "http://benmccormick.org/logo.png",
                  "datePublished": "1970-01-1",
                  
                  "articleBody": "<h1>Diving into lodash: Reducing collections</h1>
<p>7 years ago, TC39, the group responsible for authoring the ECMAScript standard produced ES5, the 4th major version of the JavaScript language<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup>.  One of the hallmark features of that release was a set of functional methods for working with arrays: <code class=\"language-text\">forEach</code>, <code class=\"language-text\">map</code>, <code class=\"language-text\">filter</code> and <code class=\"language-text\">reduce</code>.  The first 3 seem to be fairly well understood and widely used by many JavaScript developers, but <code class=\"language-text\">reduce</code> has remained more obscure.  </p>
<p>The purpose of <code class=\"language-text\">reduce</code> is to provide a simple functional way to reduce a list of values into a single value.  This can be done for simple mathematical operations like summing or maxing, to build complex objects out of a list of keys, or to transform a dataset into a different form.</p>
<p><code class=\"language-text\">reduce</code> takes 2 arguments, a reducer function and an optional initial value (also called an accumulator) and returns an aggregate value.  For each item in an array the reducer function receives the current value of the aggregate, the next value in the array, the index of the value, and a reference to the whole collection.  In practice, using it can look like this:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\">
      <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//generate a list of random numbers between 0 and 99</span>
<span class=\"token keyword\">let</span> nums <span class=\"token operator\">=</span> _<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">.</span><span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> _<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

<span class=\"token comment\">//get the maximum value</span>
<span class=\"token keyword\">let</span> max <span class=\"token operator\">=</span> nums<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>max<span class=\"token punctuation\">,</span> num<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> num <span class=\"token operator\">></span> max <span class=\"token operator\">?</span> num <span class=\"token punctuation\">:</span> max<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>

<span class=\"token comment\">// get the sum of all of the numbers</span>
<span class=\"token keyword\">let</span> sum <span class=\"token operator\">=</span> nums<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>total<span class=\"token punctuation\">,</span> num<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> num <span class=\"token operator\">+</span> total<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>

<span class=\"token comment\">// Get the counts of the occurence of each number between 0 and 99 in nums</span>
<span class=\"token keyword\">let</span> frequencies <span class=\"token operator\">=</span>_<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">.</span><span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
frequencies <span class=\"token operator\">=</span> nums<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> num<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> arr<span class=\"token punctuation\">[</span>num<span class=\"token punctuation\">]</span><span class=\"token operator\">++</span><span class=\"token punctuation\">,</span> frequencies<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>
      </div>
<p>lodash provides its own version of the native <code class=\"language-text\">reduce</code>.  <code class=\"language-text\">_.reduce</code> works similarly to the native function, but takes the collection as its first object and like other lodash functions will accept any array-like object and iterate it like an array, or normal objects, with which it will iterate over key value pairs. <code class=\"language-text\">_.reduce</code> also has special compatibility with many lodash functions that take multiple arguments, and makes sure to pass them only the first 2 arguments to avoid the index and collection arguments contaminating the function.  This allows code like this more complex version of the example from <a href=\"\">my article on merging objects in lodash</a> :</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\">
      <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> contacts <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>
    firstName<span class=\"token punctuation\">:</span> <span class=\"token string\">'John'</span><span class=\"token punctuation\">,</span>
    lastName<span class=\"token punctuation\">:</span> <span class=\"token string\">'Smith'</span><span class=\"token punctuation\">,</span>
    phone<span class=\"token punctuation\">:</span> <span class=\"token string\">'919.222.7855'</span><span class=\"token punctuation\">,</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span>
    firstName<span class=\"token punctuation\">:</span> <span class=\"token string\">'John'</span><span class=\"token punctuation\">,</span>
    phone<span class=\"token punctuation\">:</span> <span class=\"token string\">'919.965.9999'</span><span class=\"token punctuation\">,</span>
    email<span class=\"token punctuation\">:</span> <span class=\"token string\">'john.smith@gmail.com'</span><span class=\"token punctuation\">,</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span>
    firstName<span class=\"token punctuation\">:</span> <span class=\"token string\">'John'</span><span class=\"token punctuation\">,</span>
    lastName<span class=\"token punctuation\">:</span> <span class=\"token string\">'Smith'</span><span class=\"token punctuation\">,</span>
    twitter<span class=\"token punctuation\">:</span> <span class=\"token string\">'@johnsmith232'</span><span class=\"token punctuation\">,</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>

_<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span>contacts<span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">.</span>assign<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token comment\">// {firstName: \"John\", lastName: \"Smith\", phone: \"919.965.9999\", email: \"john.smith@gmail.com\", twitter: \"@johnsmith232\"}</span></code></pre>
      </div>
<p>We can also use <code class=\"language-text\">_.reduce</code> to recreate other lodash methods like <code class=\"language-text\">_.map</code> or <code class=\"language-text\">_.reverse</code>.  Here’s an implementation of <code class=\"language-text\">_.reverse</code>:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\">
      <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">reverse</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> _<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>newArr<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
    newArr<span class=\"token punctuation\">.</span><span class=\"token function\">unshift</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
    <span class=\"token keyword\">return</span> newArr<span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>
      </div>
<p>The above code works fine, but it is extremely inefficient for large arrays.  </p>
<div class=\"gatsby-highlight\" data-language=\"javascript\">
      <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">.</span><span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 0.09 seconds</span>
<span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">.</span><span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 2.84 seconds</span>
<span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">.</span><span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// over 6 minutes</span></code></pre>
      </div>
<p>The problem is that we’re shifting all of the values in the array everytime we insert a new value.  It would be great if we could just add values to the end instead, but we’re getting them in the wrong order.  Fortunately, lodash provides <code class=\"language-text\">_.reduceRight</code>. <code class=\"language-text\">_.reduceRight</code> works the same way as <code class=\"language-text\">_.reduce</code>, but starts from the end of the collection rather than the beginning.  That allows us to create a more efficient <code class=\"language-text\">reverse</code>:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\">
      <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">betterReverse</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> _<span class=\"token punctuation\">.</span><span class=\"token function\">reduceRight</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>newArr<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
    newArr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
    <span class=\"token keyword\">return</span> newArr<span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

<span class=\"token function\">betterReverse</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">.</span><span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 0.11 seconds</span></code></pre>
      </div>
<h3>_.transform</h3>
<p><code class=\"language-text\">_.transform</code> is a variation on reduce with some different behavior.  If you don’t pass a specific initial value, <code class=\"language-text\">_.transform</code> will try to do the right thing by reading the prototype of the collection and using either an empty array or object.  Changes are then made by mutating the accumulator rather than returning a new value.  <code class=\"language-text\">_.reduce</code> will simply start with the first item in the list if nothing is provided. So we can do this:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\">
      <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">reverse</span> <span class=\"token operator\">=</span> arr <span class=\"token operator\">=></span> _<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>newArr<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> newArr<span class=\"token punctuation\">.</span><span class=\"token function\">unshift</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>
      </div>
<p><code class=\"language-text\">_.transform</code> can also be short-circuited by returning false from the function. So we could use it to cut off an array at the first odd number:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\">
      <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">cutOffAtOdd</span> <span class=\"token operator\">=</span> arr <span class=\"token operator\">=></span> _<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>newArr<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>val <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>
  <span class=\"token punctuation\">}</span>
  newArr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>
      </div>
<p><code class=\"language-text\">_.transform</code> is more limited to reduce as the returned collection has to be the same type as the original collection.  You can’t replicate the <code class=\"language-text\">max</code> or <code class=\"language-text\">sum</code> functions from the beginning of this article with it for instance, since you can’t mutate an array down to a number.</p>
<h3>_.keyBy and _.countsBy</h3>
<p>One of the primary use cases for <code class=\"language-text\">_reduce</code> is taking a collection and building an object from it.  lodash provides 2 methods that handle specialized versions of this use case.</p>
<p>[mergeclone]</p>
<div class=\"footnotes\">
<hr>
<ol>
<li id=\"fn-1\">
<p>If that sentence was confusing, feel free to check out this <a href=\"http://benmccormick.org/2015/09/14/es5-es6-es2016-es-next-whats-going-on-with-javascript-versioning/\">quick primer</a> on ECMAScript/JS terminology.</p>
<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>
</li>
</ol>
</div>",
                    "author": {
                      "@type": "Person",
                      "name": "Ben McCormick"
                      "email": "mailto:ben@benmccormick.org",
                      "image": "/profile_pic.jpg",
                      "jobTitle": "Software Engineer",
                      "alumniOf": "Duke",
                      "birthPlace": "Pittsburgh, PA",
                      "gender": "male",
                      "url": "http://benmccormick.org",
                	    "sameAs" : [
                        "https://www.linkedin.com/in/benmccormick",
                        "http://twitter.com/ben336",
                      ]
                   }
                }</script><link as="script" rel="preload" href="/component---src-templates-blog-post-js-e2301579c57adf12adb8.js"/><link as="script" rel="preload" href="/app-2c200c44da36b1866c0c.js"/><link as="script" rel="preload" href="/3-8c41f1f1f59c64c849f0.js"/><link as="script" rel="preload" href="/1-e4d06a6dd68c66d49449.js"/><link as="script" rel="preload" href="/2-fd0cb3257c78159b6c0c.js"/><link as="script" rel="preload" href="/0-9ae580c4c687a6d807a5.js"/><link as="script" rel="preload" href="/webpack-runtime-2b98b71ae61a0c21de2c.js"/><link as="fetch" rel="preload" href="/static/d/840/path---posts-drafts-old-drafts-lodash-lodash-reduce-e-09-270-bYXYy3CMHMU35XDdIPlHNcpcPFg.json" crossOrigin="use-credentials"/></head><body class="landing-page" style="background:#FCFCFC"><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><style data-emotion-css="msngs2">.css-msngs2{width:100%;max-width:960px;margin:0 auto;padding:2.4rem 1.2rem;}</style><div class="css-msngs2 em100y90"><style data-emotion-css="13vv67v">.css-13vv67v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding-bottom:2rem;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}</style><div class="css-13vv67v e1b8f8ar0"><style data-emotion-css="txnzm6">.css-txnzm6{margin:0 20px 0 0;padding-bottom:0;}.css-txnzm6 a{box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;}.css-txnzm6 a:hover{-webkit-text-decoration:none;text-decoration:none;}</style><h3 class="css-txnzm6 e1b8f8ar2"><a name="title" href="/">Ben McCormick</a></h3><style data-emotion-css="177tisd">.css-177tisd{color:#999999;}</style><div class="css-177tisd e1b8f8ar3"><a class="css-tcc0st" href="/archive/">Blog</a><style data-emotion-css="12jh0su">.css-12jh0su{padding:0 0.5rem;}@media all and (max-width:400px){.css-12jh0su{padding:0 0.25rem;}}</style><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="/subscribe/">Subscribe</a><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="/speaking/">Speaking</a><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="http://twitter.com/ben336">Twitter</a><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="/about/">About</a></div></div><article class="markdown"><div class="post-title-area"><style data-emotion-css="92repi">.css-92repi{display:block;max-width:100%;}</style><h1 class="css-92repi e15djruj1"></h1></div><div class="columns"><style data-emotion-css="qsg3oo">.css-qsg3oo{max-width:100%;}.css-qsg3oo li{padding-left:10px;}.css-qsg3oo .reading-img img{width:150px;float:right;margin:0px 10px 20px 10px;}.css-qsg3oo img.full-width{max-height:none;}.css-qsg3oo img.half-width{max-height:none;width:50%;}</style><div class="css-qsg3oo e15djruj3"><h1>Diving into lodash: Reducing collections</h1>
<p>7 years ago, TC39, the group responsible for authoring the ECMAScript standard produced ES5, the 4th major version of the JavaScript language<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>.  One of the hallmark features of that release was a set of functional methods for working with arrays: <code class="language-text">forEach</code>, <code class="language-text">map</code>, <code class="language-text">filter</code> and <code class="language-text">reduce</code>.  The first 3 seem to be fairly well understood and widely used by many JavaScript developers, but <code class="language-text">reduce</code> has remained more obscure.  </p>
<p>The purpose of <code class="language-text">reduce</code> is to provide a simple functional way to reduce a list of values into a single value.  This can be done for simple mathematical operations like summing or maxing, to build complex objects out of a list of keys, or to transform a dataset into a different form.</p>
<p><code class="language-text">reduce</code> takes 2 arguments, a reducer function and an optional initial value (also called an accumulator) and returns an aggregate value.  For each item in an array the reducer function receives the current value of the aggregate, the next value in the array, the index of the value, and a reference to the whole collection.  In practice, using it can look like this:</p>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">//generate a list of random numbers between 0 and 99</span>
<span class="token keyword">let</span> nums <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//get the maximum value</span>
<span class="token keyword">let</span> max <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>max<span class="token punctuation">,</span> num<span class="token punctuation">)</span> <span class="token operator">=></span> num <span class="token operator">></span> max <span class="token operator">?</span> num <span class="token punctuation">:</span> max<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment">// get the sum of all of the numbers</span>
<span class="token keyword">let</span> sum <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> num<span class="token punctuation">)</span> <span class="token operator">=></span> num <span class="token operator">+</span> total<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment">// Get the counts of the occurence of each number between 0 and 99 in nums</span>
<span class="token keyword">let</span> frequencies <span class="token operator">=</span>_<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
frequencies <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> num<span class="token punctuation">)</span> <span class="token operator">=></span> arr<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">,</span> frequencies<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<p>lodash provides its own version of the native <code class="language-text">reduce</code>.  <code class="language-text">_.reduce</code> works similarly to the native function, but takes the collection as its first object and like other lodash functions will accept any array-like object and iterate it like an array, or normal objects, with which it will iterate over key value pairs. <code class="language-text">_.reduce</code> also has special compatibility with many lodash functions that take multiple arguments, and makes sure to pass them only the first 2 arguments to avoid the index and collection arguments contaminating the function.  This allows code like this more complex version of the example from <a href="">my article on merging objects in lodash</a> :</p>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> contacts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    firstName<span class="token punctuation">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span>
    lastName<span class="token punctuation">:</span> <span class="token string">'Smith'</span><span class="token punctuation">,</span>
    phone<span class="token punctuation">:</span> <span class="token string">'919.222.7855'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    firstName<span class="token punctuation">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span>
    phone<span class="token punctuation">:</span> <span class="token string">'919.965.9999'</span><span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> <span class="token string">'john.smith@gmail.com'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    firstName<span class="token punctuation">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span>
    lastName<span class="token punctuation">:</span> <span class="token string">'Smith'</span><span class="token punctuation">,</span>
    twitter<span class="token punctuation">:</span> <span class="token string">'@johnsmith232'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

_<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>contacts<span class="token punctuation">,</span> _<span class="token punctuation">.</span>assign<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {firstName: "John", lastName: "Smith", phone: "919.965.9999", email: "john.smith@gmail.com", twitter: "@johnsmith232"}</span></code></pre>
      </div>
<p>We can also use <code class="language-text">_.reduce</code> to recreate other lodash methods like <code class="language-text">_.map</code> or <code class="language-text">_.reverse</code>.  Here’s an implementation of <code class="language-text">_.reverse</code>:</p>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">reverse</span> <span class="token operator">=</span> <span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token operator">=></span> _<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token punctuation">(</span>newArr<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    newArr<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> newArr<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<p>The above code works fine, but it is extremely inefficient for large arrays.  </p>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token function">reverse</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0.09 seconds</span>
<span class="token function">reverse</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 2.84 seconds</span>
<span class="token function">reverse</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// over 6 minutes</span></code></pre>
      </div>
<p>The problem is that we’re shifting all of the values in the array everytime we insert a new value.  It would be great if we could just add values to the end instead, but we’re getting them in the wrong order.  Fortunately, lodash provides <code class="language-text">_.reduceRight</code>. <code class="language-text">_.reduceRight</code> works the same way as <code class="language-text">_.reduce</code>, but starts from the end of the collection rather than the beginning.  That allows us to create a more efficient <code class="language-text">reverse</code>:</p>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">betterReverse</span> <span class="token operator">=</span> <span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token operator">=></span> _<span class="token punctuation">.</span><span class="token function">reduceRight</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token punctuation">(</span>newArr<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    newArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> newArr<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">betterReverse</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0.11 seconds</span></code></pre>
      </div>
<h3>_.transform</h3>
<p><code class="language-text">_.transform</code> is a variation on reduce with some different behavior.  If you don’t pass a specific initial value, <code class="language-text">_.transform</code> will try to do the right thing by reading the prototype of the collection and using either an empty array or object.  Changes are then made by mutating the accumulator rather than returning a new value.  <code class="language-text">_.reduce</code> will simply start with the first item in the list if nothing is provided. So we can do this:</p>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">reverse</span> <span class="token operator">=</span> arr <span class="token operator">=></span> _<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token punctuation">(</span>newArr<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">=></span> newArr<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<p><code class="language-text">_.transform</code> can also be short-circuited by returning false from the function. So we could use it to cut off an array at the first odd number:</p>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">cutOffAtOdd</span> <span class="token operator">=</span> arr <span class="token operator">=></span> _<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token punctuation">(</span>newArr<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  newArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<p><code class="language-text">_.transform</code> is more limited to reduce as the returned collection has to be the same type as the original collection.  You can’t replicate the <code class="language-text">max</code> or <code class="language-text">sum</code> functions from the beginning of this article with it for instance, since you can’t mutate an array down to a number.</p>
<h3>_.keyBy and _.countsBy</h3>
<p>One of the primary use cases for <code class="language-text">_reduce</code> is taking a collection and building an object from it.  lodash provides 2 methods that handle specialized versions of this use case.</p>
<p>[mergeclone]</p>
<div class="footnotes">
<hr>
<ol>
<li id="fn-1">
<p>If that sentence was confusing, feel free to check out this <a href="http://benmccormick.org/2015/09/14/es5-es6-es2016-es-next-whats-going-on-with-javascript-versioning/">quick primer</a> on ECMAScript/JS terminology.</p>
<a href="#fnref-1" class="footnote-backref">↩</a>
</li>
</ol>
</div></div><style data-emotion-css="rd3zyi">.css-rd3zyi{padding-left:2rem;overflow:hidden;}</style><div class="no-mobile css-rd3zyi e15djruj4"><style data-emotion-css="1y23a7j">.css-1y23a7j{overflow:hidden;margin:0;}.css-1y23a7j #mc_embed_signup form{margin-bottom:20px;}@media all and (max-width:700px){.css-1y23a7j{padding-right:0;width:100% !important;padding:0 10px;}.css-1y23a7j .mc-field-group{width:100% !important;}.css-1y23a7j .mc-field-group input{width:100% !important;font-size:0.8em;height:2.4em;}}</style><div class="css-1y23a7j e1qbom70"><form action="https://buttondown.email/api/emails/embed-subscribe/benmccormick" method="post" target="popupwindow" class="embeddable-buttondown-form"><label for="bd-email" id="bd-label">Subscribe to the Newsletter</label><input type="hidden" value="1" name="embed"/><div class="bd-subscribe-row"><input type="email" name="email" id="bd-email" placeholder="Your Email"/><input type="submit" value="Subscribe" id="bd-submit"/></div></form></div><style data-emotion-css="wtijjp">.css-wtijjp{width:100%;overflow:hidden;margin:0 0 1rem 0;font-size:14px;position:relative;font-family:"mr-eaves-xl-modern","Helvetica Neue",Arial,sans-serif;background:rgba(99,159,110,0.25);border:1px solid rgba(90,150,100,0.5);padding:4px;min-height:100px;opacity:0;-webkit-transition:opacity ease 3s;transition:opacity ease 3s;}@media all and (max-width:700px){.css-wtijjp{display:none;}}</style><div class="css-wtijjp etmlefq0"></div><style data-emotion-css="1ui09x8">.css-1ui09x8{font-size:14px;background-color:RGBA(191,237,253,0.5);border:1px solid #68d4fa;padding:0.5rem;}.css-1ui09x8 > h4{font-size:20px;margin-bottom:6px;}.css-1ui09x8 > h6{font-size:18px;margin-bottom:6px;margin-top:12px;}</style><div class="css-1ui09x8 e15djruj2"><h4>Article Info</h4><h6>Author</h6><a href="/about">Ben McCormick</a></div></div></div></article></div><style data-emotion-css="1tfasoy">.css-1tfasoy{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:3em 0 1em 0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:RGBA(191,237,253,0.5);border-top:1px solid #68d4fa;}</style><div class="css-1tfasoy e7oz9l30"><style data-emotion-css="7bdmpt">.css-7bdmpt{width:100%;min-height:200px;max-width:960px;margin:0 auto;padding:0 1.2rem;display:grid;grid-template-columns:45% 45%;grid-column-gap:10%;grid-row-gap:30px;}@media all and (max-width:450px){.css-7bdmpt{grid-template-columns:100%;}}</style><div class="css-7bdmpt e7oz9l31"><div><h2 class="css-0 e7oz9l33">Content</h2><style data-emotion-css="1xfqzqa">.css-1xfqzqa{display:grid;grid-template-columns:1fr;grid-auto-rows:1fr;grid-row-gap:20px;}</style><div class="css-1xfqzqa e7oz9l32"><a class="css-1gs5qio" href="/archive/">Blog Archive</a><a class="css-1gs5qio" href="/reviews-archive/">Book Reviews</a><a class="css-1gs5qio" href="https://buttondown.email/benmccormick">Newsletter Archives</a><a class="css-1gs5qio" href="/speaking/">Speaking</a></div></div><div><h2 class="css-0 e7oz9l33">Meta</h2><div class="css-1xfqzqa e7oz9l32"><a class="css-1gs5qio" href="/subscribe/">Subscribe To The Newsletter</a><a class="css-1gs5qio" href="/built-with/">Built With</a><a class="css-1gs5qio" href="http://twitter.com/ben336">Personal Twitter</a><a class="css-1gs5qio" href="http://twitter.com/benmccormickorg">Blog Twitter</a><a class="css-1gs5qio" href="/about/">About Me</a></div></div><style data-emotion-css="i3iawv">.css-i3iawv{font-family:"mr-eaves-xl-modern","Helvetica Neue",Arial,sans-serif;font-size:14px;overflow:visible;white-space:nowrap;}</style><div class="css-i3iawv e7oz9l34">Copyright © 2012-2019 · Ben McCormick</div></div></div></div></div><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-37323973-1', 'auto');
            ga('send', 'pageview');
        </script><script>
          (function(d) {
            var config = {
              kitId: 'msd6bqv',
              scriptTimeout: 300,
              async: true
            },
            h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/wf-loading/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
          })(document);
        </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"posts-drafts-old-drafts-lodash-lodash-reduce-e09","path":"/posts/drafts/old-drafts/lodash/lodash_reduce/"};window.dataPath="840/path---posts-drafts-old-drafts-lodash-lodash-reduce-e-09-270-bYXYy3CMHMU35XDdIPlHNcpcPFg";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-2c200c44da36b1866c0c.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-6c3cb25c69a33194b725.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js.d5c164db07d2a4f14ec9.css","/component---src-templates-blog-post-js-e2301579c57adf12adb8.js"],"component---src-templates-category-page-js":["/component---src-templates-category-page-js-bbe4cfbd87046e3a284b.js"],"component---src-templates-topic-page-js":["/component---src-templates-topic-page-js-54d7a930249c9bead6dc.js"],"component---src-pages-archive-js":["/component---src-pages-archive-js-b233b14132501dcc18da.js"],"component---src-pages-index-js":["/component---src-pages-index-js-b1b790160efb6e7b754f.js"],"component---src-pages-links-archive-js":["/component---src-pages-links-archive-js-8404a10ddcf65ffbf936.js"],"component---src-pages-reviews-archive-js":["/component---src-pages-reviews-archive-js-5b7cfc3e3751ab86a145.js"]};/*]]>*/</script><script src="/webpack-runtime-2b98b71ae61a0c21de2c.js" async=""></script><script src="/0-9ae580c4c687a6d807a5.js" async=""></script><script src="/2-fd0cb3257c78159b6c0c.js" async=""></script><script src="/1-e4d06a6dd68c66d49449.js" async=""></script><script src="/3-8c41f1f1f59c64c849f0.js" async=""></script><script src="/app-2c200c44da36b1866c0c.js" async=""></script><script src="/component---src-templates-blog-post-js-e2301579c57adf12adb8.js" async=""></script></body></html>