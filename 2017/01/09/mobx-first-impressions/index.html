<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=yyxgnp97qG"/><link rel="icon" type="image/png" href="/favicon-32x32.png?v=yyxgnp97qG" sizes="32x32"/><link rel="icon" type="image/png" href="/favicon-16x16.png?v=yyxgnp97qG" sizes="16x16"/><link rel="manifest" href="/manifest.json"/><link rel="mask-icon" href="/safari-pinned-tab.svg?v=yyxgnp97qG" color="#57a3e8"/><link rel="alternate" title="JSON Feed" type="application/json" href="/feed.json"/><link rel="shortcut icon" href="/favicon.ico?v=yyxgnp97qG"/><meta name="theme-color" content="#ffffff"/><script type="text/javascript" src="//use.typekit.net/msd6bqv.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script><title data-react-helmet="true">MobX: First Impressions | benmccormick.org</title><meta data-react-helmet="true" name="description" content="First impression of managing data with MobX"/><meta data-react-helmet="true" name="keywords" content="mobx JavaScript data React"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:site" content="@benmccormickorg"/><meta data-react-helmet="true" name="twitter:creator" content="@ben336"/><meta data-react-helmet="true" name="twitter:title" content="MobX: First Impressions"/><meta data-react-helmet="true" name="twitter:description" content="First impression of managing data with MobX"/><meta data-react-helmet="true" name="twitter:image" content="http://benmccormick.org/logo.png"/><script data-react-helmet="true" type="application/ld+json">{
                "@context": "http://schema.org"
                "@type": "BlogPosting",
                "headline": "MobX: First Impressions",
                "genre": "Software Development",
                "keywords": "mobx JavaScript data React",
                "url": "http://benmccormick.org/2017/01/09/mobx-first-impressions/",
                "image": "http://benmccormick.org/logo.png",
                "datePublished": "2017-01-9",
                "description": "First impression of managing data with MobX",
                "articleBody": "<p>I spent some time around the holidays this year playing with <a href=\"https://mobx.js.org/\">MobX</a>, a state management library for JavaScript.  MobX is an unopinionated library that provides a layer over normal JavaScript data structures that allow other code to efficiently observe data changes and update based on what has changed.  It’s an interesting tool for handling state in web applications, especially in existing projects that might need to update state handling iteratively.  Here are some first impressions.</p>
<h3>What is MobX?</h3>
<p>MobX has 3 core concepts developers need to understand:</p>
<ol>
<li><strong>Observable state</strong> - MobX provides functions to make data <em>observable</em>.  Observable data can be watched by other pieces of code which may efficiently update when the state changes.  Observable data is primarily created in MobX using the <code>observable</code> function.</li>
<li><strong>Derivations</strong> - Functions that <em>watch</em> observable data are called derivations.  MobX has 2 primary types of derivations: <em>computed values</em> and <em>reactions</em>.  Computed values update a value based on other data, while reactions produce side effects: updates to a UI, a network call, or a logging statement for example. MobX provides a <code>computed</code> function for defining computed values; in most cases reactions will likely be mostly defined using a framework specific helper library like <a href=\"https://github.com/mobxjs/mobx-react\">mobx-react</a> or <a href=\"https://github.com/500tech/ng2-mobx\">ng2-mobx</a>.  MobX does provide some lower level libraries for reactions though, including <code>autorun</code> and <code>when</code>.</li>
<li><strong>Actions</strong> - Code that updates observable state is known as an action.  MobX has a formalized version of actions which can be defined using the <code>action</code> function, but it is also possible to modify state directly using any normal JavaScript code and maintain observable behavior.</li>
</ol>
<p>In practice this looks something like this:</p>
<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">import</span> React <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'react'</span>;
<span class=\"hljs-keyword\">import</span> ReactDOM <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'react-dom'</span>;
<span class=\"hljs-keyword\">import</span> {observable} <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'mobx'</span>;
<span class=\"hljs-keyword\">import</span> {observer} <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'mobx-react'</span>;

<span class=\"hljs-keyword\">let</span> digits = observable([<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>]);

<span class=\"hljs-keyword\">const</span> DigitPrinter = observer(<span class=\"hljs-function\">(<span class=\"hljs-params\">{digits}</span>) =&gt;</span> {
  <span class=\"hljs-keyword\">return</span> (<span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>
    {digits.join(', ')}
  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span>);
});

ReactDOM.render( <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">DigitPrinter</span> <span class=\"hljs-attr\">digits</span> = <span class=\"hljs-string\">{digits}</span> /&gt;</span>, document.getElementById('root'));

/* prints 1, 2 */


digits.push(3);

/* DOM re-renders to print 1, 2, 3 */

digits[2] = 4;

/* DOM re-renders to print 1, 2, 4 */

</span></code></pre>
<p>The component is able to passively <em>observe</em> changes in the data, and re-render when it changes.  But MobX is actually even smarter than this example shows.  Let’s look at another example, this time using a more complex data structure (a class).</p>
<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">import</span> React <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'react'</span>;
<span class=\"hljs-keyword\">import</span> ReactDOM <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'react-dom'</span>;
<span class=\"hljs-keyword\">import</span> {extendObservable} <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'mobx'</span>;
<span class=\"hljs-keyword\">import</span> {observer} <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'mobx-react'</span>;
<span class=\"hljs-keyword\">import</span> moment <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'moment'</span>;

<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Appointment</span> </span>{

  <span class=\"hljs-keyword\">constructor</span>() {
    extendObservable(<span class=\"hljs-keyword\">this</span>, {
      <span class=\"hljs-attr\">dueDate</span>: <span class=\"hljs-string\">'01-01-2017'</span>,
      <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">'Dinner with Joe'</span>
      location: <span class=\"hljs-string\">'Chik-Fil-A'</span>,
      <span class=\"hljs-attr\">isToday</span>: computed(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{
        <span class=\"hljs-keyword\">return</span> moment(dueDate, <span class=\"hljs-string\">'MM-DD-YYYY'</span>).diff(moment.now(), <span class=\"hljs-string\">'days'</span>) === <span class=\"hljs-number\">0</span>;
      }),
    });
  }

  toString() {
    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">`<span class=\"hljs-subst\">${<span class=\"hljs-keyword\">this</span>.title}</span> @ <span class=\"hljs-subst\">${<span class=\"hljs-keyword\">this</span>.location}</span>`</span>;
  }
}


<span class=\"hljs-keyword\">const</span> TodayBox = observer(<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">TodayBox</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">React</span>.<span class=\"hljs-title\">Component</span> </span>{
  render () {
    <span class=\"hljs-keyword\">let</span> {appointments} = <span class=\"hljs-keyword\">this</span>.props;
    <span class=\"hljs-keyword\">return</span> (<span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>
      {appointments.filter(a =&gt; a.isToday).map(a =&gt; <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>a.toString()<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>)}     
    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span>);
  }
});

<span class=\"hljs-keyword\">let</span> appointment = <span class=\"hljs-keyword\">new</span> Appointment();

ReactDOM.render( <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">TodayBox</span> <span class=\"hljs-attr\">appointments</span> = <span class=\"hljs-string\">{[appointment]}</span> /&gt;</span>, document.getElementById('root'));

/* prints an empty div */

appointment.title = 'Dinner with Bob';

/* Nothing relevant has changed. The component does not re-render */

appointment.dueDate = '01-09-2017';  

/*  assume that 01-09-2017 is \"today\" */
</span></code></pre>
<p>MobX has the “magical” ability to determine what changes actually affect the observer and not make unnecessary calls of reaction functions.  In practice, that magic allows you to write less, more efficient code for updating your UI based on data.</p>
<h3>How Does MobX work?</h3>
<p>I have a learned skepticism of magical solutions like this.  Generally I find that time-saving magic like this ends up costing time when it comes to maintenance, and explicit relationships between code saves time over less-boilerplate heavy code. Fortunately, while the libraries code itself is fairly complex, it isn’t too hard to understand the logic behind how MobX works.</p>
<p>On the Observer side, MobX uses <a href=\"http://benmccormick.org/2015/09/14/es5-es6-es2016-es-next-whats-going-on-with-javascript-versioning/\">ES5</a> setters and getters to proxy updates to observable data structure and listen in when data is updated.  This allows the type of event listening that <a href=\"http://backbonejs.org/\">Backbone</a> and other libraries provide, without requiring the user to go through special <code>set</code> or <code>get</code> methods to update an object’s properties.  Most of the time you should be able to just be able to write code as you normally would, and MobX will make it work.  There are some exceptions though that mean its important to actually understand how the library work.  Getters and Setters only work when looking up an existing property on an object, so when using primitive values or adding new values to an existing object, some special syntax (the return of <code>get</code> and <code>set</code> methods) may be required.  In Mobx primitive observables are referred to as <em>boxed</em> values, and objects that require new values over time can be handled by using observable Maps, which use the API of <a href=\"http://benmccormick.org/2015/09/14/es5-es6-es2016-es-next-whats-going-on-with-javascript-versioning/\">ES6</a> Maps.</p>
<p>On the derivative side, reactions and computed values are always defined as functions.  MobX wraps these functions and is able to determine (through the method described above) what properties were accessed during each function run.  It then only listens for changes to these properties.  Thus it doesn’t matter if you theoretically could access thousands of observable properties in a function, if you wrap those references in an if statement to a single property, and that property returns false on first run, the derivative function will only listen for changes on that property before running again. When an observable is updated, all derivative code is run synchronously and atomically so there is no concern of getting into bad intermediate states.</p>
<p>Most of the “magic” is covered by the 2 paragraphs above, and once you understand the ideas behind them (see the resources at the bottom of this post for more in-depth explanations), it is fairly easy to understand the reasoning behind the cases where the magic fails.</p>
<h3>Decorators</h3>
<p>Developers who actually use MobX are probably questioning my examples by now, because I’ve been using a different syntax than the primary MobX documentation for showing my examples.  So let’s talk about decorators.  The preferred way (according to the documentation) to write MobX code is to use decorators to define observers and observables.  Decorators are a <a href=\"http://tc39.github.io/proposal-decorators/\">proposed new JavaScript feature</a> for declaratively adding extra behavior to classes, class properties and class methods.  Using them with MobX, my above example would look like this <sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup>:</p>
<pre><code class=\"language-javascript\">
<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Appointment</span> </span>{

  @observable dueDate = <span class=\"hljs-string\">'01-01-2017'</span>
  @observable title = <span class=\"hljs-string\">'Dinner with Joe'</span>
  @observable location = <span class=\"hljs-string\">'Chik-Fil-A'</span>

  @computed get isToday() {
    <span class=\"hljs-keyword\">return</span> moment(dueDate, <span class=\"hljs-string\">'MM-DD-YYYY'</span>).diff(moment.now(), <span class=\"hljs-string\">'days'</span>) === <span class=\"hljs-number\">0</span>;
  }

  toString() {
    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">`<span class=\"hljs-subst\">${<span class=\"hljs-keyword\">this</span>.title}</span> @ <span class=\"hljs-subst\">${<span class=\"hljs-keyword\">this</span>.location}</span>`</span>;
  }
}


@observer <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">TodayBox</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">React</span>.<span class=\"hljs-title\">Component</span> </span>{
  render () {
    <span class=\"hljs-keyword\">let</span> {appointments} = <span class=\"hljs-keyword\">this</span>.props;
    <span class=\"hljs-keyword\">return</span> (<span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>
      {appointments.filter(a =&gt; a.isToday).map(a =&gt; <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>a.toString()<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>)}     
    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span>);
  }
}
</code></pre>
<p>That obviously looks a lot cleaner than my example.  So what’s the problem?  Again, decorators are a <em>proposed</em> JavaScript feature.  Currently they’re in Stage 2, which means roughly that they are very likely to eventually make it into the language, but may change in non-trivial ways before that happens.  Currently decorators are implemented in <a href=\"https://www.typescriptlang.org/docs/handbook/decorators.html\">TypeScript</a>, as well as a <a href=\"https://github.com/loganfsmyth/babel-plugin-transform-decorators-legacy\">3rd party babel plugin</a>, but as of January 2017 <a href=\"http://kangax.github.io/compat-table/esnext/#test-class_decorators\">are not implemented in any browser engines</a>, and are not implemented in any first party babel plugins <a href=\"https://github.com/babel/babel/issues/2645\">due to spec instability</a>.  Decorators are a key part of Angular2, and are used by other frameworks including <a href=\"http://aurelia.io/\">Aurelia</a> and <a href=\"https://github.com/rwjblue/ember-computed-decorators\">Ember</a>, so I don’t think they’re going away.  But I also don’t see them as ready for production use for teams that don’t have the capacity to dedicate the time to update existing code if/when the spec changes<sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">[2]</a></sup>.  If for one reason or other you’re comfortable with the risks however, decorators are a great way to clean up the MobX API, and I’m excited for the spec to get to the point where I can use them.</p>
<h3>Comparison to Redux and setState</h3>
<p>As a state management library that was built to be used with React, the obvious questions to ask about MobX are how it improves over React’s built in state handling, and how it compares to <a href=\"http://redux.js.org/\">Redux</a>, the current most popular state management solution for React. MobX takes a different approach to each.</p>
<p>It’s important to say at the start that MobX isn’t mutually exclusive with using setState.  It’s possible to use them together, with MobX managing application data and setState handling individual component/UI state.  But there is some advantages to using MobX for UI state as well.  The biggest reason is that MobX is smarter than setState about when re-rendering is required.  By default React Components re-render on any call to setState, regardless of whether the state change actually affects what is rendered or not. MobX’s creator <a href=\"https://medium.com/@mweststrate/3-reasons-why-i-stopped-using-react-setstate-ab73fc67a42e#.x0o6y4rxv\">wrote more about this on Medium</a>.</p>
<p>Comparing MobX and Redux could be a whole article on its own, so I’m not going to go too deep here, but suffice it to say that MobX is more flexible than Redux, but as a result loses some of the benefits of Redux’s structured approach.  Specifically, it is easy to convert a single object to become a MobX observable and use it in an existing React component.  It can be easily inlined in an existing file and used for one component even.  You also don’t have to deal with the ceremony of using <a href=\"http://benmccormick.org/2016/06/04/what-are-mutable-and-immutable-data-structures-2/\">immutable data</a>.  Redux is intended as a solution that will take over all your state, and doesn’t scale down nearly as well or mix with other solutions <sup class=\"footnote-ref\"><a href=\"#fn3\" id=\"fnref3\">[3]</a></sup>.  However, Redux’s structure also has benefits.  It allows easy testings of each component of an app individually, the creation of powerful tooling that will work with any Redux app, and reliable guarantees of how state will be updated.  These things are mostly possible with MobX <sup class=\"footnote-ref\"><a href=\"#fn4\" id=\"fnref4\">[4]</a></sup>, but require more developer discipline, and/or can’t be written as easily as universal tools. Overgeneralizing, I would prefer Redux in a new application, but would look to MobX for improving data management in an existing application.  MobX also has advantages in applications where you’re displaying a large amount of UI elements based on a relatively small amount of data, or have a lot of derived data (something like a spreadsheet), whereas Redux has benefits for applications that need to be extremely reliable and well tested.</p>
<h3>Stray Thoughts</h3>
<ul>
<li>If you do want more discipline in MobX, make sure to use <code>useStrict</code> to require updates to use Actions</li>
<li>MobX has a nice set of <a href=\"https://github.com/mobxjs/mobx-react-devtools\">devtools</a> that are useful if you’re opting in to using actions, and using React with MobX.</li>
<li>If this isn’t clear yet, I definitely recommend hacking around with Mobx’s low level APIs to learn more about how it works before integrating it straight into a framework</li>
<li><s>Also note that MobX 3.0 is imminent, there is a release candidate that you can play with now.</s> <strong>Update:</strong> That didn’t take long.  <a href=\"https://medium.com/@mweststrate/mobx-3-released-unpeeling-the-onion-ca877382f443#.mk6mdypt2\">MobX 3.0 is out</a>.</li>
</ul>
<h3>More Resources</h3>
<ul>
<li>
<p>The two most helpful resources I found for conceptually understanding MobX were in-depth articles by the library’s author <a href=\"\">Michael Westrate</a>: <a href=\"https://medium.com/@mweststrate/becoming-fully-reactive-an-in-depth-explanation-of-mobservable-55995262a254#.jd4hgh2zi\">Becoming fully reactive: an in-depth explanation of MobX</a> on Medium and <a href=\"https://mobx.js.org/intro/concepts.html\">Concepts &amp; Principles</a> from the MobX documentation</p>
</li>
<li>
<p>This <a href=\"https://twitter.com/AdamRackis/status/775706291259908096\">tweet thread</a> and the linked article, are a good breakdown of the tradeoffs between MobX and Redux</p>
</li>
</ul>
<hr class=\"footnotes-sep\">
<section class=\"footnotes\">
<ol class=\"footnotes-list\">
<li id=\"fn1\" class=\"footnote-item\"><p>Technically this also uses class properties as well, another proposal that works well with decorators <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a></p>
</li>
<li id=\"fn2\" class=\"footnote-item\"><p>It’s possible any spec changes will be trivially fixable with a code mod script, but right now there is more uncertainty than I am personally comfortable with.  I’m grateful to people who are willing to take more risks here than me, they push the language forward. <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a></p>
</li>
<li id=\"fn3\" class=\"footnote-item\"><p>I’m talking here about what is encouraged and easy, not what is possible.  It is of course possible to mix in Redux with other solutions. <a href=\"#fnref3\" class=\"footnote-backref\">↩︎</a></p>
</li>
<li id=\"fn4\" class=\"footnote-item\"><p>MobX has some nice <a href=\"https://github.com/mobxjs/mobx-react-devtools\">devtools!</a> <a href=\"#fnref4\" class=\"footnote-backref\">↩︎</a></p>
</li>
</ol>
</section>
",
                  "author": {
                    "@type": "Person",
                    "name": "Ben McCormick"
                    "email": "mailto:ben@benmccormick.org",
                    "image": "/profile_pic.jpg",
                    "jobTitle": "Software Engineer",
                    "alumniOf": "Duke",
                    "birthPlace": "Pittsburgh, PA",
                    "gender": "male",
                    "url": "http://benmccormick.org",
              	    "sameAs" : [
                      "https://www.linkedin.com/in/benmccormick",
                      "http://twitter.com/ben336",
                    ]
                 }
              }</script><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.55em brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.5rem;line-height:2.325rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.27542rem;line-height:1.55rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.17608rem;line-height:1.55rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.55rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.92211rem;line-height:1.55rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;color:inherit;font-family:brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.88547rem;line-height:1.55rem;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}ul{margin-left:1.55rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.55rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;font-size:0.85rem;line-height:1.1;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.1625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;font-size:1rem;line-height:1.55rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}blockquote{margin-left:1.55rem;margin-right:1.55rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.1625rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.1625rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.1625rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.55rem;margin-bottom:calc(1.1625rem / 2);margin-top:calc(1.1625rem / 2);}li > ul{margin-left:1.55rem;margin-bottom:calc(1.1625rem / 2);margin-top:calc(1.1625rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.1625rem / 2);}code{font-size:0.85rem;line-height:1.55rem;}kbd{font-size:0.85rem;line-height:1.55rem;}samp{font-size:0.85rem;line-height:1.55rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:tnum;-moz-font-feature-settings:tnum;-ms-font-feature-settings:tnum;-webkit-font-feature-settings:tnum;padding-left:1.03333rem;padding-right:1.03333rem;padding-top:0.775rem;padding-bottom:calc(0.775rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;font-size:75%;}pre code{background:none;line-height:1.1;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}h1,h2,h3,h4,h5,h6{line-height:1.1;}@media only screen and (max-width:480px){html{font-size:112.5%;}}</style><style>.header-link{color:hsla(0,0%,39%,.7)}.header-link:hover{color:#e2777a}#carbonads{height:100px;font-size:14px;width:300px;position:relative;background:#f0f0f0}.carbon-wrap{height:100px;display:-ms-flexbox;display:flex}.carbon-text{padding:5px 10px;max-height:80px;display:inline-block;overflow:hidden;line-height:1.3}.carbon-poweredby{color:hsla(0,0%,39%,.7);position:absolute;right:5px;bottom:0}@media (max-width:600px){#carbonads,.no-mobile{display:none}.subscribe-block{padding-right:0;padding:0 10px}.subscribe-block,.subscribe-block .mc-field-group{width:100%!important}.subscribe-block .mc-field-group input{width:100%!important;font-size:.8em;height:2.4em}.up-next-block{width:100%!important;padding:0 10px}}@media (max-width:321px){html{font-size:100%!important}}.subscribe-container{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-wrap:wrap;flex-wrap:wrap}.subscribe-block{width:400px;padding-right:30px;overflow:hidden}.subscribe-block #mc_embed_signup form{margin-bottom:20px}.up-next-block{width:300px}.subscribe-button{color:#fff;background:#57a3e8;border-radius:4px;border:0;padding:5px 10px;margin:20px 0;cursor:pointer}.rss{padding-bottom:10px}.rss a{display:-ms-flexbox;display:flex}.rss-icon{display:block;width:17px;margin-right:.5em;height:50px}.rss-icon *{fill:#e2777a}.twitter-item{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-bottom:15px}.twitter-item iframe{margin:0 0 0 10px}.hljs,.markdown pre{display:block;background:#fdf6e3;color:#657b83}.hljs{overflow-x:auto;padding:.5em}.hljs-comment,.hljs-quote{color:#93a1a1}.hljs-addition,.hljs-keyword,.hljs-selector-tag{color:#859900}.hljs-doctag,.hljs-literal,.hljs-meta .hljs-meta-string,.hljs-number,.hljs-regexp,.hljs-string{color:#2aa198}.hljs-name,.hljs-section,.hljs-selector-class,.hljs-selector-id,.hljs-title{color:#268bd2}.hljs-attr,.hljs-attribute,.hljs-class .hljs-title,.hljs-template-variable,.hljs-type,.hljs-variable{color:#b58900}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-meta .hljs-keyword,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-subst,.hljs-symbol{color:#cb4b16}.hljs-built_in,.hljs-deletion{color:#dc322f}.hljs-formula{background:#eee8d5}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}a{color:#e2777a;text-decoration:none}blockquote{border-left:5px solid #57a3e8;font-style:italic;background:#eee;font-weight:400;font-size:.9rem;padding:10px 20px;margin:0 0 30px -25px}blockquote p{margin-bottom:.667em}h2,h3{color:#57a3e8}.explanation{padding:10px;background:#eee;border-radius:10px;margin:20px auto;font-size:.85em}.footnote p{display:inline-block;margin-bottom:0}.article-body .reading-img img{width:150px;float:right;margin:0 10px 20px}.article-body img{max-height:200px;display:block;margin:40px auto 20px}.article-body img.full-width{max-height:none}.article-body img.half-width{max-height:none;width:50%}.bordered-img{border:3px solid #57a3e8}.img-group{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}.img-group img{padding:0;height:auto}twitterwidget{margin-left:auto;margin-right:auto}.mc-field-group{width:400px;display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-align:center;align-items:center;padding:8px 0}.mc-field-group input{border-radius:3px;max-width:350px;width:80vw;border:1px solid #ccc;margin-right:10px;height:30px}.mc-field-group label{font-size:.9em;font-weight:600}#mc-embedded-subscribe{color:#fff;background:#57a3e8;border-radius:4px;border:0;padding:0 10px;margin:10px 0;cursor:pointer;width:40vw}#mc-embedded-subscribe:hover{background:#3e8acf}.twitter-row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.twitter-row>div{padding-right:20px;min-width:300px}.category-icon-wrapper{color:rgba(87,163,232,.5)}.category-icon{display:inline-block;width:.75em;margin-right:.5em}.category-icon *{fill:#57a3e8;fill:rgba(87,163,232,.5)}.category-icon>i{height:30px}</style></head><body class="landing-page" style="background:#FCFCFC;padding:0 10px;"><div id="react-mount"><div style="max-width:40.3rem;margin-left:auto;margin-right:auto;padding:2.325rem 1.1625rem;" data-reactroot="" data-reactid="1" data-react-checksum="-1202969652"><div style="display:flex;padding-bottom:0.5rem;margin-bottom:0.5rem;" data-reactid="2"><div style="flex-grow:3;display:flex;flex-direction:column;justify-content:space-around;" data-reactid="3"><h3 style="margin:0;padding-bottom:0;" data-reactid="4"><a style="box-shadow:none;text-decoration:none;color:inherit;" name="title" href="/" data-reactid="5">benmccormick.org</a></h3><div style="color:rgba(100,100,100, 0.7);" data-reactid="6"><a class="header-link" href="/subscribe/" data-reactid="7">Subscribe</a><span style="padding:0 0.33rem;" data-reactid="8">•</span><a class="header-link" href="/archive/" data-reactid="9">Archive</a><span style="padding:0 0.33rem;" data-reactid="10">•</span><a class="header-link" href="http://twitter.com/ben336" data-reactid="11">Twitter</a><span style="padding:0 0.33rem;" data-reactid="12">•</span><a class="header-link" href="/about/" data-reactid="13">About</a></div></div><div style="flex-shrink:2;" data-reactid="14"><span data-reactid="15"></span></div></div><div class="markdown" data-reactid="16"><!-- react-empty: 17 --><h5 style="display:block;color:rgba(100,100,100, 0.7);margin-bottom:0.3875rem;" data-reactid="18">January 9, 2017</h5><h1 style="margin-top:0;margin-bottom:1rem;" data-reactid="19">MobX: First Impressions</h1><div class="article-body" data-reactid="20"><p>I spent some time around the holidays this year playing with <a href="https://mobx.js.org/">MobX</a>, a state management library for JavaScript.  MobX is an unopinionated library that provides a layer over normal JavaScript data structures that allow other code to efficiently observe data changes and update based on what has changed.  It’s an interesting tool for handling state in web applications, especially in existing projects that might need to update state handling iteratively.  Here are some first impressions.</p>
<h3>What is MobX?</h3>
<p>MobX has 3 core concepts developers need to understand:</p>
<ol>
<li><strong>Observable state</strong> - MobX provides functions to make data <em>observable</em>.  Observable data can be watched by other pieces of code which may efficiently update when the state changes.  Observable data is primarily created in MobX using the <code>observable</code> function.</li>
<li><strong>Derivations</strong> - Functions that <em>watch</em> observable data are called derivations.  MobX has 2 primary types of derivations: <em>computed values</em> and <em>reactions</em>.  Computed values update a value based on other data, while reactions produce side effects: updates to a UI, a network call, or a logging statement for example. MobX provides a <code>computed</code> function for defining computed values; in most cases reactions will likely be mostly defined using a framework specific helper library like <a href="https://github.com/mobxjs/mobx-react">mobx-react</a> or <a href="https://github.com/500tech/ng2-mobx">ng2-mobx</a>.  MobX does provide some lower level libraries for reactions though, including <code>autorun</code> and <code>when</code>.</li>
<li><strong>Actions</strong> - Code that updates observable state is known as an action.  MobX has a formalized version of actions which can be defined using the <code>action</code> function, but it is also possible to modify state directly using any normal JavaScript code and maintain observable behavior.</li>
</ol>
<p>In practice this looks something like this:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;
<span class="hljs-keyword">import</span> {observable} <span class="hljs-keyword">from</span> <span class="hljs-string">'mobx'</span>;
<span class="hljs-keyword">import</span> {observer} <span class="hljs-keyword">from</span> <span class="hljs-string">'mobx-react'</span>;

<span class="hljs-keyword">let</span> digits = observable([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]);

<span class="hljs-keyword">const</span> DigitPrinter = observer(<span class="hljs-function">(<span class="hljs-params">{digits}</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> (<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    {digits.join(', ')}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>);
});

ReactDOM.render( <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DigitPrinter</span> <span class="hljs-attr">digits</span> = <span class="hljs-string">{digits}</span> /&gt;</span>, document.getElementById('root'));

/* prints 1, 2 */


digits.push(3);

/* DOM re-renders to print 1, 2, 3 */

digits[2] = 4;

/* DOM re-renders to print 1, 2, 4 */

</span></code></pre>
<p>The component is able to passively <em>observe</em> changes in the data, and re-render when it changes.  But MobX is actually even smarter than this example shows.  Let’s look at another example, this time using a more complex data structure (a class).</p>
<pre><code class="language-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;
<span class="hljs-keyword">import</span> {extendObservable} <span class="hljs-keyword">from</span> <span class="hljs-string">'mobx'</span>;
<span class="hljs-keyword">import</span> {observer} <span class="hljs-keyword">from</span> <span class="hljs-string">'mobx-react'</span>;
<span class="hljs-keyword">import</span> moment <span class="hljs-keyword">from</span> <span class="hljs-string">'moment'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Appointment</span> </span>{

  <span class="hljs-keyword">constructor</span>() {
    extendObservable(<span class="hljs-keyword">this</span>, {
      <span class="hljs-attr">dueDate</span>: <span class="hljs-string">'01-01-2017'</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">'Dinner with Joe'</span>
      location: <span class="hljs-string">'Chik-Fil-A'</span>,
      <span class="hljs-attr">isToday</span>: computed(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> moment(dueDate, <span class="hljs-string">'MM-DD-YYYY'</span>).diff(moment.now(), <span class="hljs-string">'days'</span>) === <span class="hljs-number">0</span>;
      }),
    });
  }

  toString() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.title}</span> @ <span class="hljs-subst">${<span class="hljs-keyword">this</span>.location}</span>`</span>;
  }
}


<span class="hljs-keyword">const</span> TodayBox = observer(<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TodayBox</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  render () {
    <span class="hljs-keyword">let</span> {appointments} = <span class="hljs-keyword">this</span>.props;
    <span class="hljs-keyword">return</span> (<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {appointments.filter(a =&gt; a.isToday).map(a =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>a.toString()<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>)}     
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>);
  }
});

<span class="hljs-keyword">let</span> appointment = <span class="hljs-keyword">new</span> Appointment();

ReactDOM.render( <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodayBox</span> <span class="hljs-attr">appointments</span> = <span class="hljs-string">{[appointment]}</span> /&gt;</span>, document.getElementById('root'));

/* prints an empty div */

appointment.title = 'Dinner with Bob';

/* Nothing relevant has changed. The component does not re-render */

appointment.dueDate = '01-09-2017';  

/*  assume that 01-09-2017 is "today" */
</span></code></pre>
<p>MobX has the “magical” ability to determine what changes actually affect the observer and not make unnecessary calls of reaction functions.  In practice, that magic allows you to write less, more efficient code for updating your UI based on data.</p>
<h3>How Does MobX work?</h3>
<p>I have a learned skepticism of magical solutions like this.  Generally I find that time-saving magic like this ends up costing time when it comes to maintenance, and explicit relationships between code saves time over less-boilerplate heavy code. Fortunately, while the libraries code itself is fairly complex, it isn’t too hard to understand the logic behind how MobX works.</p>
<p>On the Observer side, MobX uses <a href="http://benmccormick.org/2015/09/14/es5-es6-es2016-es-next-whats-going-on-with-javascript-versioning/">ES5</a> setters and getters to proxy updates to observable data structure and listen in when data is updated.  This allows the type of event listening that <a href="http://backbonejs.org/">Backbone</a> and other libraries provide, without requiring the user to go through special <code>set</code> or <code>get</code> methods to update an object’s properties.  Most of the time you should be able to just be able to write code as you normally would, and MobX will make it work.  There are some exceptions though that mean its important to actually understand how the library work.  Getters and Setters only work when looking up an existing property on an object, so when using primitive values or adding new values to an existing object, some special syntax (the return of <code>get</code> and <code>set</code> methods) may be required.  In Mobx primitive observables are referred to as <em>boxed</em> values, and objects that require new values over time can be handled by using observable Maps, which use the API of <a href="http://benmccormick.org/2015/09/14/es5-es6-es2016-es-next-whats-going-on-with-javascript-versioning/">ES6</a> Maps.</p>
<p>On the derivative side, reactions and computed values are always defined as functions.  MobX wraps these functions and is able to determine (through the method described above) what properties were accessed during each function run.  It then only listens for changes to these properties.  Thus it doesn’t matter if you theoretically could access thousands of observable properties in a function, if you wrap those references in an if statement to a single property, and that property returns false on first run, the derivative function will only listen for changes on that property before running again. When an observable is updated, all derivative code is run synchronously and atomically so there is no concern of getting into bad intermediate states.</p>
<p>Most of the “magic” is covered by the 2 paragraphs above, and once you understand the ideas behind them (see the resources at the bottom of this post for more in-depth explanations), it is fairly easy to understand the reasoning behind the cases where the magic fails.</p>
<h3>Decorators</h3>
<p>Developers who actually use MobX are probably questioning my examples by now, because I’ve been using a different syntax than the primary MobX documentation for showing my examples.  So let’s talk about decorators.  The preferred way (according to the documentation) to write MobX code is to use decorators to define observers and observables.  Decorators are a <a href="http://tc39.github.io/proposal-decorators/">proposed new JavaScript feature</a> for declaratively adding extra behavior to classes, class properties and class methods.  Using them with MobX, my above example would look like this <sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>:</p>
<pre><code class="language-javascript">
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Appointment</span> </span>{

  @observable dueDate = <span class="hljs-string">'01-01-2017'</span>
  @observable title = <span class="hljs-string">'Dinner with Joe'</span>
  @observable location = <span class="hljs-string">'Chik-Fil-A'</span>

  @computed get isToday() {
    <span class="hljs-keyword">return</span> moment(dueDate, <span class="hljs-string">'MM-DD-YYYY'</span>).diff(moment.now(), <span class="hljs-string">'days'</span>) === <span class="hljs-number">0</span>;
  }

  toString() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.title}</span> @ <span class="hljs-subst">${<span class="hljs-keyword">this</span>.location}</span>`</span>;
  }
}


@observer <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TodayBox</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  render () {
    <span class="hljs-keyword">let</span> {appointments} = <span class="hljs-keyword">this</span>.props;
    <span class="hljs-keyword">return</span> (<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {appointments.filter(a =&gt; a.isToday).map(a =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>a.toString()<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>)}     
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>);
  }
}
</code></pre>
<p>That obviously looks a lot cleaner than my example.  So what’s the problem?  Again, decorators are a <em>proposed</em> JavaScript feature.  Currently they’re in Stage 2, which means roughly that they are very likely to eventually make it into the language, but may change in non-trivial ways before that happens.  Currently decorators are implemented in <a href="https://www.typescriptlang.org/docs/handbook/decorators.html">TypeScript</a>, as well as a <a href="https://github.com/loganfsmyth/babel-plugin-transform-decorators-legacy">3rd party babel plugin</a>, but as of January 2017 <a href="http://kangax.github.io/compat-table/esnext/#test-class_decorators">are not implemented in any browser engines</a>, and are not implemented in any first party babel plugins <a href="https://github.com/babel/babel/issues/2645">due to spec instability</a>.  Decorators are a key part of Angular2, and are used by other frameworks including <a href="http://aurelia.io/">Aurelia</a> and <a href="https://github.com/rwjblue/ember-computed-decorators">Ember</a>, so I don’t think they’re going away.  But I also don’t see them as ready for production use for teams that don’t have the capacity to dedicate the time to update existing code if/when the spec changes<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>.  If for one reason or other you’re comfortable with the risks however, decorators are a great way to clean up the MobX API, and I’m excited for the spec to get to the point where I can use them.</p>
<h3>Comparison to Redux and setState</h3>
<p>As a state management library that was built to be used with React, the obvious questions to ask about MobX are how it improves over React’s built in state handling, and how it compares to <a href="http://redux.js.org/">Redux</a>, the current most popular state management solution for React. MobX takes a different approach to each.</p>
<p>It’s important to say at the start that MobX isn’t mutually exclusive with using setState.  It’s possible to use them together, with MobX managing application data and setState handling individual component/UI state.  But there is some advantages to using MobX for UI state as well.  The biggest reason is that MobX is smarter than setState about when re-rendering is required.  By default React Components re-render on any call to setState, regardless of whether the state change actually affects what is rendered or not. MobX’s creator <a href="https://medium.com/@mweststrate/3-reasons-why-i-stopped-using-react-setstate-ab73fc67a42e#.x0o6y4rxv">wrote more about this on Medium</a>.</p>
<p>Comparing MobX and Redux could be a whole article on its own, so I’m not going to go too deep here, but suffice it to say that MobX is more flexible than Redux, but as a result loses some of the benefits of Redux’s structured approach.  Specifically, it is easy to convert a single object to become a MobX observable and use it in an existing React component.  It can be easily inlined in an existing file and used for one component even.  You also don’t have to deal with the ceremony of using <a href="http://benmccormick.org/2016/06/04/what-are-mutable-and-immutable-data-structures-2/">immutable data</a>.  Redux is intended as a solution that will take over all your state, and doesn’t scale down nearly as well or mix with other solutions <sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>.  However, Redux’s structure also has benefits.  It allows easy testings of each component of an app individually, the creation of powerful tooling that will work with any Redux app, and reliable guarantees of how state will be updated.  These things are mostly possible with MobX <sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>, but require more developer discipline, and/or can’t be written as easily as universal tools. Overgeneralizing, I would prefer Redux in a new application, but would look to MobX for improving data management in an existing application.  MobX also has advantages in applications where you’re displaying a large amount of UI elements based on a relatively small amount of data, or have a lot of derived data (something like a spreadsheet), whereas Redux has benefits for applications that need to be extremely reliable and well tested.</p>
<h3>Stray Thoughts</h3>
<ul>
<li>If you do want more discipline in MobX, make sure to use <code>useStrict</code> to require updates to use Actions</li>
<li>MobX has a nice set of <a href="https://github.com/mobxjs/mobx-react-devtools">devtools</a> that are useful if you’re opting in to using actions, and using React with MobX.</li>
<li>If this isn’t clear yet, I definitely recommend hacking around with Mobx’s low level APIs to learn more about how it works before integrating it straight into a framework</li>
<li><s>Also note that MobX 3.0 is imminent, there is a release candidate that you can play with now.</s> <strong>Update:</strong> That didn’t take long.  <a href="https://medium.com/@mweststrate/mobx-3-released-unpeeling-the-onion-ca877382f443#.mk6mdypt2">MobX 3.0 is out</a>.</li>
</ul>
<h3>More Resources</h3>
<ul>
<li>
<p>The two most helpful resources I found for conceptually understanding MobX were in-depth articles by the library’s author <a href="">Michael Westrate</a>: <a href="https://medium.com/@mweststrate/becoming-fully-reactive-an-in-depth-explanation-of-mobservable-55995262a254#.jd4hgh2zi">Becoming fully reactive: an in-depth explanation of MobX</a> on Medium and <a href="https://mobx.js.org/intro/concepts.html">Concepts &amp; Principles</a> from the MobX documentation</p>
</li>
<li>
<p>This <a href="https://twitter.com/AdamRackis/status/775706291259908096">tweet thread</a> and the linked article, are a good breakdown of the tradeoffs between MobX and Redux</p>
</li>
</ul>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Technically this also uses class properties as well, another proposal that works well with decorators <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p>It’s possible any spec changes will be trivially fixable with a code mod script, but right now there is more uncertainty than I am personally comfortable with.  I’m grateful to people who are willing to take more risks here than me, they push the language forward. <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn3" class="footnote-item"><p>I’m talking here about what is encouraged and easy, not what is possible.  It is of course possible to mix in Redux with other solutions. <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn4" class="footnote-item"><p>MobX has some nice <a href="https://github.com/mobxjs/mobx-react-devtools">devtools!</a> <a href="#fnref4" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>
</div><div data-reactid="21"><hr data-reactid="22"/><div class="subscribe-container" data-reactid="23"><div class="subscribe-block" data-reactid="24"><p data-reactid="25"><!-- react-text: 26 -->Thanks for taking the time to read this post!<!-- /react-text --><!-- react-text: 27 --> JavaScript development<!-- /react-text --><!-- react-text: 28 --> is one of the main topics of this blog, so if you enjoyed the post, please consider subscribing by using the feed, Twitter or my mailing list.<!-- /react-text --></p><div style="margin-bottom:3.875rem;" data-reactid="29"><div id="mc_embed_signup" data-reactid="30"><h6 style="margin:0;font-size:0.8165rem;line-height:1.55rem;letter-spacing:-0.25px;" data-reactid="31">EMAIL</h6><form action="//benmccormick.us8.list-manage.com/subscribe/post?u=115446b80fd9d930ba091cc27&amp;id=f5b9f5acf2" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="" data-reactid="32"><div id="mc_embed_signup_scroll" data-reactid="33"><div class="mc-field-group" style="padding-right:30px;" data-reactid="34"><input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address" data-reactid="35"/><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button" data-reactid="36"/></div><div id="mce-responses" class="clear" data-reactid="37"><div class="response" id="mce-error-response" style="display:none;" data-reactid="38"></div><div class="response" id="mce-success-response" style="display:none;" data-reactid="39"></div></div><div style="position:absolute;left:-5000px;" aria-hidden="true" data-reactid="40"><input type="text" name="b_115446b80fd9d930ba091cc27_f5b9f5acf2" tabindex="-1" value="" data-reactid="41"/></div><div class="clear" data-reactid="42"></div></div></form></div><div class="rss" data-reactid="43"><h6 style="margin:0;font-size:0.8165rem;line-height:1.55rem;letter-spacing:-0.25px;" data-reactid="44">RSS</h6><a href="/rss/" data-reactid="45"><i class="rss-icon" data-reactid="46"><svg viewBox="0 0 10 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>rss</title><desc>Created with Sketch.</desc><defs></defs><g id="Octicons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="rss" fill="#000000"><path d="M2,13 L0,13 L0,11 C1.11,11 2,11.89 2,13 L2,13 Z M0,3 L0,4 C4.97,4 9,8.03 9,13 L10,13 C10,7.48 5.52,3 0,3 L0,3 Z M0,7 L0,8 C2.75,8 5,10.25 5,13 L6,13 C6,9.69 3.31,7 0,7 L0,7 Z" id="Shape"></path></g></g></svg></i><!-- react-text: 47 --> <!-- /react-text --><span data-reactid="48">RSS</span></a></div><div data-reactid="49"><h6 style="margin:0;font-size:0.8165rem;line-height:1.55rem;letter-spacing:-0.25px;" data-reactid="50">TWITTER</h6><div class="twitter-item" data-reactid="51"><span data-reactid="52">Site Feed: </span><a href="https://twitter.com/benmccormickorg" class="twitter-follow-button" data-show-count="false" data-reactid="53">Follow @benmccormickorg</a></div></div><div data-reactid="54"><div class="twitter-item" data-reactid="55"><span data-reactid="56">Personal Feed: </span><a href="https://twitter.com/ben336" class="twitter-follow-button" data-show-count="false" data-reactid="57">Follow @ben336</a></div></div></div></div><div class="up-next-block" data-reactid="58"><h6 style="margin:0;font-size:0.8165rem;line-height:1.55rem;letter-spacing:-0.25px;" data-reactid="59">You Might Also Like:</h6><div data-reactid="60"><h3 style="margin-top:0;margin-bottom:0.3875rem;" data-reactid="61"><a href="/2016/09/19/testing-with-jest-snapshots-first-impressions/?readNext=true#title" data-reactid="62">Testing with Jest Snapshots: First Impressions</a></h3><p data-reactid="63">First impression of testing UI components using Jest snapshots</p></div><div data-reactid="64"><hr data-reactid="65"/><h3 style="margin-top:0;margin-bottom:0.3875rem;" data-reactid="66"><a href="/2016/05/02/digging-into-react-choosing-component-styles/?readNext=true#title" data-reactid="67">Digging Into React: Choosing Component Styles</a></h3><p data-reactid="68">An examination of the various styles for defining React components</p></div><div data-reactid="69"><hr data-reactid="70"/><h3 style="margin-top:0;margin-bottom:0.3875rem;" data-reactid="71"><a href="/2015/09/09/what-can-backbone-developers-learn-from-react/?readNext=true#title" data-reactid="72">Lessons Backbone Developers Can Learn From React</a></h3><p data-reactid="73">A look at the lessons that Backbone developers can learn from React</p></div></div></div></div><hr style="margin-bottom:3.1rem;" data-reactid="74"/><div title="MobX: First Impressions" data-reactid="75"><div id="disqus_thread" data-reactid="76"></div><noscript data-reactid="77"><span data-reactid="78"><!-- react-text: 79 -->Please enable JavaScript to view the<!-- /react-text --><a href="http://disqus.com/?ref_noscript" data-reactid="80">comments powered by Disqus.</a></span></noscript><a href="http://disqus.com" class="dsq-brlink" data-reactid="81"><!-- react-text: 82 -->Blog comments powered by <!-- /react-text --><span class="logo-disqus" data-reactid="83">Disqus</span><!-- react-text: 84 -->.<!-- /react-text --></a></div></div><span style="display:block;clear:both;" data-reactid="85"> </span></div></div><script src="/bundle.js?t=1496547995590"></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-37323973-1', 'auto');
            ga('send', 'pageview');
        </script><script type="text/javascript">
              // adapted from: https://css-tricks.com/serviceworker-for-offline/
              // ServiceWorker is a progressive technology. Ignore unsupported browsers
              if ('serviceWorker' in navigator) {
              console.log('CLIENT: service worker registration in progress.');
              navigator.serviceWorker.register('/sw.js').then(function() {
                console.log('CLIENT: service worker registration complete.');
              }, function() {
                console.log('CLIENT: service worker registration failure.');
              });
              } else {
              console.log('CLIENT: service worker is not supported.');
              }
            </script></body></html>