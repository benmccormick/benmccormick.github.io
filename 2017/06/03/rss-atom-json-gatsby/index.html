<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=yyxgnp97qG"/><link rel="icon" type="image/png" href="/favicon-32x32.png?v=yyxgnp97qG" sizes="32x32"/><link rel="icon" type="image/png" href="/favicon-16x16.png?v=yyxgnp97qG" sizes="16x16"/><link rel="manifest" href="/manifest.json"/><link rel="mask-icon" href="/safari-pinned-tab.svg?v=yyxgnp97qG" color="#rgb(42, 194, 240)"/><link rel="alternate" title="JSON Feed" type="application/json" href="/feed.json"/><link rel="shortcut icon" href="/favicon.ico?v=yyxgnp97qG"/><meta name="theme-color" content="#ffffff"/><title data-react-helmet="true"></title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.6 'minion-3','Garamond',serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'minion-3','Garamond',serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.6rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.32578rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.20684rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.91028rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;color:inherit;font-family:'mr-eaves-xl-modern',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.86849rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}ul{margin-left:1.6rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.6rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;font-size:0.85rem;line-height:1.1;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.2rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;font-size:1rem;line-height:1.6rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}blockquote{margin-left:1.6rem;margin-right:1.6rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.2rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.2rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.2rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.6rem;margin-bottom:calc(1.2rem / 2);margin-top:calc(1.2rem / 2);}li > ul{margin-left:1.6rem;margin-bottom:calc(1.2rem / 2);margin-top:calc(1.2rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.2rem / 2);}code{font-size:0.85rem;line-height:1.6rem;}kbd{font-size:0.85rem;line-height:1.6rem;}samp{font-size:0.85rem;line-height:1.6rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.06667rem;padding-right:1.06667rem;padding-top:0.8rem;padding-bottom:calc(0.8rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;font-size:14px;}pre code{background:none;line-height:1.1;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}h1,h2,h3,h4,h5,h6{line-height:1.1;}@media only screen and (max-width:480px){html{font-size:112.5%;}}</style><style data-href="/component---src-templates-blog-post-js.798d7f465f017e25729f.css">.markdown pre{display:block;background:#343d46;color:#d8dee9;padding:.8rem}.markdown pre code:after{content:unset}.token.comment,.token.quote{color:#a7adba}.token.addition,.token.attr,.token.selector-tag,.token.string{color:#99c794}.token.doctag,.token.meta .token.meta-string,.token.regexp{color:#89ddf3}.token.built_in,.token.function{color:#5fb3b3}.token.name,.token.section,.token.selector-class,.token.selector-id,.token.title{color:#69c}.token.attribute,.token.class .token.title,.token.template-variable,.token.type,.token.variable{color:#fac863}.token.bullet,.token.link,.token.meta,.token.meta .token.keyword,.token.selector-attr,.token.selector-pseudo,.token.subst,.token.symbol{color:#f9ae58}.token.boolean,.token.deletion,.token.literal,.token.number{color:#f07178}.token.keyword{color:#c594c5}.token.formula{background:#a7adba}.token.emphasis{font-style:italic}.token.strong{font-weight:700}.gatsby-resp-image-wrapper{max-width:75%;display:block;margin:40px auto 20px}.bordered-img{border:3px solid #rgb(42,194,240)}.img-group{display:flex;justify-content:space-between}.img-group img{padding:0;height:auto}.inline-img{width:45%;display:inline-block;float:right;padding:2rem}#bd-label{font-family:mr-eaves-xl-modern,Helvetica Neue,Arial,sans-serif;font-weight:700}#bd-label.large-label{font-size:20px}#bd-email{padding-left:5px}#bd-email,#bd-submit{font-family:mr-eaves-xl-modern,Helvetica Neue,Arial,sans-serif;font-size:14px}#bd-submit{background:#f1684e;color:#fff;border-radius:4px;border:none}@media (max-width:960px){#bd-email,#bd-submit{font-size:10px}#bd-label{font-size:12px}}.large-row #bd-email,.large-row #bd-submit{font-size:30px}@media (max-width:700px){.large-row #bd-email,.large-row #bd-submit{font-size:18px}}.bd-subscribe-form{margin:30px 0 50px;display:block}.bd-subscribe-row{display:grid;grid-template-columns:60% 35%;grid-column-gap:5%;grid-template-rows:1fr;margin-top:10px}@media (max-width:960px){.bd-subscribe-row{grid-template-columns:1fr;grid-row-gap:10%;grid-template-rows:1fr 1fr}}.twitter-tweet,twitterwidget{margin-left:auto;margin-right:auto}body{color:#474747}a{color:#f1684e;text-decoration:none;cursor:pointer}a:hover{text-decoration:underline}.footnote-backref,.footnote-ref{text-decoration:none;padding-left:3px}blockquote{border-left:5px solid #2ac2f0;background:#eee;font-weight:400;font-size:.9rem;padding:1.5rem 2rem;margin:0 0 1rem}blockquote p{margin-bottom:.667em}h3{color:#2ac2f0}h4{font-size:110%}.explanation{padding:10px;background:#eee;border-radius:10px;margin:20px auto;font-size:.85em}.footnotes{font-size:80%}.footnotes li>*{display:inline;margin-bottom:0}strong{color:#639f6e}em{color:#9a74aa}.markdown iframe{margin:0 auto}.carbon-wrap{display:grid;grid-template-columns:1fr 1fr;grid-column-gap:10px;grid-template-rows:1fr;margin-bottom:30px;align-items:center;padding-left:5px}@media (max-width:960px){.carbon-wrap{grid-template-columns:1fr;grid-template-rows:110px 1fr;grid-row-gap:10px;justify-items:center}}.carbon-wrap img{margin-bottom:0}.carbon-text{padding:5px 5px 5px 0;display:inline-block;overflow:hidden;line-height:1.3}.carbon-poweredby{color:#999;position:absolute;right:5px;bottom:0}.columns{display:grid;grid-template-columns:665px 270px;grid-template-rows:1fr;grid-column-gap:25px}@media (max-width:960px){.columns{display:grid;grid-template-columns:70% 28%;grid-column-gap:2%}}@media (max-width:700px){.columns{display:flex;flex-direction:column;align-items:center}.no-mobile{display:none}}@media (max-width:321px){html{font-size:100%!important}}</style><meta name="generator" content="Gatsby 2.0.75"/><style id="glamor-styles">.css-tcc0st,[data-css-tcc0st]{color:#999999;font-size:16px;font-family:"mr-eaves-xl-modern", "Helvetica Neue", Arial, sans-serif;}.css-tcc0st:hover,[data-css-tcc0st]:hover{color:#F1684E;}.css-1gs5qio,[data-css-1gs5qio]{font-size:16px;font-family:"mr-eaves-xl-modern", "Helvetica Neue", Arial, sans-serif;}.css-1kzlgaa,[data-css-1kzlgaa]{font-family:"mr-eaves-xl-modern", "Helvetica Neue", Arial, sans-serif;font-size:0.75rem;background:#170537;color:rgba(256,256,256,1);display:-webkit-box; display: -moz-box; display: -ms-flexbox; display: -webkit-flex; display: flex;flex-direction:row;justify-content:flex-start;align-items:center;border-radius:0.25rem;padding:0.125rem 0.35rem;width:12rem;height:2rem;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-webkit-box-pack:start;-webkit-justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;}.css-1kzlgaa:hover,[data-css-1kzlgaa]:hover{text-decoration:none;}@media all and (max-width: 960px){.css-1kzlgaa,[data-css-1kzlgaa]{height:1.6rem;width:7rem;font-size:0.55rem;}}</style><script id="glamor-ids">
        // <![CDATA[
        window._glamor = ["tcc0st","1gs5qio","1kzlgaa"]
        // ]]>
        </script><title data-react-helmet="true">Adding RSS, Atom, and JSON Feed to Gatsby | benmccormick.org</title><meta data-react-helmet="true" name="description" content="Ben McCormick&#x27;s blog on JavaScript and Web Development"/><meta data-react-helmet="true" name="keywords" content="rss atom json feed gatsby"/><script data-react-helmet="true" type="application/ld+json">{
                  "@context": "http://schema.org"
                  "@type": "BlogPosting",
                  "headline": "Adding RSS, Atom, and JSON Feed to Gatsby",
                  "genre": "Software Development",
                  "keywords": "rss atom json feed gatsby",
                  "url": "http://benmccormick.org//2017/06/03/rss-atom-json-gatsby/",
                  "image": "http://benmccormick.org/logo.png",
                  "datePublished": "2017-06-4",
                  
                  "articleBody": "<p>For the last few months, this blog has been written in <a href=\"https://github.com/gatsbyjs/gatsby\">Gatsby</a>, a static site generator for JavaScript.  One of the first problems I had to solve when migrating the blog was how to maintain my RSS feed, since Gatsby doesn’t have any built in concept of an RSS feed.  This issue came up again this week as I decided to implement the new <a href=\"https://jsonfeed.org/\">JSON Feed</a> spec and give folks an additional option for subscribing to this blog.  Fortunately this turns out to be a pretty easy problem to solve because of the excellent npm module <a href=\"https://github.com/jpmonette/feed\">feed</a>.</p>
<p><em>feed</em> is an npm module that takes a bunch of information about a blog and its posts, and normalizes them into various syndication feed format.  Here’s what setting up a feed option looks like for this blog:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> Feed <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'feed'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> filter <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lodash/filter'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> sortBy <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lodash/sortBy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> forEach <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lodash/forEach'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> <span class=\"token keyword\">get</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lodash/get'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> moment <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'moment'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> markdownIt <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'markdown-it'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> frontmatter <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'front-matter'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>


<span class=\"token comment\">//markdownIt is a markdown parser that takes my raw md files and</span>
<span class=\"token comment\">//translates them into HTML that we can use in the feed</span>
<span class=\"token keyword\">const</span> md <span class=\"token operator\">=</span> <span class=\"token function\">markdownIt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>
  html<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>
  linkify<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>
  typographer<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>


<span class=\"token comment\">// getPageContent is a function to help us grab the html content from a post path</span>
<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getPageContent</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">page</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
  <span class=\"token keyword\">let</span> file <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>__dirname <span class=\"token operator\">+</span> <span class=\"token string\">'/pages/'</span> <span class=\"token operator\">+</span> page<span class=\"token punctuation\">.</span>requirePath<span class=\"token punctuation\">,</span> <span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token keyword\">let</span> body <span class=\"token operator\">=</span> md<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token function\">frontmatter</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token comment\">// handle local links</span>
  <span class=\"token keyword\">return</span> body<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/src=\"\//g</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'src=\"http://benmccormick.org/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>

<span class=\"token comment\">// build feed is our main function to build a `Feed` object which we</span>
<span class=\"token comment\">// can then serialize into various formats</span>
<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">buildFeed</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">pages</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
  <span class=\"token keyword\">let</span> feed <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Feed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>
    title<span class=\"token punctuation\">:</span> <span class=\"token string\">'benmccormick.org'</span><span class=\"token punctuation\">,</span>
    description<span class=\"token punctuation\">:</span> <span class=\"token string\">'A blog by Ben McCormick'</span><span class=\"token punctuation\">,</span>
    link<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://benmccormick.org'</span><span class=\"token punctuation\">,</span>
    id<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://benmccormick.org'</span><span class=\"token punctuation\">,</span>
    copyright<span class=\"token punctuation\">:</span> <span class=\"token string\">'All rights reserved 2016, Ben McCormick'</span><span class=\"token punctuation\">,</span>
    feedLinks<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
      atom<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://benmccormick.org/atom.xml'</span><span class=\"token punctuation\">,</span>
      json<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://benmccormick.org/feed.json'</span><span class=\"token punctuation\">,</span>
    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>
    author<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Ben McCormick'</span><span class=\"token punctuation\">,</span>
      email<span class=\"token punctuation\">:</span> <span class=\"token string\">'ben@benmccormick.org'</span>
    <span class=\"token punctuation\">}</span>
  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token comment\">// ignore pages (non posts)</span>
  pages <span class=\"token operator\">=</span> <span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>pages<span class=\"token punctuation\">,</span> <span class=\"token parameter\">p</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span> <span class=\"token string\">'data.layout'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'page'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">'page'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token comment\">// we only want the last 10 articles to show up in the feed</span>
  pages <span class=\"token operator\">=</span> <span class=\"token function\">sortBy</span><span class=\"token punctuation\">(</span>pages<span class=\"token punctuation\">,</span> <span class=\"token parameter\">page</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">,</span> <span class=\"token string\">'data.date'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  pages <span class=\"token operator\">=</span> pages<span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  pages <span class=\"token operator\">=</span> pages<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

  <span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>pages<span class=\"token punctuation\">,</span> <span class=\"token parameter\">page</span> <span class=\"token operator\">=></span> feed<span class=\"token punctuation\">.</span><span class=\"token function\">addItem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>
    title<span class=\"token punctuation\">:</span> page<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>
    id<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://benmccormick.org'</span> <span class=\"token operator\">+</span> page<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">,</span>
    link<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://benmccormick.org'</span> <span class=\"token operator\">+</span> page<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">,</span>
    date<span class=\"token punctuation\">:</span> <span class=\"token function\">moment</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>
    content<span class=\"token punctuation\">:</span> <span class=\"token function\">getPageContent</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>
    author<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>
      <span class=\"token punctuation\">{</span>
        name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Ben McCormick'</span><span class=\"token punctuation\">,</span>
        email<span class=\"token punctuation\">:</span> <span class=\"token string\">'ben@benmccormick.org'</span><span class=\"token punctuation\">,</span>
        link<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://benmccormick.org'</span>
      <span class=\"token punctuation\">}</span>
    <span class=\"token punctuation\">]</span>
  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  feed<span class=\"token punctuation\">.</span><span class=\"token function\">addContributor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>
    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Ben McCormick'</span><span class=\"token punctuation\">,</span>
    email<span class=\"token punctuation\">:</span> <span class=\"token string\">'ben@benmccormick.org'</span><span class=\"token punctuation\">,</span>
    link<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://benmccormick.org'</span>
  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token keyword\">return</span> feed<span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>
<p>Now we have a <code class=\"language-text\">buildFeed</code> method that takes a list of pages and generates a feed object.  Then we can use the feed object we’ve created to actually build write some files.  We’ll trigger that in the <code class=\"language-text\">postBuild</code> callback of <code class=\"language-text\">gatsby-node</code>.  Here was my first version to support RSS and Atom:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//mkDir and mkFile are just light wrappers around node's file system APIs</span>
<span class=\"token keyword\">let</span> <span class=\"token function-variable function\">createRSSFolder</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">mkDir</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/public/rss/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">let</span> <span class=\"token function-variable function\">generateAtomFeed</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">feed</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">mkFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/public/atom.xml'</span><span class=\"token punctuation\">,</span> feed<span class=\"token punctuation\">.</span><span class=\"token function\">atom1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">let</span> <span class=\"token function-variable function\">generateRSS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">feed</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">mkFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/public/rss/index.xml'</span><span class=\"token punctuation\">,</span> feed<span class=\"token punctuation\">.</span><span class=\"token function\">rss2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">postBuild</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">pages</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
  <span class=\"token keyword\">let</span> feed <span class=\"token operator\">=</span> <span class=\"token function\">buildFeed</span><span class=\"token punctuation\">(</span>pages<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token function\">createRSSFolder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token function\">generateAtomFeed</span><span class=\"token punctuation\">(</span>feed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token function\">generateRSS</span><span class=\"token punctuation\">(</span>feed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>
<p>Prior to this week, <code class=\"language-text\">feed</code> didn’t support JSON Feed, so I had stopped here.  But because JSON Feed is super simple to implement (its just JSON!), I decided to try to add it to <code class=\"language-text\">feed</code> this week.  It turned out it was as simple as adding a single function that looks like this:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">json1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
   <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> options<span class=\"token punctuation\">,</span> items <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span>
   <span class=\"token keyword\">let</span> feed <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>
     version<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://jsonfeed.org/version/1'</span><span class=\"token punctuation\">,</span>
     title<span class=\"token punctuation\">:</span> options<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>
   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>

   <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
     feed<span class=\"token punctuation\">.</span>home_page_url <span class=\"token operator\">=</span> options<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">;</span>
   <span class=\"token punctuation\">}</span>

   <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">.</span>feedLinks <span class=\"token operator\">&amp;&amp;</span> options<span class=\"token punctuation\">.</span>feedLinks<span class=\"token punctuation\">.</span>json<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
     feed<span class=\"token punctuation\">.</span>feed_url <span class=\"token operator\">=</span> options<span class=\"token punctuation\">.</span>feedLinks<span class=\"token punctuation\">.</span>json<span class=\"token punctuation\">;</span>
   <span class=\"token punctuation\">}</span>

   <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
     feed<span class=\"token punctuation\">.</span>description <span class=\"token operator\">=</span> options<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">;</span>
   <span class=\"token punctuation\">}</span>


   <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">.</span>image<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
     feed<span class=\"token punctuation\">.</span>icon <span class=\"token operator\">=</span> options<span class=\"token punctuation\">.</span>image<span class=\"token punctuation\">;</span>
   <span class=\"token punctuation\">}</span>

   <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
     feed<span class=\"token punctuation\">.</span>author <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>
     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
         feed<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> options<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>
     <span class=\"token punctuation\">}</span>
     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
         feed<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>url <span class=\"token operator\">=</span> options<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">;</span>
     <span class=\"token punctuation\">}</span>
   <span class=\"token punctuation\">}</span>
   feed<span class=\"token punctuation\">.</span>items <span class=\"token operator\">=</span> items<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
     <span class=\"token keyword\">let</span> feedItem <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>
       id<span class=\"token punctuation\">:</span> item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>
       <span class=\"token comment\">// json_feed distinguishes between html and text content</span>
       <span class=\"token comment\">// but since we only take a single type, we'll assume HTML</span>
       html_content<span class=\"token punctuation\">:</span> item<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">,</span>
     <span class=\"token punctuation\">}</span>
     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
       feedItem<span class=\"token punctuation\">.</span>url <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">;</span>
     <span class=\"token punctuation\">}</span>
     <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
       feedItem<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">;</span>
     <span class=\"token punctuation\">}</span>
     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
       feedItem<span class=\"token punctuation\">.</span>summary <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">;</span>
     <span class=\"token punctuation\">}</span>

     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>image<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
       feedItem<span class=\"token punctuation\">.</span>image <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>image
     <span class=\"token punctuation\">}</span>

     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
       feedItem<span class=\"token punctuation\">.</span>date_modified <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">ISODateString</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
     <span class=\"token punctuation\">}</span>
     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>published<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
       feedItem<span class=\"token punctuation\">.</span>date_published <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">ISODateString</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>published<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
     <span class=\"token punctuation\">}</span>

     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
       <span class=\"token keyword\">let</span> author <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">;</span>
       <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>author <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
         <span class=\"token comment\">// json feed only supports 1 author per post</span>
         author <span class=\"token operator\">=</span> author<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>
       <span class=\"token punctuation\">}</span>
       feedItem<span class=\"token punctuation\">.</span>author <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>
       <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>author<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
           feedItem<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> author<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>
       <span class=\"token punctuation\">}</span>
       <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>author<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>
           feedItem<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>url <span class=\"token operator\">=</span> author<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">;</span>
       <span class=\"token punctuation\">}</span>
     <span class=\"token punctuation\">}</span>
     <span class=\"token keyword\">return</span> feedItem<span class=\"token punctuation\">;</span>
   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

   <span class=\"token keyword\">return</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>feed<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
 <span class=\"token punctuation\">}</span></code></pre></div>
<p> My <a href=\"https://github.com/jpmonette/feed/pull/56/files\">pull request</a> was accepted, so feed v1.1.0 now supports JSON feed and my final code to add <a href=\"http://benmccormick.org/rss/\">rss</a>, <a href=\"http://benmccormick.org/atom.xml\">atom</a>, and <a href=\"http://benmccormick.org/feed.json\">json</a> feed to this site looks like this:</p>
<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> Feed <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'feed'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> filter <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lodash/filter'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> sortBy <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lodash/sortBy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> forEach <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lodash/forEach'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> <span class=\"token keyword\">get</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lodash/get'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> moment <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'moment'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> markdownIt <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'markdown-it'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> frontmatter <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'front-matter'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>mkDir<span class=\"token punctuation\">,</span> mkFile<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./utils/file_system'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>


<span class=\"token keyword\">const</span> md <span class=\"token operator\">=</span> <span class=\"token function\">markdownIt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>
 html<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>
 linkify<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>
 typographer<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">extractMarkdownContent</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">file</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
 <span class=\"token keyword\">let</span> body <span class=\"token operator\">=</span> md<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token function\">frontmatter</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
 <span class=\"token comment\">// handle local links</span>
 <span class=\"token keyword\">return</span> body<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/src=\"\//g</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'src=\"http://benmccormick.org/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>

<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getPageContent</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">page</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
 <span class=\"token keyword\">let</span> file <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>__dirname <span class=\"token operator\">+</span> <span class=\"token string\">'/pages/'</span> <span class=\"token operator\">+</span> page<span class=\"token punctuation\">.</span>requirePath<span class=\"token punctuation\">,</span> <span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
 <span class=\"token keyword\">return</span> <span class=\"token function\">extractMarkdownContent</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>

<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">buildFeed</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">pages</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
 <span class=\"token keyword\">let</span> feed <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Feed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>
   title<span class=\"token punctuation\">:</span> <span class=\"token string\">'benmccormick.org'</span><span class=\"token punctuation\">,</span>
   description<span class=\"token punctuation\">:</span> <span class=\"token string\">'A blog by Ben McCormick'</span><span class=\"token punctuation\">,</span>
   link<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://benmccormick.org'</span><span class=\"token punctuation\">,</span>
   id<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://benmccormick.org'</span><span class=\"token punctuation\">,</span>
   copyright<span class=\"token punctuation\">:</span> <span class=\"token string\">'All rights reserved 2016, Ben McCormick'</span><span class=\"token punctuation\">,</span>
   feedLinks<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
     atom<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://benmccormick.org/atom.xml'</span><span class=\"token punctuation\">,</span>
     json<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://benmccormick.org/feed.json'</span><span class=\"token punctuation\">,</span>
   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>
   author<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>
     name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Ben McCormick'</span><span class=\"token punctuation\">,</span>
     email<span class=\"token punctuation\">:</span> <span class=\"token string\">'ben@benmccormick.org'</span>
   <span class=\"token punctuation\">}</span>
 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
 <span class=\"token comment\">// ignore pages (non posts)</span>
 pages <span class=\"token operator\">=</span> <span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>pages<span class=\"token punctuation\">,</span> <span class=\"token parameter\">p</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span> <span class=\"token string\">'data.layout'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'page'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">'page'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
 <span class=\"token comment\">// we only want the last 10 articles to show up in the feed</span>
 pages <span class=\"token operator\">=</span> <span class=\"token function\">sortBy</span><span class=\"token punctuation\">(</span>pages<span class=\"token punctuation\">,</span> <span class=\"token parameter\">page</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">,</span> <span class=\"token string\">'data.date'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
 pages <span class=\"token operator\">=</span> pages<span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
 pages <span class=\"token operator\">=</span> pages<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

 <span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>pages<span class=\"token punctuation\">,</span> <span class=\"token parameter\">page</span> <span class=\"token operator\">=></span> feed<span class=\"token punctuation\">.</span><span class=\"token function\">addItem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>
   title<span class=\"token punctuation\">:</span> page<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>
   id<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://benmccormick.org'</span> <span class=\"token operator\">+</span> page<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">,</span>
   link<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://benmccormick.org'</span> <span class=\"token operator\">+</span> page<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">,</span>
   date<span class=\"token punctuation\">:</span> <span class=\"token function\">moment</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>
   content<span class=\"token punctuation\">:</span> <span class=\"token function\">getPageContent</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>
   author<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>
     <span class=\"token punctuation\">{</span>
       name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Ben McCormick'</span><span class=\"token punctuation\">,</span>
       email<span class=\"token punctuation\">:</span> <span class=\"token string\">'ben@benmccormick.org'</span><span class=\"token punctuation\">,</span>
       link<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://benmccormick.org'</span>
     <span class=\"token punctuation\">}</span>
   <span class=\"token punctuation\">]</span>
 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
 feed<span class=\"token punctuation\">.</span><span class=\"token function\">addContributor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>
   name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Ben McCormick'</span><span class=\"token punctuation\">,</span>
   email<span class=\"token punctuation\">:</span> <span class=\"token string\">'ben@benmccormick.org'</span><span class=\"token punctuation\">,</span>
   link<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://benmccormick.org'</span>
 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
 <span class=\"token keyword\">return</span> feed<span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>

<span class=\"token keyword\">let</span> <span class=\"token function-variable function\">createRSSFolder</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">mkDir</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/public/rss/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">let</span> <span class=\"token function-variable function\">generateAtomFeed</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">feed</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">mkFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/public/atom.xml'</span><span class=\"token punctuation\">,</span> feed<span class=\"token punctuation\">.</span><span class=\"token function\">atom1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">let</span> <span class=\"token function-variable function\">generateRSS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">feed</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">mkFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/public/rss/index.xml'</span><span class=\"token punctuation\">,</span> feed<span class=\"token punctuation\">.</span><span class=\"token function\">rss2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token keyword\">let</span> <span class=\"token function-variable function\">generateJSONFeed</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">feed</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">mkFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/public/feed.json'</span><span class=\"token punctuation\">,</span> feed<span class=\"token punctuation\">.</span><span class=\"token function\">json1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>

exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">postBuild</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">pages</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>
  <span class=\"token keyword\">let</span> feed <span class=\"token operator\">=</span> <span class=\"token function\">buildFeed</span><span class=\"token punctuation\">(</span>pages<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token function\">createRSSFolder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token function\">generateAtomFeed</span><span class=\"token punctuation\">(</span>feed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token function\">generateRSS</span><span class=\"token punctuation\">(</span>feed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
  <span class=\"token function\">generateJSONFeed</span><span class=\"token punctuation\">(</span>feed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>
<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>
<h3>More Resources</h3>
<ul>
<li>You can see the whole spec for <a href=\"https://jsonfeed.org/\">JSON Feed</a> on their <a href=\"https://jsonfeed.org/\">site</a>.  It really is remarkably simple.  They also have a list of implementations and example sites.</li>
</ul>",
                    "author": {
                      "@type": "Person",
                      "name": "Ben McCormick"
                      "email": "mailto:ben@benmccormick.org",
                      "image": "/profile_pic.jpg",
                      "jobTitle": "Software Engineer",
                      "alumniOf": "Duke",
                      "birthPlace": "Pittsburgh, PA",
                      "gender": "male",
                      "url": "http://benmccormick.org",
                	    "sameAs" : [
                        "https://www.linkedin.com/in/benmccormick",
                        "http://twitter.com/_benmccormick",
                      ]
                   }
                }</script><link as="script" rel="preload" href="/component---src-templates-blog-post-js-69cabe4c360af79450d4.js"/><link as="script" rel="preload" href="/app-667aa80e342971869923.js"/><link as="script" rel="preload" href="/2-a8610bc7c3007782573b.js"/><link as="script" rel="preload" href="/0-71075e707b2d73871cd4.js"/><link as="script" rel="preload" href="/webpack-runtime-10ac1f7d593940ad8124.js"/><link as="fetch" rel="preload" href="/static/d/405/path---2017-06-03-rss-atom-json-gatsby-736-704-FF71L3AUNEmcpsSV3pEZq6Zn4M.json" crossorigin="use-credentials"/></head><body class="landing-page" style="background:#FCFCFC"><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><style data-emotion-css="1f3kluc">.css-1f3kluc{width:100%;max-width:1000px;margin:0 auto;padding:2.4rem 20px;}</style><div class="css-1f3kluc em100y90"><style data-emotion-css="13vv67v">.css-13vv67v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding-bottom:2rem;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}</style><div class="css-13vv67v e1b8f8ar0"><style data-emotion-css="txnzm6">.css-txnzm6{margin:0 20px 0 0;padding-bottom:0;}.css-txnzm6 a{box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;}.css-txnzm6 a:hover{-webkit-text-decoration:none;text-decoration:none;}</style><h3 class="css-txnzm6 e1b8f8ar2"><a name="title" href="/">Ben McCormick</a></h3><style data-emotion-css="177tisd">.css-177tisd{color:#999999;}</style><div class="css-177tisd e1b8f8ar3"><a class="css-tcc0st" href="/archive/">Blog</a><style data-emotion-css="12jh0su">.css-12jh0su{padding:0 0.5rem;}@media all and (max-width:400px){.css-12jh0su{padding:0 0.25rem;}}</style><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="/subscribe/">Subscribe</a><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="/speaking/">Speaking</a><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="http://twitter.com/_benmccormick">Twitter</a><span class="css-12jh0su e1b8f8ar1"></span><a class="css-tcc0st" href="/about/">About</a></div></div><article class="markdown"><div class="post-title-area"><style data-emotion-css="92repi">.css-92repi{display:block;max-width:100%;}</style><h1 class="css-92repi e15djruj0">Adding RSS, Atom, and JSON Feed to Gatsby</h1></div><div class="columns"><style data-emotion-css="qsg3oo">.css-qsg3oo{max-width:100%;}.css-qsg3oo li{padding-left:10px;}.css-qsg3oo .reading-img img{width:150px;float:right;margin:0px 10px 20px 10px;}.css-qsg3oo img.full-width{max-height:none;}.css-qsg3oo img.half-width{max-height:none;width:50%;}</style><div class="css-qsg3oo e15djruj2"><p>For the last few months, this blog has been written in <a href="https://github.com/gatsbyjs/gatsby">Gatsby</a>, a static site generator for JavaScript.  One of the first problems I had to solve when migrating the blog was how to maintain my RSS feed, since Gatsby doesn’t have any built in concept of an RSS feed.  This issue came up again this week as I decided to implement the new <a href="https://jsonfeed.org/">JSON Feed</a> spec and give folks an additional option for subscribing to this blog.  Fortunately this turns out to be a pretty easy problem to solve because of the excellent npm module <a href="https://github.com/jpmonette/feed">feed</a>.</p>
<p><em>feed</em> is an npm module that takes a bunch of information about a blog and its posts, and normalizes them into various syndication feed format.  Here’s what setting up a feed option looks like for this blog:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Feed <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'feed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> filter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash/filter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sortBy <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash/sortBy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> forEach <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash/forEach'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">get</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash/get'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> moment <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'moment'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> markdownIt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> frontmatter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'front-matter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">//markdownIt is a markdown parser that takes my raw md files and</span>
<span class="token comment">//translates them into HTML that we can use in the feed</span>
<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">markdownIt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  html<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  linkify<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  typographer<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// getPageContent is a function to help us grab the html content from a post path</span>
<span class="token keyword">const</span> <span class="token function-variable function">getPageContent</span> <span class="token operator">=</span> <span class="token parameter">page</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> file <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/pages/'</span> <span class="token operator">+</span> page<span class="token punctuation">.</span>requirePath<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> body <span class="token operator">=</span> md<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token function">frontmatter</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// handle local links</span>
  <span class="token keyword">return</span> body<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/src="\//g</span><span class="token punctuation">,</span> <span class="token string">'src="http://benmccormick.org/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// build feed is our main function to build a `Feed` object which we</span>
<span class="token comment">// can then serialize into various formats</span>
<span class="token keyword">const</span> <span class="token function-variable function">buildFeed</span> <span class="token operator">=</span> <span class="token parameter">pages</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> feed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Feed</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">'benmccormick.org'</span><span class="token punctuation">,</span>
    description<span class="token punctuation">:</span> <span class="token string">'A blog by Ben McCormick'</span><span class="token punctuation">,</span>
    link<span class="token punctuation">:</span> <span class="token string">'http://benmccormick.org'</span><span class="token punctuation">,</span>
    id<span class="token punctuation">:</span> <span class="token string">'http://benmccormick.org'</span><span class="token punctuation">,</span>
    copyright<span class="token punctuation">:</span> <span class="token string">'All rights reserved 2016, Ben McCormick'</span><span class="token punctuation">,</span>
    feedLinks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      atom<span class="token punctuation">:</span> <span class="token string">'http://benmccormick.org/atom.xml'</span><span class="token punctuation">,</span>
      json<span class="token punctuation">:</span> <span class="token string">'http://benmccormick.org/feed.json'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    author<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token string">'Ben McCormick'</span><span class="token punctuation">,</span>
      email<span class="token punctuation">:</span> <span class="token string">'ben@benmccormick.org'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ignore pages (non posts)</span>
  pages <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span>pages<span class="token punctuation">,</span> <span class="token parameter">p</span> <span class="token operator">=></span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">get</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">'data.layout'</span><span class="token punctuation">,</span> <span class="token string">'page'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'page'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// we only want the last 10 articles to show up in the feed</span>
  pages <span class="token operator">=</span> <span class="token function">sortBy</span><span class="token punctuation">(</span>pages<span class="token punctuation">,</span> <span class="token parameter">page</span> <span class="token operator">=></span> <span class="token keyword">get</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token string">'data.date'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pages <span class="token operator">=</span> pages<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pages <span class="token operator">=</span> pages<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">forEach</span><span class="token punctuation">(</span>pages<span class="token punctuation">,</span> <span class="token parameter">page</span> <span class="token operator">=></span> feed<span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> page<span class="token punctuation">.</span>data<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
    id<span class="token punctuation">:</span> <span class="token string">'https://benmccormick.org'</span> <span class="token operator">+</span> page<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
    link<span class="token punctuation">:</span> <span class="token string">'https://benmccormick.org'</span> <span class="token operator">+</span> page<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
    date<span class="token punctuation">:</span> <span class="token function">moment</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span>data<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    content<span class="token punctuation">:</span> <span class="token function">getPageContent</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">,</span>
    author<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'Ben McCormick'</span><span class="token punctuation">,</span>
        email<span class="token punctuation">:</span> <span class="token string">'ben@benmccormick.org'</span><span class="token punctuation">,</span>
        link<span class="token punctuation">:</span> <span class="token string">'https://benmccormick.org'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  feed<span class="token punctuation">.</span><span class="token function">addContributor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'Ben McCormick'</span><span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> <span class="token string">'ben@benmccormick.org'</span><span class="token punctuation">,</span>
    link<span class="token punctuation">:</span> <span class="token string">'https://benmccormick.org'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> feed<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Now we have a <code class="language-text">buildFeed</code> method that takes a list of pages and generates a feed object.  Then we can use the feed object we’ve created to actually build write some files.  We’ll trigger that in the <code class="language-text">postBuild</code> callback of <code class="language-text">gatsby-node</code>.  Here was my first version to support RSS and Atom:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">//mkDir and mkFile are just light wrappers around node's file system APIs</span>
<span class="token keyword">let</span> <span class="token function-variable function">createRSSFolder</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">mkDir</span><span class="token punctuation">(</span><span class="token string">'/public/rss/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">generateAtomFeed</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">feed</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">mkFile</span><span class="token punctuation">(</span><span class="token string">'/public/atom.xml'</span><span class="token punctuation">,</span> feed<span class="token punctuation">.</span><span class="token function">atom1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">generateRSS</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">feed</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">mkFile</span><span class="token punctuation">(</span><span class="token string">'/public/rss/index.xml'</span><span class="token punctuation">,</span> feed<span class="token punctuation">.</span><span class="token function">rss2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">postBuild</span> <span class="token operator">=</span> <span class="token parameter">pages</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> feed <span class="token operator">=</span> <span class="token function">buildFeed</span><span class="token punctuation">(</span>pages<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">createRSSFolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">generateAtomFeed</span><span class="token punctuation">(</span>feed<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">generateRSS</span><span class="token punctuation">(</span>feed<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Prior to this week, <code class="language-text">feed</code> didn’t support JSON Feed, so I had stopped here.  But because JSON Feed is super simple to implement (its just JSON!), I decided to try to add it to <code class="language-text">feed</code> this week.  It turned out it was as simple as adding a single function that looks like this:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token function">json1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> <span class="token punctuation">{</span> options<span class="token punctuation">,</span> items <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span>
   <span class="token keyword">let</span> feed <span class="token operator">=</span> <span class="token punctuation">{</span>
     version<span class="token punctuation">:</span> <span class="token string">'https://jsonfeed.org/version/1'</span><span class="token punctuation">,</span>
     title<span class="token punctuation">:</span> options<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>link<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     feed<span class="token punctuation">.</span>home_page_url <span class="token operator">=</span> options<span class="token punctuation">.</span>link<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>feedLinks <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>feedLinks<span class="token punctuation">.</span>json<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     feed<span class="token punctuation">.</span>feed_url <span class="token operator">=</span> options<span class="token punctuation">.</span>feedLinks<span class="token punctuation">.</span>json<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>description<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     feed<span class="token punctuation">.</span>description <span class="token operator">=</span> options<span class="token punctuation">.</span>description<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>


   <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>image<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     feed<span class="token punctuation">.</span>icon <span class="token operator">=</span> options<span class="token punctuation">.</span>image<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>author<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     feed<span class="token punctuation">.</span>author <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>author<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         feed<span class="token punctuation">.</span>author<span class="token punctuation">.</span>name <span class="token operator">=</span> options<span class="token punctuation">.</span>author<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>author<span class="token punctuation">.</span>link<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         feed<span class="token punctuation">.</span>author<span class="token punctuation">.</span>url <span class="token operator">=</span> options<span class="token punctuation">.</span>author<span class="token punctuation">.</span>link<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   feed<span class="token punctuation">.</span>items <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
     <span class="token keyword">let</span> feedItem <span class="token operator">=</span> <span class="token punctuation">{</span>
       id<span class="token punctuation">:</span> item<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
       <span class="token comment">// json_feed distinguishes between html and text content</span>
       <span class="token comment">// but since we only take a single type, we'll assume HTML</span>
       html_content<span class="token punctuation">:</span> item<span class="token punctuation">.</span>content<span class="token punctuation">,</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>link<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       feedItem<span class="token punctuation">.</span>url <span class="token operator">=</span> item<span class="token punctuation">.</span>link<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       feedItem<span class="token punctuation">.</span>title <span class="token operator">=</span> item<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>description<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       feedItem<span class="token punctuation">.</span>summary <span class="token operator">=</span> item<span class="token punctuation">.</span>description<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>image<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       feedItem<span class="token punctuation">.</span>image <span class="token operator">=</span> item<span class="token punctuation">.</span>image
     <span class="token punctuation">}</span>

     <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>date<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       feedItem<span class="token punctuation">.</span>date_modified <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ISODateString</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>published<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       feedItem<span class="token punctuation">.</span>date_published <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ISODateString</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>published<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>author<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">let</span> author <span class="token operator">=</span> item<span class="token punctuation">.</span>author<span class="token punctuation">;</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>author <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">// json feed only supports 1 author per post</span>
         author <span class="token operator">=</span> author<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
       feedItem<span class="token punctuation">.</span>author <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>author<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           feedItem<span class="token punctuation">.</span>author<span class="token punctuation">.</span>name <span class="token operator">=</span> author<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>author<span class="token punctuation">.</span>link<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           feedItem<span class="token punctuation">.</span>author<span class="token punctuation">.</span>url <span class="token operator">=</span> author<span class="token punctuation">.</span>link<span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">return</span> feedItem<span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>feed<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span></code></pre></div>
<p> My <a href="https://github.com/jpmonette/feed/pull/56/files">pull request</a> was accepted, so feed v1.1.0 now supports JSON feed and my final code to add <a href="http://benmccormick.org/rss/">rss</a>, <a href="http://benmccormick.org/atom.xml">atom</a>, and <a href="http://benmccormick.org/feed.json">json</a> feed to this site looks like this:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Feed <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'feed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> filter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash/filter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sortBy <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash/sortBy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> forEach <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash/forEach'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">get</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash/get'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> moment <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'moment'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> markdownIt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> frontmatter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'front-matter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>mkDir<span class="token punctuation">,</span> mkFile<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./utils/file_system'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">markdownIt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
 html<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
 linkify<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
 typographer<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">extractMarkdownContent</span> <span class="token operator">=</span> <span class="token parameter">file</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
 <span class="token keyword">let</span> body <span class="token operator">=</span> md<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token function">frontmatter</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// handle local links</span>
 <span class="token keyword">return</span> body<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/src="\//g</span><span class="token punctuation">,</span> <span class="token string">'src="http://benmccormick.org/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">getPageContent</span> <span class="token operator">=</span> <span class="token parameter">page</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
 <span class="token keyword">let</span> file <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/pages/'</span> <span class="token operator">+</span> page<span class="token punctuation">.</span>requirePath<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> <span class="token function">extractMarkdownContent</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">buildFeed</span> <span class="token operator">=</span> <span class="token parameter">pages</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
 <span class="token keyword">let</span> feed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Feed</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   title<span class="token punctuation">:</span> <span class="token string">'benmccormick.org'</span><span class="token punctuation">,</span>
   description<span class="token punctuation">:</span> <span class="token string">'A blog by Ben McCormick'</span><span class="token punctuation">,</span>
   link<span class="token punctuation">:</span> <span class="token string">'http://benmccormick.org'</span><span class="token punctuation">,</span>
   id<span class="token punctuation">:</span> <span class="token string">'http://benmccormick.org'</span><span class="token punctuation">,</span>
   copyright<span class="token punctuation">:</span> <span class="token string">'All rights reserved 2016, Ben McCormick'</span><span class="token punctuation">,</span>
   feedLinks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
     atom<span class="token punctuation">:</span> <span class="token string">'http://benmccormick.org/atom.xml'</span><span class="token punctuation">,</span>
     json<span class="token punctuation">:</span> <span class="token string">'http://benmccormick.org/feed.json'</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   author<span class="token punctuation">:</span> <span class="token punctuation">{</span>
     name<span class="token punctuation">:</span> <span class="token string">'Ben McCormick'</span><span class="token punctuation">,</span>
     email<span class="token punctuation">:</span> <span class="token string">'ben@benmccormick.org'</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// ignore pages (non posts)</span>
 pages <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span>pages<span class="token punctuation">,</span> <span class="token parameter">p</span> <span class="token operator">=></span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">get</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">'data.layout'</span><span class="token punctuation">,</span> <span class="token string">'page'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'page'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// we only want the last 10 articles to show up in the feed</span>
 pages <span class="token operator">=</span> <span class="token function">sortBy</span><span class="token punctuation">(</span>pages<span class="token punctuation">,</span> <span class="token parameter">page</span> <span class="token operator">=></span> <span class="token keyword">get</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token string">'data.date'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 pages <span class="token operator">=</span> pages<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 pages <span class="token operator">=</span> pages<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token function">forEach</span><span class="token punctuation">(</span>pages<span class="token punctuation">,</span> <span class="token parameter">page</span> <span class="token operator">=></span> feed<span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   title<span class="token punctuation">:</span> page<span class="token punctuation">.</span>data<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
   id<span class="token punctuation">:</span> <span class="token string">'https://benmccormick.org'</span> <span class="token operator">+</span> page<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
   link<span class="token punctuation">:</span> <span class="token string">'https://benmccormick.org'</span> <span class="token operator">+</span> page<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
   date<span class="token punctuation">:</span> <span class="token function">moment</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span>data<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   content<span class="token punctuation">:</span> <span class="token function">getPageContent</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">,</span>
   author<span class="token punctuation">:</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span>
       name<span class="token punctuation">:</span> <span class="token string">'Ben McCormick'</span><span class="token punctuation">,</span>
       email<span class="token punctuation">:</span> <span class="token string">'ben@benmccormick.org'</span><span class="token punctuation">,</span>
       link<span class="token punctuation">:</span> <span class="token string">'https://benmccormick.org'</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 feed<span class="token punctuation">.</span><span class="token function">addContributor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   name<span class="token punctuation">:</span> <span class="token string">'Ben McCormick'</span><span class="token punctuation">,</span>
   email<span class="token punctuation">:</span> <span class="token string">'ben@benmccormick.org'</span><span class="token punctuation">,</span>
   link<span class="token punctuation">:</span> <span class="token string">'https://benmccormick.org'</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> feed<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token function-variable function">createRSSFolder</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">mkDir</span><span class="token punctuation">(</span><span class="token string">'/public/rss/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">generateAtomFeed</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">feed</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">mkFile</span><span class="token punctuation">(</span><span class="token string">'/public/atom.xml'</span><span class="token punctuation">,</span> feed<span class="token punctuation">.</span><span class="token function">atom1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">generateRSS</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">feed</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">mkFile</span><span class="token punctuation">(</span><span class="token string">'/public/rss/index.xml'</span><span class="token punctuation">,</span> feed<span class="token punctuation">.</span><span class="token function">rss2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">generateJSONFeed</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">feed</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">mkFile</span><span class="token punctuation">(</span><span class="token string">'/public/feed.json'</span><span class="token punctuation">,</span> feed<span class="token punctuation">.</span><span class="token function">json1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">postBuild</span> <span class="token operator">=</span> <span class="token parameter">pages</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> feed <span class="token operator">=</span> <span class="token function">buildFeed</span><span class="token punctuation">(</span>pages<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">createRSSFolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">generateAtomFeed</span><span class="token punctuation">(</span>feed<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">generateRSS</span><span class="token punctuation">(</span>feed<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">generateJSONFeed</span><span class="token punctuation">(</span>feed<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h3>More Resources</h3>
<ul>
<li>You can see the whole spec for <a href="https://jsonfeed.org/">JSON Feed</a> on their <a href="https://jsonfeed.org/">site</a>.  It really is remarkably simple.  They also have a list of implementations and example sites.</li>
</ul></div><style data-emotion-css="rd3zyi">.css-rd3zyi{padding-left:2rem;overflow:hidden;}</style><div class="no-mobile css-rd3zyi e15djruj3"><style data-emotion-css="1y23a7j">.css-1y23a7j{overflow:hidden;margin:0;}.css-1y23a7j #mc_embed_signup form{margin-bottom:20px;}@media all and (max-width:700px){.css-1y23a7j{padding-right:0;width:100% !important;padding:0 10px;}.css-1y23a7j .mc-field-group{width:100% !important;}.css-1y23a7j .mc-field-group input{width:100% !important;font-size:0.8em;height:2.4em;}}</style><div class="css-1y23a7j e1qbom70"><form action="https://buttondown.email/api/emails/embed-subscribe/benmccormick" method="post" target="popupwindow" class="embeddable-buttondown-form"><label for="bd-email" id="bd-label">Subscribe to the Newsletter</label><input type="hidden" value="1" name="embed"/><div class="bd-subscribe-row"><input type="email" name="email" id="bd-email" placeholder="Your Email"/><input type="submit" value="Subscribe" id="bd-submit"/></div></form></div><style data-emotion-css="wtijjp">.css-wtijjp{width:100%;overflow:hidden;margin:0 0 1rem 0;font-size:14px;position:relative;font-family:"mr-eaves-xl-modern","Helvetica Neue",Arial,sans-serif;background:rgba(99,159,110,0.25);border:1px solid rgba(90,150,100,0.5);padding:4px;min-height:100px;opacity:0;-webkit-transition:opacity ease 3s;transition:opacity ease 3s;}@media all and (max-width:700px){.css-wtijjp{display:none;}}</style><div class="css-wtijjp etmlefq0"></div><style data-emotion-css="1ui09x8">.css-1ui09x8{font-size:14px;background-color:RGBA(191,237,253,0.5);border:1px solid #68d4fa;padding:0.5rem;}.css-1ui09x8 > h4{font-size:20px;margin-bottom:6px;}.css-1ui09x8 > h6{font-size:18px;margin-bottom:6px;margin-top:12px;}</style><div class="css-1ui09x8 e15djruj1"><h4>Article Info</h4><h6>Author</h6><a href="/about">Ben McCormick</a><h6>Publish Date</h6>June 4th 2017<h6>Category</h6><a class="css-1kzlgaa" href="/category/meta"><style data-emotion-css="e7v39i">.css-e7v39i{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;margin-right:0.1rem;}@media all and (max-width:960px){.css-e7v39i{margin-right:0;}}</style><div class="css-e7v39i e1nsgn8x1"><style data-emotion-css="1l0yf4i">.css-1l0yf4i{display:block;width:0.8rem;height:0.8rem;margin-right:0.5rem;}.css-1l0yf4i *{fill:rgba(256,256,256,1);}.css-1l0yf4i > i{height:0.16000000000000003rem;}</style><span color="rgba(256,256,256,1)" class="css-1l0yf4i efpzdjd0"><i><svg viewBox="0 0 14 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>info</title><desc>Created with Sketch.</desc><defs></defs><g id="Octicons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="info" fill="#000000"><path d="M6.3,5.69 C6.11,5.5 6.02,5.27 6.02,4.99 C6.02,4.71 6.11,4.47 6.3,4.29 C6.49,4.11 6.72,4.01 7,4.01 C7.28,4.01 7.52,4.1 7.7,4.29 C7.88,4.48 7.98,4.71 7.98,4.99 C7.98,5.27 7.89,5.51 7.7,5.69 C7.51,5.87 7.28,5.99 7,5.99 C6.72,5.99 6.48,5.88 6.3,5.69 L6.3,5.69 Z M8,7.99 C7.98,7.74 7.89,7.51 7.69,7.3 C7.49,7.11 7.27,7 7,6.99 L6,6.99 C5.73,7.01 5.52,7.12 5.31,7.3 C5.11,7.5 5.01,7.74 5,7.99 L6,7.99 L6,10.99 C6.02,11.26 6.11,11.49 6.31,11.68 C6.51,11.88 6.73,11.99 7,11.99 L8,11.99 C8.27,11.99 8.48,11.88 8.69,11.68 C8.89,11.49 8.99,11.26 9,10.99 L8,10.99 L8,7.98 L8,7.99 Z M7,2.3 C3.86,2.3 1.3,4.84 1.3,7.98 C1.3,11.12 3.86,13.68 7,13.68 C10.14,13.68 12.7,11.13 12.7,7.98 C12.7,4.83 10.14,2.29 7,2.29 L7,2.3 Z M7,0.98 C10.86,0.98 14,4.12 14,7.98 C14,11.84 10.86,14.98 7,14.98 C3.14,14.98 0,11.86 0,7.98 C0,4.1 3.14,0.98 7,0.98 L7,0.98 Z" id="Shape"></path></g></g></svg></i></span></div><style data-emotion-css="1bs7qd7">.css-1bs7qd7:hover{-webkit-text-decoration:none;text-decoration:none;}</style><div class="css-1bs7qd7 e1nsgn8x0">Meta</div></a></div></div></div></article></div><style data-emotion-css="1tfasoy">.css-1tfasoy{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:3em 0 1em 0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:RGBA(191,237,253,0.5);border-top:1px solid #68d4fa;}</style><div class="css-1tfasoy e7oz9l30"><style data-emotion-css="7bdmpt">.css-7bdmpt{width:100%;min-height:200px;max-width:960px;margin:0 auto;padding:0 1.2rem;display:grid;grid-template-columns:45% 45%;grid-column-gap:10%;grid-row-gap:30px;}@media all and (max-width:450px){.css-7bdmpt{grid-template-columns:100%;}}</style><div class="css-7bdmpt e7oz9l31"><div><h2 class="css-0 e7oz9l33">Content</h2><style data-emotion-css="1xfqzqa">.css-1xfqzqa{display:grid;grid-template-columns:1fr;grid-auto-rows:1fr;grid-row-gap:20px;}</style><div class="css-1xfqzqa e7oz9l32"><a class="css-1gs5qio" href="/archive/">Blog Archive</a><a class="css-1gs5qio" href="/reviews-archive/">Book Reviews</a><a class="css-1gs5qio" href="https://buttondown.email/benmccormick">Newsletter Archives</a><a class="css-1gs5qio" href="/speaking/">Speaking</a></div></div><div><h2 class="css-0 e7oz9l33">Meta</h2><div class="css-1xfqzqa e7oz9l32"><a class="css-1gs5qio" href="/subscribe/">Subscribe To The Newsletter</a><a class="css-1gs5qio" href="/built-with/">Built With</a><a class="css-1gs5qio" href="http://twitter.com/_benmccormick">Personal Twitter</a><a class="css-1gs5qio" href="http://twitter.com/benmccormickorg">Blog Twitter</a><a class="css-1gs5qio" href="/about/">About Me</a></div></div><style data-emotion-css="i3iawv">.css-i3iawv{font-family:"mr-eaves-xl-modern","Helvetica Neue",Arial,sans-serif;font-size:14px;overflow:visible;white-space:nowrap;}</style><div class="css-i3iawv e7oz9l34">Copyright © 2012-2019 · Ben McCormick</div></div></div></div></div><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-37323973-1', 'auto');
            ga('send', 'pageview');
        </script><script>
          (function(d) {
            var config = {
              kitId: 'msd6bqv',
              scriptTimeout: 300,
              async: true
            },
            h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/wf-loading/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
          })(document);
        </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"2017-06-03-rss-atom-json-gatsby-736","path":"/2017/06/03/rss-atom-json-gatsby/"};window.dataPath="405/path---2017-06-03-rss-atom-json-gatsby-736-704-FF71L3AUNEmcpsSV3pEZq6Zn4M";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-667aa80e342971869923.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js.798d7f465f017e25729f.css","/component---src-templates-blog-post-js-69cabe4c360af79450d4.js"],"component---src-templates-category-page-js":["/component---src-templates-category-page-js-6720f6da48a4b7028597.js"],"component---src-templates-topic-page-js":["/component---src-templates-topic-page-js-71147d5ad0723b893b15.js"],"component---src-pages-archive-js":["/component---src-pages-archive-js-8a455ca4b24a0d76c48b.js"],"component---src-pages-index-js":["/component---src-pages-index-js-5c066f5888d72b33729d.js"],"component---src-pages-links-archive-js":["/component---src-pages-links-archive-js-42acec5b2f026f3888a2.js"],"component---src-pages-lions-archive-js":["/component---src-pages-lions-archive-js-15794e8bf97258f81cdf.js"],"component---src-pages-reviews-archive-js":["/component---src-pages-reviews-archive-js-76e4c8ff26f3ea87eb34.js"]};/*]]>*/</script><script src="/webpack-runtime-10ac1f7d593940ad8124.js" async=""></script><script src="/0-71075e707b2d73871cd4.js" async=""></script><script src="/2-a8610bc7c3007782573b.js" async=""></script><script src="/app-667aa80e342971869923.js" async=""></script><script src="/component---src-templates-blog-post-js-69cabe4c360af79450d4.js" async=""></script></body></html>